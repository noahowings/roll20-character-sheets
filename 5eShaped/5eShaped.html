<div class="wrapper relative"><input class="slide-input-pc" type="checkbox" name="attr_is_npc" value="1"><label class="slide-toggle-pc"><span class="slide-cover">···</span><span class="slide-toggle-pc-left" data-i18n="PC"></span><span class="slide-toggle-pc-right" data-i18n="NPC"></span></label><span class="small-label bold pad-l-sm">Shaped v<span name="attr_version" class="bold small-label"></span></span><div class="core-header pc"><div class="shaped-row"><div class="col-40"><div class="dnd-image-wrapper"><img src="http://i.imgur.com/X44kw8b.png" alt="Dungeons & Dragons (5th edition)"></div><div class="character-name"><input type="text" name="attr_character_name"><div class="wrap-box-label" data-i18n="CHARACTER_NAME"></div></div></div><div class="col-60 header-info"><div class="wrap-box"><div class="shaped-row"><div class="col-70 pad-r-lg"><input type="text" name="attr_class_and_level" data-i18n-placeholder="CLASS_AND_LEVEL_PLACEHOLDER" readonly="readonly"> <button type="roll" name="roll_shaped_class" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=CLASS_AND_LEVEL>Class & Level</span>}} {{text_big=@{class_and_level}}}"><div class="wrap-box-label" data-i18n="CLASS_AND_LEVEL"></div></button></div><div class="col-30"><input type="text" name="attr_background"> <button type="roll" name="roll_shaped_background" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=BACKGROUND>Background</span>}} {{text_big=@{background}}}"><div class="wrap-box-label" data-i18n="BACKGROUND"></div></button></div></div><div class="shaped-row"><div class="col-35 pad-r-lg"><input type="text" name="attr_race"> <button type="roll" name="roll_shaped_race" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=RACE>Race</span>}} {{text_big=@{race}}}"><div class="wrap-box-label" data-i18n="RACE"></div></button></div><div class="col-35 pad-r-lg"><input type="text" name="attr_alignment"> <button type="roll" name="roll_shaped_alignment" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=ALIGNMENT>Alignment</span>}} {{text_big=@{alignment}}}"><div class="wrap-box-label" data-i18n="ALIGNMENT"></div></button></div><div class="col-30"><div class="shaped-row flex-end"><div class="col-47"><input type="number" name="attr_xp" class="no-spin" min="0" step="1"></div><div class="col-06 center">&#47;</div><div class="col-47"><span name="attr_xp_next_level" class="pseudo-input border-bottom center"></span></div></div><button type="roll" name="roll_shaped_xp" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=EXPERIENCE_POINTS>Experience points</span>Experience points}} {{text_top=[[@{xp}]]&#47;[[@{xp_next_level}]]}} {{text_big=for level [[@{level} + 1]]}}"><div class="wrap-box-label" data-i18n="EXPERIENCE_POINTS"></div></button></div></div></div></div></div></div><div class="mar-t-md"></div><input type="radio" name="attr_tab" class="toggle-page-core" value="core" checked="checked"><span class="toggle-page-core button" data-i18n="CORE"></span> <input type="radio" name="attr_tab" class="toggle-page-spells" value="spells"><span class="toggle-page-spells button" data-i18n="SPELLS"></span> <input type="radio" name="attr_tab" class="toggle-page-equipment pc" value="equipment"><span class="toggle-page-equipment button pc" data-i18n="EQUIPMENT"></span> <input type="radio" name="attr_tab" class="toggle-page-character pc" value="character"><span class="toggle-page-character button pc" data-i18n="CHARACTER"></span> <input type="radio" name="attr_tab" class="toggle-page-settings" value="settings"><span class="toggle-page-settings button pictos">y</span> <input type="radio" name="attr_tab" class="toggle-page-all" value="all"><span class="toggle-page-all button" data-i18n="ALL"></span> <input type="checkbox" name="attr_edit_mode" class="toggle-edit-mode mar-l-lg negative-mar-t-eight"><span class="toggle-edit-mode pictos negative-mar-t-eight">p</span><div class="float-right mar-t-smd"><input type="radio" name="attr_roll_setting" class="toggle-roll-normal" value="{{ignore=[[0" checked="checked"><span class="toggle-roll-normal button" data-i18n="NORMAL"></span> <input type="radio" name="attr_roll_setting" class="toggle-roll-advantage" value="adv {{ignore=[[0"><span class="toggle-roll-advantage button" data-i18n="ADVANTAGE"></span> <input type="radio" name="attr_roll_setting" class="toggle-roll-disadvantage" value="dis {{ignore=[[0"><span class="toggle-roll-disadvantage button" data-i18n="DISADVANTAGE"></span></div><input type="hidden" name="attr_has_barbarian_levels" class="has-barbarian-levels hidden"> <input type="hidden" name="attr_has_bard_levels" class="has-bard-levels hidden"> <input type="hidden" name="attr_has_cleric_levels" class="has-cleric-levels hidden"> <input type="hidden" name="attr_has_druid_levels" class="has-druid-levels hidden"> <input type="hidden" name="attr_has_fighter_levels" class="has-fighter-levels hidden"> <input type="hidden" name="attr_has_monk_levels" class="has-monk-levels hidden"> <input type="hidden" name="attr_has_paladin_levels" class="has-paladin-levels hidden"> <input type="hidden" name="attr_has_ranger_levels" class="has-ranger-levels hidden"> <input type="hidden" name="attr_has_rogue_levels" class="has-rogue-levels hidden"> <input type="hidden" name="attr_has_sorcerer_levels" class="has-sorcerer-levels hidden"> <input type="hidden" name="attr_has_warlock_levels" class="has-warlock-levels hidden"> <input type="hidden" name="attr_has_wizard_levels" class="has-wizard-levels hidden"> <input type="checkbox" name="attr_spell_slots_l1_toggle" class="toggle-spell-level-1 hidden"> <input type="checkbox" name="attr_spell_slots_l2_toggle" class="toggle-spell-level-2 hidden"> <input type="checkbox" name="attr_spell_slots_l3_toggle" class="toggle-spell-level-3 hidden"> <input type="checkbox" name="attr_spell_slots_l4_toggle" class="toggle-spell-level-4 hidden"> <input type="checkbox" name="attr_spell_slots_l5_toggle" class="toggle-spell-level-5 hidden"> <input type="checkbox" name="attr_spell_slots_l6_toggle" class="toggle-spell-level-6 hidden"> <input type="checkbox" name="attr_spell_slots_l7_toggle" class="toggle-spell-level-7 hidden"> <input type="checkbox" name="attr_spell_slots_l8_toggle" class="toggle-spell-level-8 hidden"> <input type="checkbox" name="attr_spell_slots_l9_toggle" class="toggle-spell-level-9 hidden"> <input type="hidden" name="attr_roll_info"> <input type="hidden" name="attr_shaped_d20" value="d20"> <input type="hidden" name="attr_d20_mod"><div class="spacer-smd"></div><div class="section-core pc"><div class="shaped-row"><div class="col-32 pad-r-sm"><div class="shaped-row mar-b-smd"><div class="col-30 pad-r-sm"><input type="hidden" name="attr_finesse_mod"><div class="ability-wrapper wrap-box center"><input type="hidden" name="attr_strength_check_mod_formula"> <button type="roll" name="roll_shaped_strength_check" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=STRENGTH>Strength</span> <span data-i18n=CHECK class=lowercase>Check</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{strength_check_mod_formula}]]}} @{roll_setting} + @{strength_check_mod_formula}]]}} @{attacher_strength_check}" tabindex="-1"><div><span class="ability-name" data-i18n="STRENGTH"></span> <input type="hidden" name="attr_strength_mod"> <span name="attr_strength_mod_with_sign" class="ability-modifier block center"></span></div></button><div class="edit shaped-row no-wrap vert-center small-label"><span data-i18n="CHECK"></span><div>+</div><div><input type="number" name="attr_strength_check_bonus" class="no-spin no-border" value="0" step="1"></div><div>=</div><span class="mar-l-sm" name="attr_strength_check_mod"></span></div><div class="ability-score-wrapper shaped-row no-wrap center vert-center"><span name="attr_strength_calculated" class="presentation small-label"></span><div class="edit"><input type="number" name="attr_strength" class="no-spin no-border" min="1" step="1"></div><div class="edit">+</div><div class="edit"><input type="number" name="attr_strength_bonus" class="no-spin no-border" value="0" step="1"></div></div></div><div class="ability-wrapper wrap-box center"><input type="hidden" name="attr_dexterity_check_mod_formula"> <button type="roll" name="roll_shaped_dexterity_check" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=DEXTERITY>Dexterity</span> <span data-i18n=CHECK class=lowercase>Check</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{dexterity_check_mod_formula}]]}} @{roll_setting} + @{dexterity_check_mod_formula}]]}} @{attacher_dexterity_check}" tabindex="-1"><div><span class="ability-name" data-i18n="DEXTERITY"></span> <input type="hidden" name="attr_dexterity_mod"> <span name="attr_dexterity_mod_with_sign" class="ability-modifier block center"></span></div></button><div class="edit shaped-row no-wrap vert-center small-label"><span data-i18n="CHECK"></span><div>+</div><div><input type="number" name="attr_dexterity_check_bonus" class="no-spin no-border" value="0" step="1"></div><div>=</div><span class="mar-l-sm" name="attr_dexterity_check_mod"></span></div><div class="ability-score-wrapper shaped-row no-wrap center vert-center"><span name="attr_dexterity_calculated" class="presentation small-label"></span><div class="edit"><input type="number" name="attr_dexterity" class="no-spin no-border" min="1" step="1"></div><div class="edit">+</div><div class="edit"><input type="number" name="attr_dexterity_bonus" class="no-spin no-border" value="0" step="1"></div></div></div><div class="ability-wrapper wrap-box center"><input type="hidden" name="attr_constitution_check_mod_formula"> <button type="roll" name="roll_shaped_constitution_check" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=CONSTITUTION>Constitution</span> <span data-i18n=CHECK class=lowercase>Check</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{constitution_check_mod_formula}]]}} @{roll_setting} + @{constitution_check_mod_formula}]]}} @{attacher_constitution_check}" tabindex="-1"><div><span class="ability-name" data-i18n="CONSTITUTION"></span> <input type="hidden" name="attr_constitution_mod"> <span name="attr_constitution_mod_with_sign" class="ability-modifier block center"></span></div></button><div class="edit shaped-row no-wrap vert-center small-label"><span data-i18n="CHECK"></span><div>+</div><div><input type="number" name="attr_constitution_check_bonus" class="no-spin no-border" value="0" step="1"></div><div>=</div><span class="mar-l-sm" name="attr_constitution_check_mod"></span></div><div class="ability-score-wrapper shaped-row no-wrap center vert-center"><span name="attr_constitution_calculated" class="presentation small-label"></span><div class="edit"><input type="number" name="attr_constitution" class="no-spin no-border" min="1" step="1"></div><div class="edit">+</div><div class="edit"><input type="number" name="attr_constitution_bonus" class="no-spin no-border" value="0" step="1"></div></div></div><div class="ability-wrapper wrap-box center"><input type="hidden" name="attr_intelligence_check_mod_formula"> <button type="roll" name="roll_shaped_intelligence_check" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=INTELLIGENCE>Intelligence</span> <span data-i18n=CHECK class=lowercase>Check</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{intelligence_check_mod_formula}]]}} @{roll_setting} + @{intelligence_check_mod_formula}]]}} @{attacher_intelligence_check}" tabindex="-1"><div><span class="ability-name" data-i18n="INTELLIGENCE"></span> <input type="hidden" name="attr_intelligence_mod"> <span name="attr_intelligence_mod_with_sign" class="ability-modifier block center"></span></div></button><div class="edit shaped-row no-wrap vert-center small-label"><span data-i18n="CHECK"></span><div>+</div><div><input type="number" name="attr_intelligence_check_bonus" class="no-spin no-border" value="0" step="1"></div><div>=</div><span class="mar-l-sm" name="attr_intelligence_check_mod"></span></div><div class="ability-score-wrapper shaped-row no-wrap center vert-center"><span name="attr_intelligence_calculated" class="presentation small-label"></span><div class="edit"><input type="number" name="attr_intelligence" class="no-spin no-border" min="1" step="1"></div><div class="edit">+</div><div class="edit"><input type="number" name="attr_intelligence_bonus" class="no-spin no-border" value="0" step="1"></div></div></div><div class="ability-wrapper wrap-box center"><input type="hidden" name="attr_wisdom_check_mod_formula"> <button type="roll" name="roll_shaped_wisdom_check" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=WISDOM>Wisdom</span> <span data-i18n=CHECK class=lowercase>Check</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{wisdom_check_mod_formula}]]}} @{roll_setting} + @{wisdom_check_mod_formula}]]}} @{attacher_wisdom_check}" tabindex="-1"><div><span class="ability-name" data-i18n="WISDOM"></span> <input type="hidden" name="attr_wisdom_mod"> <span name="attr_wisdom_mod_with_sign" class="ability-modifier block center"></span></div></button><div class="edit shaped-row no-wrap vert-center small-label"><span data-i18n="CHECK"></span><div>+</div><div><input type="number" name="attr_wisdom_check_bonus" class="no-spin no-border" value="0" step="1"></div><div>=</div><span class="mar-l-sm" name="attr_wisdom_check_mod"></span></div><div class="ability-score-wrapper shaped-row no-wrap center vert-center"><span name="attr_wisdom_calculated" class="presentation small-label"></span><div class="edit"><input type="number" name="attr_wisdom" class="no-spin no-border" min="1" step="1"></div><div class="edit">+</div><div class="edit"><input type="number" name="attr_wisdom_bonus" class="no-spin no-border" value="0" step="1"></div></div></div><div class="ability-wrapper wrap-box center"><input type="hidden" name="attr_charisma_check_mod_formula"> <button type="roll" name="roll_shaped_charisma_check" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=CHARISMA>Charisma</span> <span data-i18n=CHECK class=lowercase>Check</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{charisma_check_mod_formula}]]}} @{roll_setting} + @{charisma_check_mod_formula}]]}} @{attacher_charisma_check}" tabindex="-1"><div><span class="ability-name" data-i18n="CHARISMA"></span> <input type="hidden" name="attr_charisma_mod"> <span name="attr_charisma_mod_with_sign" class="ability-modifier block center"></span></div></button><div class="edit shaped-row no-wrap vert-center small-label"><span data-i18n="CHECK"></span><div>+</div><div><input type="number" name="attr_charisma_check_bonus" class="no-spin no-border" value="0" step="1"></div><div>=</div><span class="mar-l-sm" name="attr_charisma_check_mod"></span></div><div class="ability-score-wrapper shaped-row no-wrap center vert-center"><span name="attr_charisma_calculated" class="presentation small-label"></span><div class="edit"><input type="number" name="attr_charisma" class="no-spin no-border" min="1" step="1"></div><div class="edit">+</div><div class="edit"><input type="number" name="attr_charisma_bonus" class="no-spin no-border" value="0" step="1"></div></div></div></div><div class="col-70 pad-l-sm"><div class="inspiration wrap-box relative pc mar-b-md"><div class="shaped-row vert-center"><label class="checkbox-label"><input type="checkbox" name="attr_inspiration" value="1"><span></span></label><button type="roll" name="roll_shaped_inspiration" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=INSPIRATION>Inspiration</span>}} {{text_big=[[@{inspiration}]]}}" tabindex="-1"><div class="wrap-box-title" data-i18n="INSPIRATION"></div></button></div></div><div class="proficiency-bonus wrap-box relative mar-t-sm mar-b-md"><button type="roll" name="roll_shaped_pb" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=PROFICIENCY_BONUS>Proficiency Bonus</span>}} {{text_top=[[@{pb}]]}}" tabindex="-1"><div class="shaped-row vert-center"><div class="proficiency-bonus-wrapper center"><input type="number" name="attr_PB" class="bold big-font no-border" readonly="readonly" tabindex="-1"> <input type="hidden" name="attr_exp"> <input type="hidden" name="attr_h_PB" value="[[floor(@{PB}/2)]]"></div><div class="wrap-box-title pad-l-sm" data-i18n="PROFICIENCY_BONUS"></div></div></button></div><div class="saving-throw wrap-box mar-b-smd"><div class="shaped-row flex-end pad-b-sm"><div class="center pad-l-sm pad-r-sm"><input type="checkbox" name="attr_strength_save_prof" value="@{PB}"></div><div class="col-12 edit"><input type="number" name="attr_strength_save_bonus" class="no-spin small-label" value="0" step="1"></div><input type="hidden" name="attr_strength_saving_throw_mod"> <button type="roll" name="roll_shaped_strength_saving_throw" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=STRENGTH>Strength</span> <span data-i18n=SAVE class=lowercase>Save</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{strength_saving_throw_mod}]]}} @{roll_setting} + @{strength_saving_throw_mod}]]}} @{attacher_strength_saving_throw}" tabindex="-1"><span name="attr_strength_saving_throw_mod_with_sign" class="col-2-em input-like center bold border-bottom"></span> <span class="ability-saving-throw-name" data-i18n="STRENGTH"></span></button></div><div class="shaped-row flex-end pad-b-sm"><div class="center pad-l-sm pad-r-sm"><input type="checkbox" name="attr_dexterity_save_prof" value="@{PB}"></div><div class="col-12 edit"><input type="number" name="attr_dexterity_save_bonus" class="no-spin small-label" value="0" step="1"></div><input type="hidden" name="attr_dexterity_saving_throw_mod"> <button type="roll" name="roll_shaped_dexterity_saving_throw" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=DEXTERITY>Dexterity</span> <span data-i18n=SAVE class=lowercase>Save</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{dexterity_saving_throw_mod}]]}} @{roll_setting} + @{dexterity_saving_throw_mod}]]}} @{attacher_dexterity_saving_throw}" tabindex="-1"><span name="attr_dexterity_saving_throw_mod_with_sign" class="col-2-em input-like center bold border-bottom"></span> <span class="ability-saving-throw-name" data-i18n="DEXTERITY"></span></button></div><div class="shaped-row flex-end pad-b-sm"><div class="center pad-l-sm pad-r-sm"><input type="checkbox" name="attr_constitution_save_prof" value="@{PB}"></div><div class="col-12 edit"><input type="number" name="attr_constitution_save_bonus" class="no-spin small-label" value="0" step="1"></div><input type="hidden" name="attr_constitution_saving_throw_mod"> <button type="roll" name="roll_shaped_constitution_saving_throw" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=CONSTITUTION>Constitution</span> <span data-i18n=SAVE class=lowercase>Save</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{constitution_saving_throw_mod}]]}} @{roll_setting} + @{constitution_saving_throw_mod}]]}} @{attacher_constitution_saving_throw}" tabindex="-1"><span name="attr_constitution_saving_throw_mod_with_sign" class="col-2-em input-like center bold border-bottom"></span> <span class="ability-saving-throw-name" data-i18n="CONSTITUTION"></span></button></div><div class="shaped-row flex-end pad-b-sm"><div class="center pad-l-sm pad-r-sm"><input type="checkbox" name="attr_intelligence_save_prof" value="@{PB}"></div><div class="col-12 edit"><input type="number" name="attr_intelligence_save_bonus" class="no-spin small-label" value="0" step="1"></div><input type="hidden" name="attr_intelligence_saving_throw_mod"> <button type="roll" name="roll_shaped_intelligence_saving_throw" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=INTELLIGENCE>Intelligence</span> <span data-i18n=SAVE class=lowercase>Save</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{intelligence_saving_throw_mod}]]}} @{roll_setting} + @{intelligence_saving_throw_mod}]]}} @{attacher_intelligence_saving_throw}" tabindex="-1"><span name="attr_intelligence_saving_throw_mod_with_sign" class="col-2-em input-like center bold border-bottom"></span> <span class="ability-saving-throw-name" data-i18n="INTELLIGENCE"></span></button></div><div class="shaped-row flex-end pad-b-sm"><div class="center pad-l-sm pad-r-sm"><input type="checkbox" name="attr_wisdom_save_prof" value="@{PB}"></div><div class="col-12 edit"><input type="number" name="attr_wisdom_save_bonus" class="no-spin small-label" value="0" step="1"></div><input type="hidden" name="attr_wisdom_saving_throw_mod"> <button type="roll" name="roll_shaped_wisdom_saving_throw" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=WISDOM>Wisdom</span> <span data-i18n=SAVE class=lowercase>Save</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{wisdom_saving_throw_mod}]]}} @{roll_setting} + @{wisdom_saving_throw_mod}]]}} @{attacher_wisdom_saving_throw}" tabindex="-1"><span name="attr_wisdom_saving_throw_mod_with_sign" class="col-2-em input-like center bold border-bottom"></span> <span class="ability-saving-throw-name" data-i18n="WISDOM"></span></button></div><div class="shaped-row flex-end"><div class="center pad-l-sm pad-r-sm"><input type="checkbox" name="attr_charisma_save_prof" value="@{PB}"></div><div class="col-12 edit"><input type="number" name="attr_charisma_save_bonus" class="no-spin small-label" value="0" step="1"></div><input type="hidden" name="attr_charisma_saving_throw_mod"> <button type="roll" name="roll_shaped_charisma_saving_throw" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=CHARISMA>Charisma</span> <span data-i18n=SAVE class=lowercase>Save</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{charisma_saving_throw_mod}]]}} @{roll_setting} + @{charisma_saving_throw_mod}]]}} @{attacher_charisma_saving_throw}" tabindex="-1"><span name="attr_charisma_saving_throw_mod_with_sign" class="col-2-em input-like center bold border-bottom"></span> <span class="ability-saving-throw-name" data-i18n="CHARISMA"></span></button></div><button type="roll" name="roll_shaped_saving_throw" class="wrapper-button" value="/w @{character_name} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=SAVING_THROWS>Saving throws</span>}} {{text_big=@{saving_throw_macro_var}}}"><div class="wrap-box-title center" data-i18n="SAVING_THROWS"></div></button></div><div class="skills wrap-box"><input type="checkbox" name="attr_show_passive_skills" class="item-shown hidden"><fieldset class="repeating_skill"><div class="shaped-row no-wrap flex-end"><div class="col-10 no-shrink edit"><select name="attr_skill_d20"><option value="@{shaped_d20}" data-i18n="NORMAL">Normal</option><option value="2d20@{d20_mod}kh1" data-i18n="ADVANTAGE">Advantage</option><option value="2d20@{d20_mod}kl1" data-i18n="DISADVANTAGE">Disadvantage</option></select></div><div class="col-10 skill-select-wrapper no-shrink"><select name="attr_proficiency" class="no-border"><option value="unproficient">&#8212; &#160;&#160;<span data-i18n="UNPROFICIENT">Unproficient</span></option><option value="proficient">&check; &#160;&#160; <span data-i18n="PROFICIENT">Proficient</span></option><option value="expertise">&cross; &#160;&#160; <span data-i18n="EXPERTISE">Expertise</span></option></select></div><div class="col-09 edit no-shrink"><input type="number" name="attr_bonus" class="no-spin small-label" value="0" step="1"></div><button type="roll" name="roll_skill" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name} (<span data-i18n=@{ability_key}>@{ability_key}<span>)}} @{roll_info} @{skill_info} {{roll1=[[@{skill_d20} + @{formula}]]}} @{roll_setting} + @{formula}]]}} @{attacher_skill}" tabindex="-1"><div class="shaped-row no-wrap flex-end"><span name="attr_total_with_sign" class="col-2-em input-like center bold border-bottom"></span> <span name="attr_name" class="skill-name presentation pad-l-sm"></span></div></button><div class="col-50 edit"><input type="text" name="attr_name" class="skill-name"></div><input type="hidden" name="attr_formula"> <input type="hidden" name="attr_skill_info"> <input type="hidden" name="attr_ability_key"><div class="skills-ability-selector-wrapper no-shrink pad-l-sm"><div class="shaped-row no-wrap vert-center"><span>(</span><select name="attr_ability" class="skills-ability-selector"><option value="">&#8212;</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select><span>)</span></div></div><div class="col-09 edit no-shrink"><input type="number" name="attr_passive_bonus" class="no-spin small-label" value="0" step="1"></div><input type="hidden" name="attr_passive"> <button type="roll" name="roll_passive" class="item-to-show" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=PASSIVE>Passive</span> @{name} (<span data-i18n=@{ability_key}>@{ability_key}<span>)}} @{roll_info} {{roll1=[[@{passive}]]}} @{attacher_skill}" tabindex="-1"><div class="shaped-row no-wrap flex-end"><span name="attr_passive" class="col-1-3-em input-like center border-bottom"></span></div></button></div></fieldset><div class="mar-t-sm"></div><input type="checkbox" name="attr_generate_skills" class="toggle-pseudo-button edit"><span class="toggle-pseudo-button button edit" data-i18n="GENERATE_SKILLS"></span><div class="mar-t-sm"><input type="checkbox" name="attr_show_passive_skills" class="edit item-shown"><span class="edit" data-i18n="SHOW_PASSIVE"></span></div><button type="roll" name="roll_shaped_ability_checks" class="wrapper-button" value="/w @{character_name} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=ABILITY_CHECKS>Ability checks</span>}} {{@{ability_checks_text_size}=@{ability_checks_macro_var}}}"><div class="wrap-box-title center" data-i18n="SKILLS"></div></button></div></div></div><div><div class="wrap-box languages-proficiencies"><div class="proficienciess"><button type="roll" name="roll_shaped_proficiencies" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=PROFICIENCIES>Proficiencies</span>}} {{text=@{proficiencies}}}"><span class="heading" data-i18n="PROFICIENCIES">.</span> <span name="attr_proficiencies" class="presentation pre-line"></span></button><textarea name="attr_proficiencies" class="five-line-textarea no-border edit"></textarea></div><div class="languages"><button type="roll" name="roll_shaped_languages" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=LANGUAGES>Languages</span>}} {{text_top=@{languages}}}"><span class="heading" data-i18n="LANGUAGES">.</span> <span name="attr_languages" class="presentation pre-line"></span></button><textarea name="attr_languages" class="two-line-textarea no-border edit"></textarea></div><div class="wrap-box-title center" data-i18n="OTHER_PROFICIENCIES_AND_LANGUAGES"></div></div></div></div><div class="col-39 pad-l-sm pad-r-sm"><div class="shaped-row"><div class="col-58 pad-r-sm"><div class="shaped-row center"><div class="col-33 center"><button type="roll" name="roll_shaped_ac" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=AC>AC</span>}} {{text_big=[[@{ac}]]}}"><div class="shield"><span name="attr_AC" class="big-text bold block center"></span><div class="wrap-box-title center" data-i18n="ARMOR_CLASS"></div></div></button></div><div class="col-30 center"><div class="wrap-box initiative"><input type="hidden" name="attr_initiative_formula"><div class="edit shaped-row no-wrap vert-center"><div>+</div><input type="text" name="attr_initiative_bonus" class="center no-border" value="0"><div>=</div><span name="attr_initiative" class="big-text bold block center"></span></div><button type="roll" name="roll_shaped_initiative" value="@{initiative_output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=INITIATIVE>Initiative</span>}} {{roll1=[[@{initiative_roll} + @{initiative_to_tracker} + @{initiative_tie_breaker}]]}} @{attacher_initiative}"><span name="attr_initiative" class="presentation big-text bold block center initiative-total"></span><div class="wrap-box-title center" data-i18n="INITIATIVE"></div></button></div></div><div class="col-29 center pad-l-md"><div class="wrap-box center speed"><div class="edit"><input type="number" name="attr_speed" class="big-text bold center no-spin no-border" step="1"></div><button type="roll" name="roll_shaped_speed" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=SPEED>Speed</span>}} {{text_big=[[@{speed}]]}}"><span name="attr_speed" class="presentation big-text bold block center"></span><div class="wrap-box-title" data-i18n="SPEED"></div></button></div></div></div><div class="shaped-row"><div class="col-60 center"><div class="heart mar-b-smd"><div class="shaped-row center flex-end no-wrap pad-t-seven"><div class="col-40"><input type="number" name="attr_HP" class="big-text bold no-spin no-border" step="1"></div><div class="heart-divider pad-l-sm pad-r-sm">&#47;</div><div class="col-40"><input type="number" name="attr_HP_max" class="big-text bold no-spin no-border" min="1" step="1"></div></div><button type="roll" name="roll_shaped_hp" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=HIT_POINTS>Hit points</span>}} {{text_big=[[@{HP}]]&#47;[[@{HP|max}]]}}"><div class="shaped-row center"><div class="wrap-box-title col-70" data-i18n="HIT_POINTS"></div></div></button></div></div><div class="col-40 center"><div class="temp-heart mar-b-smd"><div class="shaped-row center pad-t-lg"><div class="col-40"><input type="number" name="attr_temp_HP" class="no-spin no-border" min="0" step="1"></div></div><button type="roll" name="roll_shaped_temp_hp" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=HIT_POINTS_TEMPORARY>Temporary hit points</span>}} {{text_big=[[@{temp_HP}]]}}"><div class="shaped-row center"><div class="wrap-box-title col-70" data-i18n="HIT_POINTS_TEMP"></div></div></button></div></div></div><div class="shaped-row"><div class="col-37 pad-r-sm"><div class="hit-dice wrap-box center mar-b-smd"><input type="checkbox" name="attr_hd_d2_toggle" value="1" class="toggle-hd-d2 hidden"> <input type="checkbox" name="attr_hd_d4_toggle" value="1" class="toggle-hd-d4 hidden"> <input type="checkbox" name="attr_hd_d6_toggle" value="1" class="toggle-hd-d6 hidden"> <input type="checkbox" name="attr_hd_d8_toggle" value="1" class="toggle-hd-d8 hidden"> <input type="checkbox" name="attr_hd_d10_toggle" value="1" class="toggle-hd-d10 hidden"> <input type="checkbox" name="attr_hd_d12_toggle" value="1" class="toggle-hd-d12 hidden"> <input type="checkbox" name="attr_hd_d20_toggle" value="1" class="toggle-hd-d20 hidden"><div class="shaped-row center flex-end toggle-hd-d2"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d2" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d2_max" class="center"></span></div><input type="hidden" name="attr_hd_d2_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d2" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d2_query}d2 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d2}}} {{uses_max=@{hd_d2|max}}} @{roll_info} {{roll1=[[{((@{hd_d2_query})d2[d2 * hd] + ((@{hd_d2_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d2</button></div></div><div class="shaped-row center flex-end toggle-hd-d4"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d4" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d4_max" class="center"></span></div><input type="hidden" name="attr_hd_d4_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d4" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d4_query}d4 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d4}}} {{uses_max=@{hd_d4|max}}} @{roll_info} {{roll1=[[{((@{hd_d4_query})d4[d4 * hd] + ((@{hd_d4_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d4</button></div></div><div class="shaped-row center flex-end toggle-hd-d6"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d6" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d6_max" class="center"></span></div><input type="hidden" name="attr_hd_d6_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d6" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d6_query}d6 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d6}}} {{uses_max=@{hd_d6|max}}} @{roll_info} {{roll1=[[{((@{hd_d6_query})d6[d6 * hd] + ((@{hd_d6_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d6</button></div></div><div class="shaped-row center flex-end toggle-hd-d8"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d8" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d8_max" class="center"></span></div><input type="hidden" name="attr_hd_d8_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d8" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d8_query}d8 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d8}}} {{uses_max=@{hd_d8|max}}} @{roll_info} {{roll1=[[{((@{hd_d8_query})d8[d8 * hd] + ((@{hd_d8_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d8</button></div></div><div class="shaped-row center flex-end toggle-hd-d10"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d10" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d10_max" class="center"></span></div><input type="hidden" name="attr_hd_d10_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d10" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d10_query}d10 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d10}}} {{uses_max=@{hd_d10|max}}} @{roll_info} {{roll1=[[{((@{hd_d10_query})d10[d10 * hd] + ((@{hd_d10_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d10</button></div></div><div class="shaped-row center flex-end toggle-hd-d12"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d12" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d12_max" class="center"></span></div><input type="hidden" name="attr_hd_d12_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d12" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d12_query}d12 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d12}}} {{uses_max=@{hd_d12|max}}} @{roll_info} {{roll1=[[{((@{hd_d12_query})d12[d12 * hd] + ((@{hd_d12_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d12</button></div></div><div class="shaped-row center flex-end toggle-hd-d20"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d20" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d20_max" class="center"></span></div><input type="hidden" name="attr_hd_d20_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d20" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d20_query}d20 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d20}}} {{uses_max=@{hd_d20|max}}} @{roll_info} {{roll1=[[{((@{hd_d20_query})d20[d20 * hd] + ((@{hd_d20_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d20</button></div></div><div class="wrap-box-title" data-i18n="HIT_DICE"></div></div></div><div class="col-63 pad-l-sm"><div class="death-saving-throw wrap-box center mar-b-smd"><div class="edit"><label class="checkbox-wrap"><input type="checkbox" name="attr_death_saving_throw_prof" value="@{PB}"> <span data-i18n="PROFICIENT"></span></label></div><div class="shaped-row vert-center death-success"><div class="col-50 small-label right" data-i18n="SUCCESSES"></div><div class="col-50 center inline-block-wrapper relative"><input type="radio" name="attr_death_saving_throw_successes" value="0" checked="checked"><span>&#10006;</span> <input type="radio" name="attr_death_saving_throw_successes" value="1"><span></span> <input type="radio" name="attr_death_saving_throw_successes" value="2"><span></span> <input type="radio" name="attr_death_saving_throw_successes" value="3"><span></span><hr class="absolute death-saving-throw-hr"></div></div><div class="shaped-row vert-center death-saving-throw death-fail"><div class="col-50 small-label right" data-i18n="FAILURES"></div><div class="col-50 center inline-block-wrapper relative"><input type="radio" name="attr_death_saving_throw_failures" value="0" checked="checked"><span>&#10006;</span> <input type="radio" name="attr_death_saving_throw_failures" value="1"><span></span> <input type="radio" name="attr_death_saving_throw_failures" value="2"><span></span> <input type="radio" name="attr_death_saving_throw_failures" value="3"><span></span><hr class="absolute death-saving-throw-hr"></div></div><button type="roll" name="roll_shaped_death_saving_throw" value="@{death_save_output_option} &{template:5e-shaped} {{death_saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} @{show_character_name} {{title=<span data-i18n=DEATH_SAVING_THROW>Death saving throw</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{death_saving_throw_prof}[proficient] + (@{global_saving_throw_bonus})[global saving throw bonus]]]}} @{roll_setting} + (@{global_saving_throw_bonus})[global saving throw bonus]]]}} {{death_saving_throw_successes=@{death_saving_throw_successes}}} {{death_saving_throw_failures=@{death_saving_throw_failures}}} @{attacher_death_saving_throw}"><div class="wrap-box-title center" data-i18n="DEATH_SAVES"></div></button></div></div></div></div><div class="col-42 pad-l-sm"><div class="spell-slots-points wrap-box center mar-b-smd"><input type="checkbox" name="attr_spell_slots_toggle" class="toggle-spell-slots edit" checked="checked"><span class="toggle-spell-slots edit button" data-i18n="SPELL_SLOTS"></span> <input type="checkbox" name="attr_spell_points_toggle" class="toggle-spell-points edit"><span class="toggle-spell-points edit button" data-i18n="SPELL_POINTS"></span> <input type="checkbox" name="attr_spell_slots_all" class="toggle-spell-slots-all edit"><span class="toggle-spell-slots-all edit button" data-i18n="ALL"></span><div class="spell-slots"><div class="shaped-row spell-level-1 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="1st"></div><div class="col-23"><input type="number" name="attr_spell_slots_l1" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l1_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l1_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l1_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-2 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="2nd"></div><div class="col-23"><input type="number" name="attr_spell_slots_l2" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l2_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l2_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l2_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-3 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="3rd"></div><div class="col-23"><input type="number" name="attr_spell_slots_l3" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l3_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l3_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l3_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-4 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="4th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l4" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l4_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l4_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l4_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-5 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="5th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l5" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l5_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l5_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l5_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-6 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="6th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l6" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l6_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l6_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l6_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-7 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="7th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l7" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l7_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l7_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l7_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-8 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="8th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l8" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l8_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l8_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l8_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-9 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="9th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l9" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l9_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l9_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l9_max" class="pseudo-input center border-bottom"></span></div></div><button type="roll" name="roll_shaped_spells" class="wrapper-button" value="@{spells_macro_var}"><div class="wrap-box-title center" data-i18n="SPELL_SLOTS_TITLE"></div></button></div><div class="spell-points"><div class="shaped-row spell-level-1 center vert-center"><div class="col-20 center" data-i18n="1st"></div><div class="col-20 center pad-l-sm"><span>2</span></div></div><div class="shaped-row spell-level-2 center vert-center"><div class="col-20 center" data-i18n="2nd"></div><div class="col-20 center pad-l-sm"><span>3</span></div></div><div class="shaped-row spell-level-3 center vert-center"><div class="col-20 center" data-i18n="3rd"></div><div class="col-20 center pad-l-sm"><span>5</span></div></div><div class="shaped-row spell-level-4 center vert-center"><div class="col-20 center" data-i18n="4th"></div><div class="col-20 center pad-l-sm"><span>6</span></div></div><div class="shaped-row spell-level-5 center vert-center"><div class="col-20 center" data-i18n="5th"></div><div class="col-20 center pad-l-sm"><span>7</span></div></div><div class="shaped-row spell-level-6 center vert-center"><div class="col-20 center" data-i18n="6th"></div><div class="col-20 center pad-l-sm"><span>9</span></div></div><div class="shaped-row spell-level-7 center vert-center"><div class="col-20 center" data-i18n="7th"></div><div class="col-20 center pad-l-sm"><span>10</span></div></div><div class="shaped-row spell-level-8 center vert-center"><div class="col-20 center" data-i18n="8th"></div><div class="col-20 center pad-l-sm"><span>11</span></div></div><div class="shaped-row spell-level-9 center vert-center"><div class="col-20 center" data-i18n="9th"></div><div class="col-20 center pad-l-sm"><span>13</span></div></div><div class="shaped-row center no-background"><div class="col-35 center pad-r-sm"><input type="number" name="attr_spell_points" value="0"></div><div class="col-05 center">&#47;</div><div class="col-35 center pad-l-sm"><input type="number" name="attr_spell_points_max" value="0" min="0"></div></div><div class="wrap-box-title center"><span class="spell-points" data-i18n="SPELL_POINTS_TITLE"></span></div></div></div><div class="resistances-immunities wrap-box mar-b-smd"><div class="damage-vulnerabilities"><input type="hidden" name="attr_damage_vulnerabilities_exist" class="item-toggle"> <button type="roll" name="roll_shaped_damage_vulnerabilities" class="wrapper-button item-to-toggle" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=DAMAGE_VULNERABILITIES>Damage vulnerabilities</span>}} {{text=@{damage_vulnerabilities}}}"><span class="heading" data-i18n="DAMAGE_VULNERABILITIES">.</span> <span name="attr_damage_vulnerabilities" class="presentation pre-line"></span></button><textarea name="attr_damage_vulnerabilities" class="edit two-line-textarea no-border"></textarea></div><div class="damage-resistances"><input type="hidden" name="attr_damage_resistances_exist" class="item-toggle"> <button type="roll" name="roll_shaped_damage_resistances" class="wrapper-button item-to-toggle" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=DAMAGE_RESISTANCES>Damage resistances</span>}} {{text=@{damage_resistances}}}"><span class="heading" data-i18n="DAMAGE_RESISTANCES">.</span> <span name="attr_damage_resistances" class="presentation pre-line"></span></button><textarea name="attr_damage_resistances" class="edit two-line-textarea no-border"></textarea></div><div class="damage-immunities"><input type="hidden" name="attr_damage_immunities_exist" class="item-toggle"> <button type="roll" name="roll_shaped_damage_immunities" class="wrapper-button item-to-toggle" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=DAMAGE_IMMUNITIES>Damage immunities</span>}} {{text=@{damage_immunities}}}"><span class="heading" data-i18n="DAMAGE_IMMUNITIES">.</span> <span name="attr_damage_immunities" class="presentation pre-line"></span></button><textarea name="attr_damage_immunities" class="edit two-line-textarea no-border"></textarea></div><div class="condition-immunities"><input type="hidden" name="attr_condition_immunities_exist" class="item-toggle"> <button type="roll" name="roll_shaped_condition_immunities" class="wrapper-button item-to-toggle" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=CONDITION_IMMUNITIES>Condition immunities</span>}} {{text=@{condition_immunities}}}"><span class="heading" data-i18n="CONDITION_IMMUNITIES">.</span> <span name="attr_condition_immunities" class="presentation pre-line"></span></button><textarea name="attr_condition_immunities" class="edit two-line-textarea no-border"></textarea></div><div class="wrap-box-title center" data-i18n="RESISTANCES_AND_IMMUNITIES"></div></div><div class="exhaustion wrap-box relative mar-b-smd"><div class="shaped-row vert-center"><div class="exhaustion-wrapper"><input type="number" name="attr_exhaustion_level" class="no-spin bold big-font no-border" min="0" value="0" max="6"></div><button type="roll" name="roll_shaped_exhaustion" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=EXHAUSTION_LEVEL>Exhaustion level</span>}} {{text_big=[[@{exhaustion_level}]]}}"><div class="wrap-box-title white-space-no-wrap" data-i18n="EXHAUSTION_LEVEL"></div></button></div><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label"><table><thead><tr><th data-i18n="LEVEL"></th><th data-i18n="EFFECT"></th></tr></thead><tbody><tr><td class="center">1</td><td data-i18n="EXHAUSTION_LEVEL_1"></td></tr><tr><td class="center">2</td><td data-i18n="EXHAUSTION_LEVEL_2"></td></tr><tr><td class="center">3</td><td data-i18n="EXHAUSTION_LEVEL_3"></td></tr><tr><td class="center">4</td><td data-i18n="EXHAUSTION_LEVEL_4"></td></tr><tr><td class="center">5</td><td data-i18n="EXHAUSTION_LEVEL_5"></td></tr><tr><td class="center">6</td><td data-i18n="EXHAUSTION_LEVEL_6"></td></tr></tbody></table></div></div></div></div><span class="edit" data-i18n="SHOW_RESTS"></span><input type="checkbox" name="attr_show_rests" class="edit item-shown"><div class="wrap-box no-wrap relative mar-b-smd item-to-show"><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">A</div><div class="tooltip-content-left small-label" data-i18n="REQUIRES_API"></div></div></div><div class="shaped-row"><div class="pad-r-sm"><button type="roll" name="roll_shaped_short_rest" class="visible-button" value="!shaped-rest --short --id @{character_id}"><span data-i18n="SHORT_REST"></span></button></div><div class="pad-l-sm"><button type="roll" name="roll_shaped_long_rest" class="visible-button" value="!shaped-rest --long --id @{character_id}"><span data-i18n="LONG_REST"></span></button></div></div><div class="wrap-box-title center" data-i18n="RESTS"></div></div></div></div><div><div class="attacks wrap-box mar-b-smd"><div class="shaped-row"><div class="col-35 wrap-box-label light-label pad-r-sm" data-i18n="ATTACK"></div><div class="col-08 wrap-box-label light-label center pad-r-sm" data-i18n="ATK"></div><div class="col-57 wrap-box-label light-label" data-i18n="DAMAGE"></div></div><fieldset class="repeating_attack"><div class="attack compendium-drop-target relative mar-b-sm"><input type="hidden" name="attr_modifiers" accept="Modifiers"> <input type="hidden" name="attr_properties" accept="Properties"> <input type="hidden" name="attr_freetext" accept="Content"> <input type="hidden" name="attr_weight" accept="Weight"> <button type="roll" name="roll_attack" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name}}} {{action=1}} {{reach=@{reach}}} {{range=@{range}}} @{roll_toggle} @{ammo_toggle} @{saving_throw_toggle} @{damage_toggle} @{second_damage_toggle} {{uses=@{uses}}} {{uses_max=@{uses|max}}} @{attacher_attack} @{hide_gm_info} @{extras_toggle}"><div class="shaped-row vert-center"><div class="col-35 pad-r-sm"><input type="text" name="attr_name" readonly="readonly"></div><div class="col-08 pad-r-sm"><input type="text" name="attr_to_hit" class="center" readonly="readonly"></div><div class="col-57"><input type="text" name="attr_damage_string" readonly="readonly"></div></div></button> <input type="checkbox" name="attr_toggle_details" class="toggle-icon-settings edit" checked="checked"><span class="toggle-icon-settings pictos edit">y</span><div class="details edit"><div class="shaped-row"><div class="col-40 center"><input type="text" name="attr_name" class="center" data-i18n-placeholder="NAME" accept="Name"><div class="small-label" data-i18n="NAME"></div></div><div class="col-17 center pad-l-sm pad-r-sm"><select name="attr_type" accept="Item Type"><option value="Other" data-i18n="OTHER">Other</option><option value="Melee Weapon" data-i18n="MELEE">Melee</option><option value="Ranged Weapon" data-i18n="RANGED">Ranged</option></select><div class="small-label" data-i18n="TYPE"></div></div><div class="col-10 center pad-l-sm pad-r-sm"><input type="text" name="attr_reach" class="center"><div class="small-label" data-i18n="REACH"></div></div><div class="col-18 center pad-l-sm pad-r-sm"><input type="text" name="attr_range" class="center" accept="Range"><div class="small-label" data-i18n="RANGE"></div></div><div class="col-15 pad-l-sm"><div class="shaped-row vert-center no-wrap"><div class="pad-r-sm"><input type="number" name="attr_uses" class="no-spin" step="1"></div><div>/</div><div class="pad-l-sm"><input type="number" name="attr_uses_max" class="no-spin" step="1"></div></div><div class="small-label center" data-i18n="USES"></div></div></div><input type="hidden" name="attr_attack_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_roll_toggle" value="{{vs_ac=1}} @{roll_info} {{roll1=[[@{shaped_d20}cs>@{crit_range} + @{attack_formula}]]}} @{roll_setting}cs>@{crit_range} + @{attack_formula}]]}} {{targetAC=@{attacks_vs_target_ac}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle" checked="checked"><div class="bold italic mar-r-sm"><span data-i18n="ATTACK"></span>.</div><div class="attack-toggle col-08 center pad-r-sm"><input type="checkbox" name="attr_proficiency" checked="checked"><div class="small-label" data-i18n="PROF"></div></div><div class="attack-toggle col-16 center pad-r-sm"><select name="attr_attack_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_attack_bonus" class="center"></div><div class="attack-toggle col-16 center pad-l-sm"><input type="number" name="attr_crit_range" class="center" value="20" step="1" min="1" max="20"><div class="small-label" data-i18n="CRIT_RANGE"></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_saving_throw_toggle" value="{{saving_throw_condition=@{saving_throw_condition}}} {{saving_throw_dc=@{saving_throw_dc}}} {{saving_throw_vs_ability=@{saving_throw_vs_ability}}} {{saving_throw_failure=@{saving_throw_failure}}} {{saving_throw_success=@{saving_throw_success}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="SAVING_THROW"></span>.</div><div class="attack-toggle col-65"><textarea class="one-line-textarea" name="attr_saving_throw_condition" data-i18n-placeholder="IF_THE_TARGET_IS"></textarea></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_ability"><option value="">&#8212;</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_saving_throw_bonus"></div><div class="attack-toggle center pad-l-sm pad-r-sm">=</div><div class="attack-toggle center pad-l-sm pad-r-sm" data-i18n="DC"></div><div class="attack-toggle col-09 center"><input type="number" name="attr_saving_throw_dc" readonly="readonly"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_vs_ability" accept="Save"><option value="STRENGTH" data-i18n="STR">Str</option><option value="DEXTERITY" data-i18n="DEX">Dex</option><option value="CONSTITUTION" data-i18n="CON">Con</option><option value="INTELLIGENCE" data-i18n="INT">Int</option><option value="WISDOM" data-i18n="WIS">Wis</option><option value="CHARISMA" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-50 pad-r-sm"><textarea class="one-line-textarea" name="attr_saving_throw_failure" data-i18n-placeholder="OR"></textarea></div><div class="attack-toggle col-50 pad-l-sm"><textarea class="one-line-textarea" name="attr_saving_throw_success" data-i18n-placeholder="HALF_DAMAGE" accept="Save Success"></textarea></div></div><input type="hidden" name="attr_damage_formula"> <input type="hidden" name="attr_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_damage_toggle" value="{{damage=[[@{damage_formula}]]}} {{damage_type=@{damage_type}}} {{crit_damage=[[0d0 + @{damage_crit}[crit damage] @{damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_damage" class="center" accept="Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_damage_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_damage_type" class="center" data-i18n-placeholder="SLASHING" accept="Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><input type="hidden" name="attr_second_damage_formula"> <input type="hidden" name="attr_second_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_second_damage_toggle" value="{{second_damage=[[@{second_damage_formula}]]}} {{second_damage_type=@{second_damage_type}}} {{second_crit_damage=[[0d0 + @{second_damage_crit}[crit damage] @{second_damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_second_damage" class="center" accept="Secondary Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_second_damage_ability"><option value="" selected="selected">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_second_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_second_damage_type" class="center" data-i18n-placeholder="FIRE" accept="Secondary Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_second_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_extras_toggle" value="{{emote=@{emote}}} {{freetext=@{freetext}}} @{freeform}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="EXTRAS"></span>.</div><div class="attack-toggle col-75 center mar-b-sm"><textarea class="one-line-textarea" name="attr_emote"></textarea><div class="small-label" data-i18n="EMOTE"></div></div><div class="attack-toggle col-100 center"><textarea name="attr_freetext" class="two-line-textarea"></textarea><div class="small-label" data-i18n="FREETEXT"></div></div><div class="attack-toggle col-100 center mar-t-sm"><textarea name="attr_freeform" class="one-line-textarea"></textarea><div class="small-label" data-i18n="FREEFORM"></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="hidden" name="attr_ammo_toggle_var"> <input type="checkbox" name="attr_ammo_toggle" value="@{ammo_toggle_var}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="AMMO"></span>.</div><div class="attack-toggle col-35 pad-l-sm ad-r-sm"><input type="text" name="attr_ammo_field_name"><div class="small-label center" data-i18n="FIELD"></div></div><div class="attack-toggle col-12 pad-l-sm"><input type="number" name="attr_ammo_used" value="1" step="1"><div class="small-label center" data-i18n="USED"></div></div></div></div></div></fieldset><div class="ammo mar-t-md"><div class="edit wrap-box-label light-label mar-b-sm" data-i18n="AMMO"></div><fieldset class="repeating_ammo"><div class="shaped-row compendium-drop-target no-wrap"><div><input type="number" name="attr_qty" min="0" step="1"><div class="small-label edit center" data-i18n="QTY"></div></div><div class="edit pad-l-sm"><input type="number" name="attr_weight" class="no-spin" value=".05" step=".005" accept="Weight"><div class="small-label center" data-i18n="WEIGHT"></div></div></div><div class="small-label center"><button type="roll" name="roll_ammo" class="presentation" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name}}} {{subheader=<span data-i18n=AMMO>Ammo</span>}} {{text_top=@{qty}}}" tabindex="-1"><span name="attr_name" class="pseudo-input"></span></button> <input type="text" name="attr_name" class="edit center small-label no-border" data-i18n-placeholder="ARROWS" accept="Name"></div></fieldset></div><button type="roll" name="roll_shaped_attacks" class="wrapper-button" value="/w @{character_name} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=ATTACKS>Attacks</span>}} {{action=1}} {{text_big=@{attacks_macro_var}}}"><div class="wrap-box-title center" data-i18n="ATTACKS"></div></button></div></div><div><div class="wrap-box"><div class="shaped-row"><div class="col-22"><div class="coin shaped-row no-wrap vert-center mar-t-md"><div class="wrap-box col-38"><button type="roll" name="roll_shaped_coinage_cp" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=COPPER_PIECES>Copper pieces</span>}} {{text_big=[[@{cp}]]}}" tabindex="-1"><div class="light-label pad-r-sm" data-i18n="COINS_CP"></div></button></div><div class="shaped-row wrap-box coin-value-wrap"><input type="number" name="attr_cp" class="no-spin no-border" value="0" min="0" step="1"></div></div><div class="coin shaped-row no-wrap vert-center mar-t-md"><div class="wrap-box col-38"><button type="roll" name="roll_shaped_coinage_sp" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=silver_PIECES>Silver pieces</span>}} {{text_big=[[@{sp}]]}}" tabindex="-1"><div class="light-label pad-r-sm" data-i18n="COINS_SP"></div></button></div><div class="shaped-row wrap-box coin-value-wrap"><input type="number" name="attr_sp" class="no-spin no-border" value="0" min="0" step="1"></div></div><div class="coin shaped-row no-wrap vert-center mar-t-md"><div class="wrap-box col-38"><button type="roll" name="roll_shaped_coinage_ep" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=ELECTRUM_PIECES>Electrum pieces</span>}} {{text_big=[[@{ep}]]}}" tabindex="-1"><div class="light-label pad-r-sm" data-i18n="COINS_EP"></div></button></div><div class="shaped-row wrap-box coin-value-wrap"><input type="number" name="attr_ep" class="no-spin no-border" value="0" min="0" step="1"></div></div><div class="coin shaped-row no-wrap vert-center mar-t-md"><div class="wrap-box col-38"><button type="roll" name="roll_shaped_coinage_gp" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=GOLD_PIECES>Gold pieces</span>}} {{text_big=[[@{gp}]]}}" tabindex="-1"><div class="light-label pad-r-sm" data-i18n="COINS_GP"></div></button></div><div class="shaped-row wrap-box coin-value-wrap"><input type="number" name="attr_gp" class="no-spin no-border" value="0" min="0" step="1"></div></div><div class="coin shaped-row no-wrap vert-center mar-t-md"><div class="wrap-box col-38"><button type="roll" name="roll_shaped_coinage_pp" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=PLATINUM_PIECES>Platinum pieces</span>}} {{text_big=[[@{pp}]]}}" tabindex="-1"><div class="light-label pad-r-sm" data-i18n="COINS_PP"></div></button></div><div class="shaped-row wrap-box coin-value-wrap"><input type="number" name="attr_pp" class="no-spin no-border" value="0" min="0" step="1"></div></div><div class="coin shaped-row no-wrap vert-center mar-t-md"><div class="wrap-box col-38"><button type="roll" name="roll_shaped_coinage_total_gp" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=TOTAL_GOLD_VALUE>Total gold value</span>}} {{text_big=[[@{total_gp}]]}}" tabindex="-1"><div class="light-label bold pad-r-sm" data-i18n="COINS_GP"></div></button></div><div class="shaped-row wrap-box coin-value-wrap"><input type="number" name="attr_total_gp" class="bold no-border" value="0" readonly="readonly"></div></div></div><div class="col-78 core-equipment pad-l-sm"><div><div class="shaped-row"><div class="col-06"></div><div class="col-57 wrap-box-label light-label pad-l-sm pad-r-sm" data-i18n="ARMOR"></div><div class="col-25 wrap-box-label light-label center pad-r-sm" data-i18n="USES"></div><div class="col-12 wrap-box-label light-label center" data-i18n="AC"></div></div><fieldset class="repeating_armor"><div class="shaped-row compendium-drop-target vert-center"><div class="col-06 center"><input type="checkbox" name="attr_worn" checked="checked"></div><div class="col-57 pad-l-sm pad-r-sm"><button type="roll" name="roll_armor" class="presentation wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name}}} {{armor=1}} {{text_top=AC [[@{ac_base}[ac] + @{ac_bonus}[bonus ac]]]}} {{uses=@{uses}}} {{uses_max=@{uses|max}}}"><span name="attr_name"></span></button> <input type="text" name="attr_name" class="edit" accept="Name"> <input type="hidden" name="attr_type" accept="Item Type"> <input type="hidden" name="attr_ac_base" accept="AC"> <input type="hidden" name="attr_ac_bonus"> <input type="hidden" name="attr_modifiers" accept="Modifiers"> <input type="hidden" name="attr_strength_requirements"> <input type="hidden" name="attr_stealth" accept="Stealth"> <input type="hidden" name="attr_weight" accept="Weight"></div><div class="col-25 shaped-row flex-end no-wrap pad-r-sm"><div class="shaped-row flex-end no-wrap"><input type="checkbox" name="attr_show_uses" class="edit small-checkbox show-uses" value="1"><div class="col-42 show-uses pad-r-sm"><input type="number" name="attr_uses" class="no-spin no-border" step="1"></div><div class="show-uses">/</div><div class="col-42 show-uses pad-l-sm"><input type="number" name="attr_uses_max" class="no-spin no-border" step="1"></div></div></div><div class="col-12 center pad-r-sm"><span name="attr_ac_total"></span></div></div></fieldset></div><hr><div class="mar-t-md"><div class="shaped-row"><div class="col-06"></div><div class="col-57 wrap-box-label light-label pad-l-sm pad-r-sm" data-i18n="EQUIPMENT"></div><div class="col-25 wrap-box-label light-label center pad-r-sm" data-i18n="USES"></div><div class="col-12 wrap-box-label light-label center" data-i18n="QTY"></div></div><div class="equipment-wrapper"><fieldset class="repeating_equipment"><div class="shaped-row compendium-drop-target vert-center"><div class="col-06 center"><input type="checkbox" name="attr_carried" checked="checked"></div><div class="col-57 pad-l-sm pad-r-sm"><button type="roll" name="roll_equipment" class="presentation" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name}}} {{equipment=1}} {{text=@{content}}} {{uses=@{uses}}} {{uses_max=@{uses|max}}}"><span name="attr_name"></span></button> <input type="text" name="attr_name" class="edit" accept="Name"> <input type="hidden" name="attr_content" accept="Content"> <input type="hidden" name="attr_weight" accept="Weight"></div><div class="col-25 pad-r-sm"><div class="shaped-row flex-end no-wrap"><input type="checkbox" name="attr_show_uses" class="edit small-checkbox show-uses" value="1"><div class="col-42 show-uses pad-r-sm"><input type="number" name="attr_uses" class="no-spin no-border" step="1"></div><div class="show-uses">/</div><div class="col-42 show-uses pad-l-sm"><input type="number" name="attr_uses_max" class="no-spin no-border" step="1"></div></div></div><div class="col-12"><input type="number" name="attr_qty" class="no-spin no-border" value="1" min="0" step="1"></div></div></fieldset></div></div></div></div><div class="wrap-box-title center" data-i18n="EQUIPMENT"></div></div></div></div><div class="col-29 pad-l-sm"><div class="wrap-box personality-traits center mar-b-sm"><textarea class="four-line-textarea background-textarea no-border edit" name="attr_personality_traits"></textarea><button type="roll" name="roll_shaped_personality_traits" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=PERSONALITY_TRAITS>Personality traits</span>}} {{text=@{personality_traits}}}"><span name="attr_personality_traits" class="presentation pre-line background-text"></span><div class="wrap-box-title center" data-i18n="PERSONALITY_TRAITS"></div></button></div><div class="wrap-box ideals center mar-b-sm"><textarea class="four-line-textarea background-textarea no-border edit" name="attr_ideals"></textarea><button type="roll" name="roll_shaped_ideals" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=IDEALS>Ideals</span>}} {{text=@{ideals}}}"><span name="attr_ideals" class="presentation pre-line background-text"></span><div class="wrap-box-title center" data-i18n="IDEALS"></div></button></div><div class="wrap-box bonds center mar-b-sm"><textarea class="four-line-textarea background-textarea no-border edit" name="attr_bonds"></textarea><button type="roll" name="roll_shaped_bonds" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=BONDS>Bonds</span>}} {{text=@{bonds}}}"><span name="attr_bonds" class="presentation pre-line background-text"></span><div class="wrap-box-title center" data-i18n="BONDS"></div></button></div><div class="wrap-box flaws center mar-b-smd"><textarea class="four-line-textarea background-textarea no-border edit" name="attr_flaws"></textarea><button type="roll" name="roll_shaped_flaws" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=FLAWS>Flaws</span>}} {{text=@{flaws}}}"><span name="attr_flaws" class="presentation pre-line background-text"></span><div class="wrap-box-title center" data-i18n="FLAWS"></div></button></div><div class="wrap-box"><input type="hidden" name="attr_traits_exist" class="item-toggle"><div class="item-to-toggle"><fieldset class="repeating_trait"><div class="relative mar-b-sm"><input type="hidden" name="attr_has_uses" class="item-toggle"><div class="col-17 absolute"><input type="hidden" name="attr_has_uses" class="item-toggle"><div class="item-to-toggle gray-bg small-label pad-l-sm"><div class="shaped-row vert-center no-wrap"><div><input type="number" name="attr_uses" class="no-spin no-border gray-bg no-pad" step="1"></div><div>/</div><div><input type="number" name="attr_uses_max" class="no-spin no-border gray-bg no-pad" step="1"></div></div><div class="edit small-label center" data-i18n="USES"></div></div></div><button type="roll" name="roll_trait" class="presentation trait wrapper-button traits-presentation-wrapper" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name}}} {{trait=1}} {{recharge=@{recharge}}} @{saving_throw_toggle} @{damage_toggle} @{second_damage_toggle} {{uses=@{uses}}} {{uses_max=@{uses|max}}} @{heal_toggle} @{hide_gm_info} @{extras_toggle}"><span class="heading"></span> <span name="attr_name" class="bold italic"></span><span name="attr_recharge_display" class="bold italic"></span><span class="bold italic">.</span> <span name="attr_display_text" class="pre-line"></span></button><div class="shaped-row edit"><div class="col-17"></div><div class="col-34 center pad-l-sm"><input type="text" name="attr_name" class="bold italic" data-i18n-placeholder="AMPHIBIOUS"></div><div class="col-17 center pad-l-sm pad-r-sm"><select name="attr_type"><option value="Other" data-i18n="OTHER">Other</option><option value="Melee Weapon" data-i18n="MELEE">Melee</option><option value="Ranged Weapon" data-i18n="RANGED">Ranged</option></select><div class="small-label" data-i18n="TYPE"></div></div><div class="col-26 center pad-l-sm"><input type="text" name="attr_recharge" class="center"><div class="small-label" data-i18n="RECHARGE"></div></div></div><input type="checkbox" name="attr_toggle_details" class="toggle-icon-settings edit" checked="checked"><span class="toggle-icon-settings pictos edit">y</span><div class="details edit"><div class="col-100 center"><textarea class="two-line-textarea" name="attr_display_text"></textarea><div class="small-label" data-i18n="DISPLAY_TEXT"></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_saving_throw_toggle" value="{{saving_throw_condition=@{saving_throw_condition}}} {{saving_throw_dc=@{saving_throw_dc}}} {{saving_throw_vs_ability=@{saving_throw_vs_ability}}} {{saving_throw_failure=@{saving_throw_failure}}} {{saving_throw_success=@{saving_throw_success}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="SAVING_THROW"></span>.</div><div class="attack-toggle col-65"><textarea class="one-line-textarea" name="attr_saving_throw_condition" data-i18n-placeholder="IF_THE_TARGET_IS"></textarea></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_ability"><option value="">&#8212;</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_saving_throw_bonus"></div><div class="attack-toggle center pad-l-sm pad-r-sm">=</div><div class="attack-toggle center pad-l-sm pad-r-sm" data-i18n="DC"></div><div class="attack-toggle col-09 center"><input type="number" name="attr_saving_throw_dc" readonly="readonly"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_vs_ability" accept="Save"><option value="STRENGTH" data-i18n="STR">Str</option><option value="DEXTERITY" data-i18n="DEX">Dex</option><option value="CONSTITUTION" data-i18n="CON">Con</option><option value="INTELLIGENCE" data-i18n="INT">Int</option><option value="WISDOM" data-i18n="WIS">Wis</option><option value="CHARISMA" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-50 pad-r-sm"><textarea class="one-line-textarea" name="attr_saving_throw_failure" data-i18n-placeholder="OR"></textarea></div><div class="attack-toggle col-50 pad-l-sm"><textarea class="one-line-textarea" name="attr_saving_throw_success" data-i18n-placeholder="HALF_DAMAGE" accept="Save Success"></textarea></div></div><input type="hidden" name="attr_damage_formula"> <input type="hidden" name="attr_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_damage_toggle" value="{{damage=[[@{damage_formula}]]}} {{damage_type=@{damage_type}}} {{crit_damage=[[0d0 + @{damage_crit}[crit damage] @{damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_damage" class="center" accept="Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_damage_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_damage_type" class="center" data-i18n-placeholder="FIRE" accept="Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><input type="hidden" name="attr_second_damage_formula"> <input type="hidden" name="attr_second_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_second_damage_toggle" value="{{second_damage=[[@{second_damage_formula}]]}} {{second_damage_type=@{second_damage_type}}} {{second_crit_damage=[[0d0 + @{second_damage_crit}[crit damage] @{second_damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_second_damage" class="center" accept="Secondary Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_second_damage_ability"><option value="" selected="selected">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_second_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_second_damage_type" class="center" data-i18n-placeholder="FIRE" accept="Secondary Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_second_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><input type="hidden" name="attr_heal_formula"><div class="shaped-row vert-center mar-t-sm"><input type="checkbox" name="attr_heal_toggle" value="{{heal=[[@{heal_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="HEAL"></span>.</div><div class="attack-toggle col-12"><input type="text" name="attr_heal" class="center" accept="Healing" placeholder="1d6"></div><div class="attack-toggle pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-16"><select name="attr_heal_ability"><option value="" selected="selected">&#8212;</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center"><input type="number" name="attr_heal_bonus"></div><div class="attack-toggle pad-l-sm pad-r-sm">+</div><div class="attack-toggle center"><input type="checkbox" name="attr_heal_query_toggle" value="?{Heal Bonus Amount|}" class="toggle-query"><span class="toggle-query button" data-i18n="QUERY"></span></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_extras_toggle" value="{{emote=@{emote}}} {{freetext=@{freetext}}} @{freeform}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="EXTRAS"></span>.</div><div class="attack-toggle col-75 center mar-b-sm"><textarea class="one-line-textarea" name="attr_emote"></textarea><div class="small-label" data-i18n="EMOTE"></div></div><div class="attack-toggle col-100 center"><textarea name="attr_freetext" class="two-line-textarea"></textarea><div class="small-label" data-i18n="FREETEXT"></div></div><div class="attack-toggle col-100 center mar-t-sm"><textarea name="attr_freeform" class="one-line-textarea"></textarea><div class="small-label" data-i18n="FREEFORM"></div></div></div></div></div></fieldset></div><button type="roll" name="roll_shaped_traits" class="wrapper-button" value="/w @{character_name} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=TRAITS>Traits</span>}} {{text_big=@{traits_macro_var}}}"><div class="wrap-box-title center" data-i18n="FEATURES_AND_TRAITS"></div></button></div></div></div></div><div class="section-npc"><div class="bar"></div><div class="npc-content-wrap"><div class="compendium-drop-target"><input type="hidden" name="attr_content_srd" accept="Content"> <input type="hidden" name="attr_spells_srd" accept="Spell Book"><div class="shaped-row"><div class="col-50 pad-r-md"><div><span name="attr_character_name" class="creature-name presentation"></span> <input type="text" name="attr_character_name" class="edit creature-name no-border" accept="Name" data-i18n-placeholder="DRAGON"></div><div class="shaped-row edit"><div class="col-20 pad-r-sm"><select name="attr_size" class="italic no-border" accept="Size"><option value="Tiny" data-i18n="TINY">Tiny</option><option value="Small" data-i18n="SMALL">Small</option><option value="Medium" data-i18n="MEDIUM">Medium</option><option value="Large" data-i18n="LARGE" selected="selected">Large</option><option value="Huge" data-i18n="HUGE">Huge</option><option value="Gargantuan" data-i18n="GARGANTUAN">Gargantuan</option></select></div><div class="col-30 pad-l-sm pad-r-sm"><input type="text" name="attr_type" class="italic no-border" data-i18n-placeholder="DRAGON" accept="Type"></div><div class="col-23 pad-l-sm"><input type="text" name="attr_alignment" class="italic no-border" data-i18n-placeholder="LAWFUL_EVIL" accept="Alignment"></div></div><span class="italic presentation"><span name="attr_size"></span> <span name="attr_type"></span>, <span name="attr_alignment"></span></span><div class="divider"></div><div class="top-stats"><div class="shaped-row flex-end"><button type="roll" name="roll_shaped_ac" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=AC>AC</span>}} {{text_top=[[@{ac}]]}} {{text_center=@{ac_note}}}"><span class="heading" data-i18n="ARMOR_CLASS"></span> <span class="presentation"><span name="attr_AC"></span> (<span name="attr_ac_note"></span>)</span></button><div class="col-06 edit pad-l-sm"><input type="hidden" name="attr_ac_srd" accept="AC"> <input type="number" name="attr_AC" class="no-border no-spin"></div><div class="col-38 edit pad-l-md"><div class="shaped-row no-wrap"><span>(</span> <input type="text" name="attr_ac_note" class="no-border"> <span>)</span></div></div></div><div class="shaped-row flex-end no-wrap"><button type="roll" name="roll_shaped_initiative" value="@{initiative_output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=INITIATIVE>Initiative</span>}} {{roll1=[[@{initiative_roll} + @{initiative_to_tracker} + @{initiative_tie_breaker}]]}} @{attacher_initiative}"><span class="heading" data-i18n="INITIATIVE"></span> <span name="attr_initiative" class="presentation"></span></button><div class="edit">+</div><div class="col-06 edit"><input type="text" name="attr_initiative_bonus" class="center no-border" value="0"></div><div class="edit">=</div><span name="attr_initiative" class="edit"></span></div><div class="shaped-row flex-end"><input type="hidden" name="attr_hp_srd" accept="HP"> <button type="roll" name="roll_shaped_hp" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=HIT_POINTS>Hit points</span>}} {{text_big=[[@{HP}]]&#47;[[@{HP|max}]]}}"><span class="heading" data-i18n="HIT_POINTS"></span> <span name="attr_HP" class="presentation"></span></button> <span class="presentation pad-l-sm"><button type="roll" name="roll_shaped_npc_hp" value="/w GM &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=HIT_POINTS_ROLLED>Hit points rolled</span>}}{{text_top=[[@{hp_formula}]]}} {{text_center=Average [[@{HP}]]}}">(<span name="attr_hp_formula"></span>)</button></span><div class="col-40 pad-l-sm edit"><div class="shaped-row"><div class="col-18 pad-r-sm"><input type="number" name="attr_hit_dice" class="no-border no-spin" class="no-spin" step="1"></div><div class="col-18 pad-r-sm"><select name="attr_hit_die" class="no-border"><option>d2</option><option>d4</option><option>d6</option><option>d8</option><option>d10</option><option>d12</option><option>d20</option></select></div><div class="col-64 pad-l-sm"><input type="text" name="attr_hp_extra" class="no-border"></div></div></div><div class="col-20 pad-l-lg"><input type="checkbox" name="attr_hd_d2_toggle" value="1" class="toggle-hd-d2 hidden"> <input type="checkbox" name="attr_hd_d4_toggle" value="1" class="toggle-hd-d4 hidden"> <input type="checkbox" name="attr_hd_d6_toggle" value="1" class="toggle-hd-d6 hidden"> <input type="checkbox" name="attr_hd_d8_toggle" value="1" class="toggle-hd-d8 hidden"> <input type="checkbox" name="attr_hd_d10_toggle" value="1" class="toggle-hd-d10 hidden"> <input type="checkbox" name="attr_hd_d12_toggle" value="1" class="toggle-hd-d12 hidden"> <input type="checkbox" name="attr_hd_d20_toggle" value="1" class="toggle-hd-d20 hidden"><div class="shaped-row center flex-end toggle-hd-d2"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d2" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d2_max" class="center"></span></div><input type="hidden" name="attr_hd_d2_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d2" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d2_query}d2 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d2}}} {{uses_max=@{hd_d2|max}}} @{roll_info} {{roll1=[[{((@{hd_d2_query})d2[d2 * hd] + ((@{hd_d2_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d2</button></div></div><div class="shaped-row center flex-end toggle-hd-d4"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d4" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d4_max" class="center"></span></div><input type="hidden" name="attr_hd_d4_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d4" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d4_query}d4 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d4}}} {{uses_max=@{hd_d4|max}}} @{roll_info} {{roll1=[[{((@{hd_d4_query})d4[d4 * hd] + ((@{hd_d4_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d4</button></div></div><div class="shaped-row center flex-end toggle-hd-d6"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d6" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d6_max" class="center"></span></div><input type="hidden" name="attr_hd_d6_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d6" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d6_query}d6 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d6}}} {{uses_max=@{hd_d6|max}}} @{roll_info} {{roll1=[[{((@{hd_d6_query})d6[d6 * hd] + ((@{hd_d6_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d6</button></div></div><div class="shaped-row center flex-end toggle-hd-d8"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d8" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d8_max" class="center"></span></div><input type="hidden" name="attr_hd_d8_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d8" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d8_query}d8 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d8}}} {{uses_max=@{hd_d8|max}}} @{roll_info} {{roll1=[[{((@{hd_d8_query})d8[d8 * hd] + ((@{hd_d8_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d8</button></div></div><div class="shaped-row center flex-end toggle-hd-d10"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d10" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d10_max" class="center"></span></div><input type="hidden" name="attr_hd_d10_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d10" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d10_query}d10 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d10}}} {{uses_max=@{hd_d10|max}}} @{roll_info} {{roll1=[[{((@{hd_d10_query})d10[d10 * hd] + ((@{hd_d10_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d10</button></div></div><div class="shaped-row center flex-end toggle-hd-d12"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d12" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d12_max" class="center"></span></div><input type="hidden" name="attr_hd_d12_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d12" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d12_query}d12 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d12}}} {{uses_max=@{hd_d12|max}}} @{roll_info} {{roll1=[[{((@{hd_d12_query})d12[d12 * hd] + ((@{hd_d12_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d12</button></div></div><div class="shaped-row center flex-end toggle-hd-d20"><div class="col-30 pad-r-sm"><input type="number" name="attr_hd_d20" class="no-spin no-border" min="0" step="1"></div><div class="col-05">&#47;</div><div class="col-30"><span name="attr_hd_d20_max" class="center"></span></div><input type="hidden" name="attr_hd_d20_query"><div class="col-33 center"><button type="roll" name="roll_shaped_hd_d20" class="bold" value="@{hit_dice_output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{hd_d20_query}d20 <span data-i18n=HIT_DICE>Hit dice</span>}} {{uses=@{hd_d20}}} {{uses_max=@{hd_d20|max}}} @{roll_info} {{roll1=[[{((@{hd_d20_query})d20[d20 * hd] + ((@{hd_d20_query}) * @{constitution_mod})[con mod * hd]), 0d0+1}kh1[minimum of 1]]]}} @{attacher_hit_dice}">d20</button></div></div></div></div><div class="shaped-row flex-end"><button type="roll" name="roll_shaped_npc_speed" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=SPEED>Speed</span>}} {{text_top=@{npc_speed}}}"><span class="heading" data-i18n="SPEED"></span> <span name="attr_npc_speed" class="presentation"></span></button><div class="col-80 pad-l-sm edit"><input type="text" name="attr_npc_speed" class="no-border" accept="Speed"></div></div><div class="divider"></div><div class="shaped-row"><div class="col-16 center pad-r-sm"><button type="roll" name="roll_shaped_strength_check" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=STRENGTH>Strength</span> <span data-i18n=CHECK class=lowercase>Check</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{strength_check_mod_formula}]]}} @{roll_setting} + @{strength_check_mod_formula}]]}} @{attacher_strength_check}" tabindex="-1"><div class="heading uppercase center" data-i18n="STR"></div><div class="presentation mar-t-sm"><span name="attr_strength" class="center"></span> (<span name="attr_strength_mod_with_sign" class="center"></span>)</div></button> <input type="hidden" name="attr_strength_mod"><div class="shaped-row center edit no-wrap"><div><input type="number" name="attr_strength" class="no-border no-spin" accept="STR"></div><div>+</div><div><input type="number" name="attr_strength_bonus" class="edit no-spin no-border" value="0" step="1"></div><div>(<span name="attr_strength_mod_with_sign" class="center"></span>)</div></div><div class="edit shaped-row no-wrap vert-center small-label"><span data-i18n="CHECK"></span><div>+</div><div><input type="number" name="attr_strength_check_bonus" class="no-spin no-border" value="0" step="1"></div><div>=</div><span class="mar-l-sm" name="attr_strength_check_mod"></span></div></div><div class="col-16 center pad-l-sm pad-r-sm"><button type="roll" name="roll_shaped_dexterity_check" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=DEXTERITY>Dexterity</span> <span data-i18n=CHECK class=lowercase>Check</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{dexterity_check_mod_formula}]]}} @{roll_setting} + @{dexterity_check_mod_formula}]]}} @{attacher_dexterity_check}" tabindex="-1"><div class="heading uppercase center" data-i18n="DEX"></div><div class="presentation mar-t-sm"><span name="attr_dexterity" class="center"></span> (<span name="attr_dexterity_mod_with_sign" class="center"></span>)</div></button> <input type="hidden" name="attr_dexterity_mod"><div class="shaped-row center edit no-wrap"><div><input type="number" name="attr_dexterity" class="no-border no-spin" accept="DEX"></div><div>+</div><div><input type="number" name="attr_dexterity_bonus" class="edit no-spin no-border" value="0" step="1"></div><div>(<span name="attr_dexterity_mod_with_sign" class="center"></span>)</div></div><div class="edit shaped-row no-wrap vert-center small-label"><span data-i18n="CHECK"></span><div>+</div><div><input type="number" name="attr_dexterity_check_bonus" class="no-spin no-border" value="0" step="1"></div><div>=</div><span class="mar-l-sm" name="attr_dexterity_check_mod"></span></div></div><div class="col-16 center pad-l-sm pad-r-sm"><button type="roll" name="roll_shaped_constitution_check" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=CONSTITUTION>Constitution</span> <span data-i18n=CHECK class=lowercase>Check</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{constitution_check_mod_formula}]]}} @{roll_setting} + @{constitution_check_mod_formula}]]}} @{attacher_constitution_check}" tabindex="-1"><div class="heading uppercase center" data-i18n="CON"></div><div class="presentation mar-t-sm"><span name="attr_constitution" class="center"></span> (<span name="attr_constitution_mod_with_sign" class="center"></span>)</div></button> <input type="hidden" name="attr_constitution_mod"><div class="shaped-row center edit no-wrap"><div><input type="number" name="attr_constitution" class="no-border no-spin" accept="CON"></div><div>+</div><div><input type="number" name="attr_constitution_bonus" class="edit no-spin no-border" value="0" step="1"></div><div>(<span name="attr_constitution_mod_with_sign" class="center"></span>)</div></div><div class="edit shaped-row no-wrap vert-center small-label"><span data-i18n="CHECK"></span><div>+</div><div><input type="number" name="attr_constitution_check_bonus" class="no-spin no-border" value="0" step="1"></div><div>=</div><span class="mar-l-sm" name="attr_constitution_check_mod"></span></div></div><div class="col-16 center pad-l-sm pad-r-sm"><button type="roll" name="roll_shaped_intelligence_check" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=INTELLIGENCE>Intelligence</span> <span data-i18n=CHECK class=lowercase>Check</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{intelligence_check_mod_formula}]]}} @{roll_setting} + @{intelligence_check_mod_formula}]]}} @{attacher_intelligence_check}" tabindex="-1"><div class="heading uppercase center" data-i18n="INT"></div><div class="presentation mar-t-sm"><span name="attr_intelligence" class="center"></span> (<span name="attr_intelligence_mod_with_sign" class="center"></span>)</div></button> <input type="hidden" name="attr_intelligence_mod"><div class="shaped-row center edit no-wrap"><div><input type="number" name="attr_intelligence" class="no-border no-spin" accept="INT"></div><div>+</div><div><input type="number" name="attr_intelligence_bonus" class="edit no-spin no-border" value="0" step="1"></div><div>(<span name="attr_intelligence_mod_with_sign" class="center"></span>)</div></div><div class="edit shaped-row no-wrap vert-center small-label"><span data-i18n="CHECK"></span><div>+</div><div><input type="number" name="attr_intelligence_check_bonus" class="no-spin no-border" value="0" step="1"></div><div>=</div><span class="mar-l-sm" name="attr_intelligence_check_mod"></span></div></div><div class="col-16 center pad-l-sm pad-r-sm"><button type="roll" name="roll_shaped_wisdom_check" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=WISDOM>Wisdom</span> <span data-i18n=CHECK class=lowercase>Check</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{wisdom_check_mod_formula}]]}} @{roll_setting} + @{wisdom_check_mod_formula}]]}} @{attacher_wisdom_check}" tabindex="-1"><div class="heading uppercase center" data-i18n="WIS"></div><div class="presentation mar-t-sm"><span name="attr_wisdom" class="center"></span> (<span name="attr_wisdom_mod_with_sign" class="center"></span>)</div></button> <input type="hidden" name="attr_wisdom_mod"><div class="shaped-row center edit no-wrap"><div><input type="number" name="attr_wisdom" class="no-border no-spin" accept="WIS"></div><div>+</div><div><input type="number" name="attr_wisdom_bonus" class="edit no-spin no-border" value="0" step="1"></div><div>(<span name="attr_wisdom_mod_with_sign" class="center"></span>)</div></div><div class="edit shaped-row no-wrap vert-center small-label"><span data-i18n="CHECK"></span><div>+</div><div><input type="number" name="attr_wisdom_check_bonus" class="no-spin no-border" value="0" step="1"></div><div>=</div><span class="mar-l-sm" name="attr_wisdom_check_mod"></span></div></div><div class="col-16 center pad-l-sm"><button type="roll" name="roll_shaped_charisma_check" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=CHARISMA>Charisma</span> <span data-i18n=CHECK class=lowercase>Check</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{charisma_check_mod_formula}]]}} @{roll_setting} + @{charisma_check_mod_formula}]]}} @{attacher_charisma_check}" tabindex="-1"><div class="heading uppercase center" data-i18n="CHA"></div><div class="presentation mar-t-sm"><span name="attr_charisma" class="center"></span> (<span name="attr_charisma_mod_with_sign" class="center"></span>)</div></button> <input type="hidden" name="attr_charisma_mod"><div class="shaped-row center edit no-wrap"><div><input type="number" name="attr_charisma" class="no-border no-spin" accept="CHA"></div><div>+</div><div><input type="number" name="attr_charisma_bonus" class="edit no-spin no-border" value="0" step="1"></div><div>(<span name="attr_charisma_mod_with_sign" class="center"></span>)</div></div><div class="edit shaped-row no-wrap vert-center small-label"><span data-i18n="CHECK"></span><div>+</div><div><input type="number" name="attr_charisma_check_bonus" class="no-spin no-border" value="0" step="1"></div><div>=</div><span class="mar-l-sm" name="attr_charisma_check_mod"></span></div></div></div><div class="divider"></div><input type="hidden" name="attr_saving_throws_srd" accept="Saving Throws"><div class="saving-throws shaped-row flex-end"><span class="heading" data-i18n="SAVING_THROWS"></span> <span class="pad-l-sm"></span> <span class="edit"><input type="checkbox" name="attr_strength_save_prof" value="@{PB}"></span><div class="col-1-3-em edit"><input type="number" name="attr_strength_save_bonus" class="no-spin small-label" value="0" step="1"></div><button type="roll" name="roll_shaped_strength_saving_throw" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=STRENGTH>Strength</span> <span data-i18n=SAVE class=lowercase>Save</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{strength_saving_throw_mod}]]}} @{roll_setting} + @{strength_saving_throw_mod}]]}} @{attacher_strength_saving_throw}" tabindex="-1"><span data-i18n="STR"></span> <span name="attr_strength_saving_throw_mod_with_sign" class="inline-block center"></span></button> <span class="pad-r-sm">,</span> <span class="edit border-left pad-l-sm"><input type="checkbox" name="attr_dexterity_save_prof" value="@{PB}"></span><div class="col-1-3-em edit"><input type="number" name="attr_dexterity_save_bonus" class="no-spin small-label" value="0" step="1"></div><button type="roll" name="roll_shaped_dexterity_saving_throw" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=DEXTERITY>Dexterity</span> <span data-i18n=SAVE class=lowercase>Save</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{dexterity_saving_throw_mod}]]}} @{roll_setting} + @{dexterity_saving_throw_mod}]]}} @{attacher_dexterity_saving_throw}" tabindex="-1"><span data-i18n="DEX"></span> <span name="attr_dexterity_saving_throw_mod_with_sign" class="inline-block center"></span></button> <span class="pad-r-sm">,</span> <span class="edit border-left pad-l-sm"><input type="checkbox" name="attr_constitution_save_prof" value="@{PB}"></span><div class="col-1-3-em edit"><input type="number" name="attr_constitution_save_bonus" class="no-spin small-label" value="0" step="1"></div><button type="roll" name="roll_shaped_constitution_saving_throw" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=CONSTITUTION>Constitution</span> <span data-i18n=SAVE class=lowercase>Save</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{constitution_saving_throw_mod}]]}} @{roll_setting} + @{constitution_saving_throw_mod}]]}} @{attacher_constitution_saving_throw}" tabindex="-1"><span data-i18n="CON"></span> <span name="attr_constitution_saving_throw_mod_with_sign" class="inline-block center"></span></button> <span class="pad-r-sm">,</span> <span class="edit border-left pad-l-sm"><input type="checkbox" name="attr_intelligence_save_prof" value="@{PB}"></span><div class="col-1-3-em edit"><input type="number" name="attr_intelligence_save_bonus" class="no-spin small-label" value="0" step="1"></div><button type="roll" name="roll_shaped_intelligence_saving_throw" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=INTELLIGENCE>Intelligence</span> <span data-i18n=SAVE class=lowercase>Save</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{intelligence_saving_throw_mod}]]}} @{roll_setting} + @{intelligence_saving_throw_mod}]]}} @{attacher_intelligence_saving_throw}" tabindex="-1"><span data-i18n="INT"></span> <span name="attr_intelligence_saving_throw_mod_with_sign" class="inline-block center"></span></button> <span class="pad-r-sm">,</span> <span class="edit border-left pad-l-sm"><input type="checkbox" name="attr_wisdom_save_prof" value="@{PB}"></span><div class="col-1-3-em edit"><input type="number" name="attr_wisdom_save_bonus" class="no-spin small-label" value="0" step="1"></div><button type="roll" name="roll_shaped_wisdom_saving_throw" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=WISDOM>Wisdom</span> <span data-i18n=SAVE class=lowercase>Save</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{wisdom_saving_throw_mod}]]}} @{roll_setting} + @{wisdom_saving_throw_mod}]]}} @{attacher_wisdom_saving_throw}" tabindex="-1"><span data-i18n="WIS"></span> <span name="attr_wisdom_saving_throw_mod_with_sign" class="inline-block center"></span></button> <span class="pad-r-sm">,</span> <span class="edit border-left pad-l-sm"><input type="checkbox" name="attr_charisma_save_prof" value="@{PB}"></span><div class="col-1-3-em edit"><input type="number" name="attr_charisma_save_bonus" class="no-spin small-label" value="0" step="1"></div><button type="roll" name="roll_shaped_charisma_saving_throw" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=CHARISMA>Charisma</span> <span data-i18n=SAVE class=lowercase>Save</span>}} @{roll_info} {{roll1=[[@{shaped_d20} + @{charisma_saving_throw_mod}]]}} @{roll_setting} + @{charisma_saving_throw_mod}]]}} @{attacher_charisma_saving_throw}" tabindex="-1"><span data-i18n="CHA"></span> <span name="attr_charisma_saving_throw_mod_with_sign" class="inline-block center"></span></button></div><input type="hidden" name="attr_skills_srd" accept="Skills"><div class="shaped-row skills"><span class="heading" data-i18n="SKILLS"></span> <span class="col-90 pad-l-sm"><fieldset class="repeating_skill"><div class="shaped-row no-wrap vert-center"><div class="col-1-3-em no-shrink edit"><select name="attr_skill_d20"><option value="@{shaped_d20}" data-i18n="NORMAL">Normal</option><option value="2d20@{d20_mod}kh1" data-i18n="ADVANTAGE">Advantage</option><option value="2d20@{d20_mod}kl1" data-i18n="DISADVANTAGE">Disadvantage</option></select></div><div class="col-1-3-em skill-select-wrapper edit"><select name="attr_proficiency" class="no-border"><option value="unproficient">&#8212; &#160;&#160;<span data-i18n="UNPROFICIENT">Unproficient</span></option><option value="proficient">&check; &#160;&#160; <span data-i18n="PROFICIENT">Proficient</span></option><option value="expertise">&cross; &#160;&#160; <span data-i18n="EXPERTISE">Expertise</span></option></select></div><div class="col-1-3-em edit"><input type="number" name="attr_bonus" class="no-spin small-label" value="0" step="1"></div><div class="col-6-em edit"><input type="text" name="attr_name"></div><button type="roll" name="roll_skill" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name} (<span data-i18n=@{ability_key}>@{ability_key}<span>)}} @{roll_info} @{skill_info} {{roll1=[[@{skill_d20} + @{formula}]]}} @{roll_setting} + @{formula}]]}} @{attacher_skill}" tabindex="-1"><div class="shaped-row no-wrap flex-end"><span name="attr_name" class="presentation skill-name white-space-no-wrap pad-r-sm"></span> <span name="attr_total_with_sign" class="inline-block center"></span></div></button> <input type="hidden" name="attr_formula"> <input type="hidden" name="attr_skill_info"> <input type="hidden" name="attr_ability_key"><div class="skills-ability-selector-wrapper edit pad-l-sm"><div class="shaped-row no-wrap vert-center"><span>(</span><select name="attr_ability" class="skills-ability-selector"><option value="0">&#8212;</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select><span>)</span></div></div><div class="pad-r-sm comma">,</div></div></fieldset><input type="checkbox" name="attr_generate_skills" class="toggle-pseudo-button edit"><span class="toggle-pseudo-button button edit" data-i18n="GENERATE_SKILLS"></span></span></div><div class="damage-vulnerabilities"><input type="hidden" name="attr_damage_vulnerabilities_exist" class="item-toggle"> <button type="roll" name="roll_shaped_damage_vulnerabilities" class="wrapper-button item-to-toggle" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=DAMAGE_VULNERABILITIES>Damage vulnerabilities</span>}} {{text=@{damage_vulnerabilities}}}"><span class="heading" data-i18n="DAMAGE_VULNERABILITIES"></span> <span name="attr_damage_vulnerabilities" class="presentation pre-line"></span></button><textarea name="attr_damage_vulnerabilities" class="edit two-line-textarea no-border" accept="Vulnerabilities"></textarea></div><div class="damage-resistances"><input type="hidden" name="attr_damage_resistances_exist" class="item-toggle"> <button type="roll" name="roll_shaped_damage_resistances" class="wrapper-button item-to-toggle" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=DAMAGE_RESISTANCES>Damage resistances</span>}} {{text=@{damage_resistances}}}"><span class="heading" data-i18n="DAMAGE_RESISTANCES"></span> <span name="attr_damage_resistances" class="presentation pre-line"></span></button><textarea name="attr_damage_resistances" class="edit two-line-textarea no-border" accept="Resistances"></textarea></div><div class="damage-immunities"><input type="hidden" name="attr_damage_immunities_exist" class="item-toggle"> <button type="roll" name="roll_shaped_damage_immunities" class="wrapper-button item-to-toggle" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=DAMAGE_IMMUNITIES>Damage immunities</span>}} {{text=@{damage_immunities}}}"><span class="heading" data-i18n="DAMAGE_IMMUNITIES"></span> <span name="attr_damage_immunities" class="presentation pre-line"></span></button><textarea name="attr_damage_immunities" class="edit two-line-textarea no-border" accept="Immunities"></textarea></div><div class="condition-immunities"><input type="hidden" name="attr_condition_immunities_exist" class="item-toggle"> <button type="roll" name="roll_shaped_condition_immunities" class="wrapper-button item-to-toggle" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=CONDITION_IMMUNITIES>Condition immunities</span>}} {{text=@{condition_immunities}}}"><span class="heading" data-i18n="CONDITION_IMMUNITIES"></span> <span name="attr_condition_immunities" class="presentation pre-line"></span></button><textarea name="attr_condition_immunities" class="edit two-line-textarea no-border" accept="Condition Immunities"></textarea></div><div class="shaped-row vert-center"><input type="hidden" name="attr_senses_exist" class="item-toggle"> <button type="roll" name="roll_shaped_senses" class="item-to-toggle" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=SENSES>Senses</span>}} {{text_top=@{senses}}}"><span class="heading" data-i18n="SENSES"></span> <span name="attr_senses" class="presentation"></span></button><div class="col-80 pad-l-sm edit"><input type="text" name="attr_senses" class="no-border" accept="Senses"></div></div><div class="shaped-row vert-center"><input type="hidden" name="attr_languages_exist" class="item-toggle"> <button type="roll" name="roll_shaped_languages" class="item-to-toggle" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=LANGUAGES>Languages</span>}} {{text_top=@{languages}}}"><span class="heading" data-i18n="LANGUAGES"></span> <span name="attr_languages" class="presentation"></span></button><div class="col-80 pad-l-sm edit"><input type="text" name="attr_languages" class="no-border" accept="Languages"></div></div><div class="shaped-row vert-center"><button type="roll" name="roll_shaped_challenge" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=CHALLENGE>Challenge</span>}} {{text_top=@{challenge}}} {{text_center=@{xp_readable} XP}}" tabindex="-1"><span class="heading" data-i18n="CHALLENGE"></span> <span class="presentation"><span name="attr_challenge"></span> (<span name="attr_xp_readable"></span> XP)</span></button> <input type="hidden" name="attr_xp"> <input type="hidden" name="attr_xp_readable"><div class="col-05 edit pad-l-sm"><input type="text" name="attr_challenge" class="no-border no-spin" accept="Challenge Rating"></div></div><div><button type="roll" name="roll_shaped_pb" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=PROFICIENCY_BONUS>Proficiency Bonus</span>}} {{text_top=[[@{pb}]]}}" tabindex="-1"><span class="heading" data-i18n="PROFICIENCY_BONUS"></span> <span name="attr_PB"></span></button></div><div class="divider"></div></div></div><div class="col-50 pad-l-md"><input type="hidden" name="attr_traits_exist" class="item-toggle"><div class="item-to-toggle"><fieldset class="repeating_trait"><div class="relative mar-b-sm"><input type="hidden" name="attr_has_uses" class="item-toggle"><div class="col-17 absolute"><input type="hidden" name="attr_has_uses" class="item-toggle"><div class="item-to-toggle gray-bg small-label pad-l-sm"><div class="shaped-row vert-center no-wrap"><div><input type="number" name="attr_uses" class="no-spin no-border gray-bg no-pad" step="1"></div><div>/</div><div><input type="number" name="attr_uses_max" class="no-spin no-border gray-bg no-pad" step="1"></div></div><div class="edit small-label center" data-i18n="USES"></div></div></div><button type="roll" name="roll_trait" class="presentation trait wrapper-button traits-presentation-wrapper" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name}}} {{trait=1}} {{recharge=@{recharge}}} @{saving_throw_toggle} @{damage_toggle} @{second_damage_toggle} {{uses=@{uses}}} {{uses_max=@{uses|max}}} @{heal_toggle} @{hide_gm_info} @{extras_toggle}"><span class="heading"></span> <span name="attr_name" class="bold italic"></span><span name="attr_recharge_display" class="bold italic"></span><span class="bold italic">.</span> <span name="attr_display_text" class="pre-line"></span></button><div class="shaped-row edit"><div class="col-17"></div><div class="col-34 center pad-l-sm"><input type="text" name="attr_name" class="bold italic" data-i18n-placeholder="AMPHIBIOUS"></div><div class="col-17 center pad-l-sm pad-r-sm"><select name="attr_type"><option value="Other" data-i18n="OTHER">Other</option><option value="Melee Weapon" data-i18n="MELEE">Melee</option><option value="Ranged Weapon" data-i18n="RANGED">Ranged</option></select><div class="small-label" data-i18n="TYPE"></div></div><div class="col-26 center pad-l-sm"><input type="text" name="attr_recharge" class="center"><div class="small-label" data-i18n="RECHARGE"></div></div></div><input type="checkbox" name="attr_toggle_details" class="toggle-icon-settings edit" checked="checked"><span class="toggle-icon-settings pictos edit">y</span><div class="details edit"><div class="col-100 center"><textarea class="two-line-textarea" name="attr_display_text"></textarea><div class="small-label" data-i18n="DISPLAY_TEXT"></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_saving_throw_toggle" value="{{saving_throw_condition=@{saving_throw_condition}}} {{saving_throw_dc=@{saving_throw_dc}}} {{saving_throw_vs_ability=@{saving_throw_vs_ability}}} {{saving_throw_failure=@{saving_throw_failure}}} {{saving_throw_success=@{saving_throw_success}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="SAVING_THROW"></span>.</div><div class="attack-toggle col-65"><textarea class="one-line-textarea" name="attr_saving_throw_condition" data-i18n-placeholder="IF_THE_TARGET_IS"></textarea></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_ability"><option value="">&#8212;</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_saving_throw_bonus"></div><div class="attack-toggle center pad-l-sm pad-r-sm">=</div><div class="attack-toggle center pad-l-sm pad-r-sm" data-i18n="DC"></div><div class="attack-toggle col-09 center"><input type="number" name="attr_saving_throw_dc" readonly="readonly"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_vs_ability" accept="Save"><option value="STRENGTH" data-i18n="STR">Str</option><option value="DEXTERITY" data-i18n="DEX">Dex</option><option value="CONSTITUTION" data-i18n="CON">Con</option><option value="INTELLIGENCE" data-i18n="INT">Int</option><option value="WISDOM" data-i18n="WIS">Wis</option><option value="CHARISMA" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-50 pad-r-sm"><textarea class="one-line-textarea" name="attr_saving_throw_failure" data-i18n-placeholder="OR"></textarea></div><div class="attack-toggle col-50 pad-l-sm"><textarea class="one-line-textarea" name="attr_saving_throw_success" data-i18n-placeholder="HALF_DAMAGE" accept="Save Success"></textarea></div></div><input type="hidden" name="attr_damage_formula"> <input type="hidden" name="attr_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_damage_toggle" value="{{damage=[[@{damage_formula}]]}} {{damage_type=@{damage_type}}} {{crit_damage=[[0d0 + @{damage_crit}[crit damage] @{damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_damage" class="center" accept="Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_damage_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_damage_type" class="center" data-i18n-placeholder="FIRE" accept="Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><input type="hidden" name="attr_second_damage_formula"> <input type="hidden" name="attr_second_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_second_damage_toggle" value="{{second_damage=[[@{second_damage_formula}]]}} {{second_damage_type=@{second_damage_type}}} {{second_crit_damage=[[0d0 + @{second_damage_crit}[crit damage] @{second_damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_second_damage" class="center" accept="Secondary Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_second_damage_ability"><option value="" selected="selected">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_second_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_second_damage_type" class="center" data-i18n-placeholder="FIRE" accept="Secondary Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_second_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><input type="hidden" name="attr_heal_formula"><div class="shaped-row vert-center mar-t-sm"><input type="checkbox" name="attr_heal_toggle" value="{{heal=[[@{heal_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="HEAL"></span>.</div><div class="attack-toggle col-12"><input type="text" name="attr_heal" class="center" accept="Healing" placeholder="1d6"></div><div class="attack-toggle pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-16"><select name="attr_heal_ability"><option value="" selected="selected">&#8212;</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center"><input type="number" name="attr_heal_bonus"></div><div class="attack-toggle pad-l-sm pad-r-sm">+</div><div class="attack-toggle center"><input type="checkbox" name="attr_heal_query_toggle" value="?{Heal Bonus Amount|}" class="toggle-query"><span class="toggle-query button" data-i18n="QUERY"></span></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_extras_toggle" value="{{emote=@{emote}}} {{freetext=@{freetext}}} @{freeform}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="EXTRAS"></span>.</div><div class="attack-toggle col-75 center mar-b-sm"><textarea class="one-line-textarea" name="attr_emote"></textarea><div class="small-label" data-i18n="EMOTE"></div></div><div class="attack-toggle col-100 center"><textarea name="attr_freetext" class="two-line-textarea"></textarea><div class="small-label" data-i18n="FREETEXT"></div></div><div class="attack-toggle col-100 center mar-t-sm"><textarea name="attr_freeform" class="one-line-textarea"></textarea><div class="small-label" data-i18n="FREEFORM"></div></div></div></div></div></fieldset></div><input type="hidden" name="attr_actions_exist" class="item-toggle"><div class="item-to-toggle"><h3 data-i18n="ACTIONS"></h3><fieldset class="repeating_action"><div class="relative mar-b-sm"><button type="roll" name="roll_action" class="presentation" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name}}} {{action=1}} {{reach=@{reach}}} {{range=@{range}}} {{recharge=@{recharge}}} @{roll_toggle} @{saving_throw_toggle} @{damage_toggle} @{second_damage_toggle} @{attacher_attack} @{hide_gm_info} @{extras_toggle}"><span class="bold italic"><span name="attr_name"></span><span name="attr_recharge_display"></span>. </span><span name="attr_freetext" class="pre-line"></span></button><div class="shaped-row edit"><div class="col-40 center"><input type="text" name="attr_name" class="bold italic" data-i18n-placeholder="BITE"></div><div class="col-17 center pad-l-sm pad-r-sm"><select name="attr_type"><option value="Other" data-i18n="OTHER">Other</option><option value="Melee Weapon" data-i18n="MELEE">Melee</option><option value="Ranged Weapon" data-i18n="RANGED">Ranged</option></select><div class="small-label" data-i18n="TYPE"></div></div><div class="col-10 center pad-l-sm pad-r-sm"><input type="text" name="attr_reach" class="center"><div class="small-label" data-i18n="REACH"></div></div><div class="col-18 center pad-l-sm pad-r-sm"><input type="text" name="attr_range" class="center"><div class="small-label" data-i18n="RANGE"></div></div><div class="col-15 center pad-l-sm"><input type="text" name="attr_recharge" class="center"><div class="small-label" data-i18n="RECHARGE"></div></div></div><input type="checkbox" name="attr_toggle_details" class="toggle-icon-settings edit" checked="checked"><span class="toggle-icon-settings pictos edit">y</span><div class="details edit"><input type="hidden" name="attr_attack_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_roll_toggle" value="{{vs_ac=1}} @{roll_info} {{roll1=[[@{shaped_d20}cs>@{crit_range} + @{attack_formula}]]}} @{roll_setting}cs>@{crit_range} + @{attack_formula}]]}} {{targetAC=@{attacks_vs_target_ac}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle" checked="checked"><div class="bold italic mar-r-sm"><span data-i18n="ATTACK"></span>.</div><div class="attack-toggle col-08 center pad-r-sm"><input type="checkbox" name="attr_proficiency" checked="checked"><div class="small-label" data-i18n="PROF"></div></div><div class="attack-toggle col-16 center pad-r-sm"><select name="attr_attack_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_attack_bonus" class="center"></div><div class="attack-toggle col-16 center pad-l-sm"><input type="number" name="attr_crit_range" class="center" value="20" step="1" min="1" max="20"><div class="small-label" data-i18n="CRIT_RANGE"></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_saving_throw_toggle" value="{{saving_throw_condition=@{saving_throw_condition}}} {{saving_throw_dc=@{saving_throw_dc}}} {{saving_throw_vs_ability=@{saving_throw_vs_ability}}} {{saving_throw_failure=@{saving_throw_failure}}} {{saving_throw_success=@{saving_throw_success}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="SAVING_THROW"></span>.</div><div class="attack-toggle col-65"><textarea class="one-line-textarea" name="attr_saving_throw_condition" data-i18n-placeholder="IF_THE_TARGET_IS"></textarea></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_ability"><option value="">&#8212;</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_saving_throw_bonus"></div><div class="attack-toggle center pad-l-sm pad-r-sm">=</div><div class="attack-toggle center pad-l-sm pad-r-sm" data-i18n="DC"></div><div class="attack-toggle col-09 center"><input type="number" name="attr_saving_throw_dc" readonly="readonly"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_vs_ability" accept="Save"><option value="STRENGTH" data-i18n="STR">Str</option><option value="DEXTERITY" data-i18n="DEX">Dex</option><option value="CONSTITUTION" data-i18n="CON">Con</option><option value="INTELLIGENCE" data-i18n="INT">Int</option><option value="WISDOM" data-i18n="WIS">Wis</option><option value="CHARISMA" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-50 pad-r-sm"><textarea class="one-line-textarea" name="attr_saving_throw_failure" data-i18n-placeholder="OR"></textarea></div><div class="attack-toggle col-50 pad-l-sm"><textarea class="one-line-textarea" name="attr_saving_throw_success" data-i18n-placeholder="HALF_DAMAGE" accept="Save Success"></textarea></div></div><input type="hidden" name="attr_damage_formula"> <input type="hidden" name="attr_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_damage_toggle" value="{{damage=[[@{damage_formula}]]}} {{damage_type=@{damage_type}}} {{crit_damage=[[0d0 + @{damage_crit}[crit damage] @{damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_damage" class="center" accept="Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_damage_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_damage_type" class="center" data-i18n-placeholder="SLASHING" accept="Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><input type="hidden" name="attr_second_damage_formula"> <input type="hidden" name="attr_second_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_second_damage_toggle" value="{{second_damage=[[@{second_damage_formula}]]}} {{second_damage_type=@{second_damage_type}}} {{second_crit_damage=[[0d0 + @{second_damage_crit}[crit damage] @{second_damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_second_damage" class="center" accept="Secondary Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_second_damage_ability"><option value="" selected="selected">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_second_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_second_damage_type" class="center" data-i18n-placeholder="FIRE" accept="Secondary Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_second_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_extras_toggle" value="{{emote=@{emote}}} {{freetext=@{freetext}}} @{freeform}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="EXTRAS"></span>.</div><div class="attack-toggle col-75 center mar-b-sm"><textarea class="one-line-textarea" name="attr_emote"></textarea><div class="small-label" data-i18n="EMOTE"></div></div><div class="attack-toggle col-100 center"><textarea name="attr_freetext" class="two-line-textarea"></textarea><div class="small-label" data-i18n="FREETEXT"></div></div><div class="attack-toggle col-100 center mar-t-sm"><textarea name="attr_freeform" class="one-line-textarea"></textarea><div class="small-label" data-i18n="FREEFORM"></div></div></div></div></div></fieldset></div><input type="hidden" name="attr_reactions_exist" class="item-toggle"><div class="item-to-toggle"><h3 data-i18n="REACTIONS"></h3><fieldset class="repeating_reaction"><div class="relative mar-b-sm"><button type="roll" name="roll_action" class="presentation" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name}}} {{action=1}} {{reach=@{reach}}} {{range=@{range}}} {{recharge=@{recharge}}} @{roll_toggle} @{saving_throw_toggle} @{damage_toggle} @{second_damage_toggle} @{attacher_attack} @{hide_gm_info} @{extras_toggle}"><span class="bold italic"><span name="attr_name"></span><span name="attr_recharge_display"></span>. </span><span name="attr_freetext" class="pre-line"></span></button><div class="shaped-row edit"><div class="col-40 center"><input type="text" name="attr_name" class="bold italic" data-i18n-placeholder="BITE"></div><div class="col-17 center pad-l-sm pad-r-sm"><select name="attr_type"><option value="Other" data-i18n="OTHER">Other</option><option value="Melee Weapon" data-i18n="MELEE">Melee</option><option value="Ranged Weapon" data-i18n="RANGED">Ranged</option></select><div class="small-label" data-i18n="TYPE"></div></div><div class="col-10 center pad-l-sm pad-r-sm"><input type="text" name="attr_reach" class="center"><div class="small-label" data-i18n="REACH"></div></div><div class="col-18 center pad-l-sm pad-r-sm"><input type="text" name="attr_range" class="center"><div class="small-label" data-i18n="RANGE"></div></div><div class="col-15 center pad-l-sm"><input type="text" name="attr_recharge" class="center"><div class="small-label" data-i18n="RECHARGE"></div></div></div><input type="checkbox" name="attr_toggle_details" class="toggle-icon-settings edit" checked="checked"><span class="toggle-icon-settings pictos edit">y</span><div class="details edit"><input type="hidden" name="attr_attack_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_roll_toggle" value="{{vs_ac=1}} @{roll_info} {{roll1=[[@{shaped_d20}cs>@{crit_range} + @{attack_formula}]]}} @{roll_setting}cs>@{crit_range} + @{attack_formula}]]}} {{targetAC=@{attacks_vs_target_ac}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle" checked="checked"><div class="bold italic mar-r-sm"><span data-i18n="ATTACK"></span>.</div><div class="attack-toggle col-08 center pad-r-sm"><input type="checkbox" name="attr_proficiency" checked="checked"><div class="small-label" data-i18n="PROF"></div></div><div class="attack-toggle col-16 center pad-r-sm"><select name="attr_attack_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_attack_bonus" class="center"></div><div class="attack-toggle col-16 center pad-l-sm"><input type="number" name="attr_crit_range" class="center" value="20" step="1" min="1" max="20"><div class="small-label" data-i18n="CRIT_RANGE"></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_saving_throw_toggle" value="{{saving_throw_condition=@{saving_throw_condition}}} {{saving_throw_dc=@{saving_throw_dc}}} {{saving_throw_vs_ability=@{saving_throw_vs_ability}}} {{saving_throw_failure=@{saving_throw_failure}}} {{saving_throw_success=@{saving_throw_success}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="SAVING_THROW"></span>.</div><div class="attack-toggle col-65"><textarea class="one-line-textarea" name="attr_saving_throw_condition" data-i18n-placeholder="IF_THE_TARGET_IS"></textarea></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_ability"><option value="">&#8212;</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_saving_throw_bonus"></div><div class="attack-toggle center pad-l-sm pad-r-sm">=</div><div class="attack-toggle center pad-l-sm pad-r-sm" data-i18n="DC"></div><div class="attack-toggle col-09 center"><input type="number" name="attr_saving_throw_dc" readonly="readonly"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_vs_ability" accept="Save"><option value="STRENGTH" data-i18n="STR">Str</option><option value="DEXTERITY" data-i18n="DEX">Dex</option><option value="CONSTITUTION" data-i18n="CON">Con</option><option value="INTELLIGENCE" data-i18n="INT">Int</option><option value="WISDOM" data-i18n="WIS">Wis</option><option value="CHARISMA" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-50 pad-r-sm"><textarea class="one-line-textarea" name="attr_saving_throw_failure" data-i18n-placeholder="OR"></textarea></div><div class="attack-toggle col-50 pad-l-sm"><textarea class="one-line-textarea" name="attr_saving_throw_success" data-i18n-placeholder="HALF_DAMAGE" accept="Save Success"></textarea></div></div><input type="hidden" name="attr_damage_formula"> <input type="hidden" name="attr_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_damage_toggle" value="{{damage=[[@{damage_formula}]]}} {{damage_type=@{damage_type}}} {{crit_damage=[[0d0 + @{damage_crit}[crit damage] @{damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_damage" class="center" accept="Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_damage_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_damage_type" class="center" data-i18n-placeholder="SLASHING" accept="Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><input type="hidden" name="attr_second_damage_formula"> <input type="hidden" name="attr_second_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_second_damage_toggle" value="{{second_damage=[[@{second_damage_formula}]]}} {{second_damage_type=@{second_damage_type}}} {{second_crit_damage=[[0d0 + @{second_damage_crit}[crit damage] @{second_damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_second_damage" class="center" accept="Secondary Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_second_damage_ability"><option value="" selected="selected">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_second_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_second_damage_type" class="center" data-i18n-placeholder="FIRE" accept="Secondary Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_second_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_extras_toggle" value="{{emote=@{emote}}} {{freetext=@{freetext}}} @{freeform}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="EXTRAS"></span>.</div><div class="attack-toggle col-75 center mar-b-sm"><textarea class="one-line-textarea" name="attr_emote"></textarea><div class="small-label" data-i18n="EMOTE"></div></div><div class="attack-toggle col-100 center"><textarea name="attr_freetext" class="two-line-textarea"></textarea><div class="small-label" data-i18n="FREETEXT"></div></div><div class="attack-toggle col-100 center mar-t-sm"><textarea name="attr_freeform" class="one-line-textarea"></textarea><div class="small-label" data-i18n="FREEFORM"></div></div></div></div></div></fieldset></div><input type="hidden" name="attr_legendaryactions_exist" class="item-toggle"><div class="item-to-toggle"><h3 data-i18n="LEGENDARY_ACTIONS"></h3><div class="mar-b-md"><span data-i18n="LEGENDARY_ACTIONS_TEXT_1"></span> <span name="attr_character_name"></span> <span data-i18n="LEGENDARY_ACTIONS_TEXT_2"></span> <span name="attr_legendary_action_amount" class="presentation"></span><div class="col-2-em inline-block edit"><input type="number" name="attr_legendary_action_amount" class="no-border no-spin"></div>&nbsp; <span data-i18n="LEGENDARY_ACTIONS_TEXT_3"></span> <span name="attr_character_name"></span> <span data-i18n="LEGENDARY_ACTIONS_TEXT_4"></span></div><fieldset class="repeating_legendaryaction"><div class="relative mar-b-sm"><button type="roll" name="roll_action" class="presentation" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name}}} {{action=1}} {{reach=@{reach}}} {{range=@{range}}} {{recharge=@{recharge}}} @{roll_toggle} @{saving_throw_toggle} @{damage_toggle} @{second_damage_toggle} @{attacher_attack} @{hide_gm_info} @{extras_toggle}"><span class="bold italic"><span name="attr_name"></span><span name="attr_recharge_display"></span>. </span><span name="attr_freetext" class="pre-line"></span></button><div class="shaped-row edit"><div class="col-40 center"><input type="text" name="attr_name" class="bold italic" data-i18n-placeholder="BITE"></div><div class="col-17 center pad-l-sm pad-r-sm"><select name="attr_type"><option value="Other" data-i18n="OTHER">Other</option><option value="Melee Weapon" data-i18n="MELEE">Melee</option><option value="Ranged Weapon" data-i18n="RANGED">Ranged</option></select><div class="small-label" data-i18n="TYPE"></div></div><div class="col-10 center pad-l-sm pad-r-sm"><input type="text" name="attr_reach" class="center"><div class="small-label" data-i18n="REACH"></div></div><div class="col-18 center pad-l-sm pad-r-sm"><input type="text" name="attr_range" class="center"><div class="small-label" data-i18n="RANGE"></div></div><div class="col-15 center pad-l-sm"><input type="text" name="attr_recharge" class="center"><div class="small-label" data-i18n="RECHARGE"></div></div></div><input type="checkbox" name="attr_toggle_details" class="toggle-icon-settings edit" checked="checked"><span class="toggle-icon-settings pictos edit">y</span><div class="details edit"><input type="hidden" name="attr_attack_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_roll_toggle" value="{{vs_ac=1}} @{roll_info} {{roll1=[[@{shaped_d20}cs>@{crit_range} + @{attack_formula}]]}} @{roll_setting}cs>@{crit_range} + @{attack_formula}]]}} {{targetAC=@{attacks_vs_target_ac}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle" checked="checked"><div class="bold italic mar-r-sm"><span data-i18n="ATTACK"></span>.</div><div class="attack-toggle col-08 center pad-r-sm"><input type="checkbox" name="attr_proficiency" checked="checked"><div class="small-label" data-i18n="PROF"></div></div><div class="attack-toggle col-16 center pad-r-sm"><select name="attr_attack_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_attack_bonus" class="center"></div><div class="attack-toggle col-16 center pad-l-sm"><input type="number" name="attr_crit_range" class="center" value="20" step="1" min="1" max="20"><div class="small-label" data-i18n="CRIT_RANGE"></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_saving_throw_toggle" value="{{saving_throw_condition=@{saving_throw_condition}}} {{saving_throw_dc=@{saving_throw_dc}}} {{saving_throw_vs_ability=@{saving_throw_vs_ability}}} {{saving_throw_failure=@{saving_throw_failure}}} {{saving_throw_success=@{saving_throw_success}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="SAVING_THROW"></span>.</div><div class="attack-toggle col-65"><textarea class="one-line-textarea" name="attr_saving_throw_condition" data-i18n-placeholder="IF_THE_TARGET_IS"></textarea></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_ability"><option value="">&#8212;</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_saving_throw_bonus"></div><div class="attack-toggle center pad-l-sm pad-r-sm">=</div><div class="attack-toggle center pad-l-sm pad-r-sm" data-i18n="DC"></div><div class="attack-toggle col-09 center"><input type="number" name="attr_saving_throw_dc" readonly="readonly"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_vs_ability" accept="Save"><option value="STRENGTH" data-i18n="STR">Str</option><option value="DEXTERITY" data-i18n="DEX">Dex</option><option value="CONSTITUTION" data-i18n="CON">Con</option><option value="INTELLIGENCE" data-i18n="INT">Int</option><option value="WISDOM" data-i18n="WIS">Wis</option><option value="CHARISMA" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-50 pad-r-sm"><textarea class="one-line-textarea" name="attr_saving_throw_failure" data-i18n-placeholder="OR"></textarea></div><div class="attack-toggle col-50 pad-l-sm"><textarea class="one-line-textarea" name="attr_saving_throw_success" data-i18n-placeholder="HALF_DAMAGE" accept="Save Success"></textarea></div></div><input type="hidden" name="attr_damage_formula"> <input type="hidden" name="attr_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_damage_toggle" value="{{damage=[[@{damage_formula}]]}} {{damage_type=@{damage_type}}} {{crit_damage=[[0d0 + @{damage_crit}[crit damage] @{damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_damage" class="center" accept="Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_damage_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_damage_type" class="center" data-i18n-placeholder="SLASHING" accept="Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><input type="hidden" name="attr_second_damage_formula"> <input type="hidden" name="attr_second_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_second_damage_toggle" value="{{second_damage=[[@{second_damage_formula}]]}} {{second_damage_type=@{second_damage_type}}} {{second_crit_damage=[[0d0 + @{second_damage_crit}[crit damage] @{second_damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_second_damage" class="center" accept="Secondary Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_second_damage_ability"><option value="" selected="selected">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_second_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_second_damage_type" class="center" data-i18n-placeholder="FIRE" accept="Secondary Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_second_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_extras_toggle" value="{{emote=@{emote}}} {{freetext=@{freetext}}} @{freeform}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="EXTRAS"></span>.</div><div class="attack-toggle col-75 center mar-b-sm"><textarea class="one-line-textarea" name="attr_emote"></textarea><div class="small-label" data-i18n="EMOTE"></div></div><div class="attack-toggle col-100 center"><textarea name="attr_freetext" class="two-line-textarea"></textarea><div class="small-label" data-i18n="FREETEXT"></div></div><div class="attack-toggle col-100 center mar-t-sm"><textarea name="attr_freeform" class="one-line-textarea"></textarea><div class="small-label" data-i18n="FREEFORM"></div></div></div></div></div></fieldset></div><input type="hidden" name="attr_lairactions_exist" class="item-toggle"><div class="item-to-toggle"><h3 data-i18n="LAIR_ACTIONS"></h3><fieldset class="repeating_lairaction"><div class="relative mar-b-sm"><button type="roll" name="roll_action" class="presentation" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{action=1}} {{reach=@{reach}}} {{range=@{range}}} {{recharge=@{recharge}}} @{roll_toggle} @{saving_throw_toggle} @{damage_toggle} @{second_damage_toggle} @{attacher_attack} @{hide_gm_info} @{extras_toggle}"><span name="attr_freetext" class="pre-line"></span></button><div class="shaped-row edit"><div class="col-17 center pad-l-sm pad-r-sm"><select name="attr_type"><option value="Other" data-i18n="OTHER">Other</option><option value="Melee Weapon" data-i18n="MELEE">Melee</option><option value="Ranged Weapon" data-i18n="RANGED">Ranged</option></select><div class="small-label" data-i18n="TYPE"></div></div><div class="col-10 center pad-l-sm pad-r-sm"><input type="text" name="attr_reach" class="center"><div class="small-label" data-i18n="REACH"></div></div><div class="col-18 center pad-l-sm pad-r-sm"><input type="text" name="attr_range" class="center"><div class="small-label" data-i18n="RANGE"></div></div><div class="col-15 center pad-l-sm"><input type="text" name="attr_recharge" class="center"><div class="small-label" data-i18n="RECHARGE"></div></div></div><input type="checkbox" name="attr_toggle_details" class="toggle-icon-settings edit" checked="checked"><span class="toggle-icon-settings pictos edit">y</span><div class="details edit"><input type="hidden" name="attr_attack_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_roll_toggle" value="{{vs_ac=1}} @{roll_info} {{roll1=[[@{shaped_d20}cs>@{crit_range} + @{attack_formula}]]}} @{roll_setting}cs>@{crit_range} + @{attack_formula}]]}} {{targetAC=@{attacks_vs_target_ac}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle" checked="checked"><div class="bold italic mar-r-sm"><span data-i18n="ATTACK"></span>.</div><div class="attack-toggle col-08 center pad-r-sm"><input type="checkbox" name="attr_proficiency" checked="checked"><div class="small-label" data-i18n="PROF"></div></div><div class="attack-toggle col-16 center pad-r-sm"><select name="attr_attack_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_attack_bonus" class="center"></div><div class="attack-toggle col-16 center pad-l-sm"><input type="number" name="attr_crit_range" class="center" value="20" step="1" min="1" max="20"><div class="small-label" data-i18n="CRIT_RANGE"></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_saving_throw_toggle" value="{{saving_throw_condition=@{saving_throw_condition}}} {{saving_throw_dc=@{saving_throw_dc}}} {{saving_throw_vs_ability=@{saving_throw_vs_ability}}} {{saving_throw_failure=@{saving_throw_failure}}} {{saving_throw_success=@{saving_throw_success}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="SAVING_THROW"></span>.</div><div class="attack-toggle col-65"><textarea class="one-line-textarea" name="attr_saving_throw_condition" data-i18n-placeholder="IF_THE_TARGET_IS"></textarea></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_ability"><option value="">&#8212;</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_saving_throw_bonus"></div><div class="attack-toggle center pad-l-sm pad-r-sm">=</div><div class="attack-toggle center pad-l-sm pad-r-sm" data-i18n="DC"></div><div class="attack-toggle col-09 center"><input type="number" name="attr_saving_throw_dc" readonly="readonly"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_vs_ability" accept="Save"><option value="STRENGTH" data-i18n="STR">Str</option><option value="DEXTERITY" data-i18n="DEX">Dex</option><option value="CONSTITUTION" data-i18n="CON">Con</option><option value="INTELLIGENCE" data-i18n="INT">Int</option><option value="WISDOM" data-i18n="WIS">Wis</option><option value="CHARISMA" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-50 pad-r-sm"><textarea class="one-line-textarea" name="attr_saving_throw_failure" data-i18n-placeholder="OR"></textarea></div><div class="attack-toggle col-50 pad-l-sm"><textarea class="one-line-textarea" name="attr_saving_throw_success" data-i18n-placeholder="HALF_DAMAGE" accept="Save Success"></textarea></div></div><input type="hidden" name="attr_damage_formula"> <input type="hidden" name="attr_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_damage_toggle" value="{{damage=[[@{damage_formula}]]}} {{damage_type=@{damage_type}}} {{crit_damage=[[0d0 + @{damage_crit}[crit damage] @{damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_damage" class="center" accept="Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_damage_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_damage_type" class="center" data-i18n-placeholder="SLASHING" accept="Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><input type="hidden" name="attr_second_damage_formula"> <input type="hidden" name="attr_second_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_second_damage_toggle" value="{{second_damage=[[@{second_damage_formula}]]}} {{second_damage_type=@{second_damage_type}}} {{second_crit_damage=[[0d0 + @{second_damage_crit}[crit damage] @{second_damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_second_damage" class="center" accept="Secondary Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_second_damage_ability"><option value="" selected="selected">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_second_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_second_damage_type" class="center" data-i18n-placeholder="FIRE" accept="Secondary Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_second_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_extras_toggle" value="{{emote=@{emote}}} {{freetext=@{freetext}}} @{freeform}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="EXTRAS"></span>.</div><div class="attack-toggle col-75 center mar-b-sm"><textarea class="one-line-textarea" name="attr_emote"></textarea><div class="small-label" data-i18n="EMOTE"></div></div><div class="attack-toggle col-100 center"><textarea name="attr_freetext" class="two-line-textarea"></textarea><div class="small-label" data-i18n="FREETEXT"></div></div><div class="attack-toggle col-100 center mar-t-sm"><textarea name="attr_freeform" class="one-line-textarea"></textarea><div class="small-label" data-i18n="FREEFORM"></div></div></div></div></div></fieldset></div><input type="hidden" name="attr_regionaleffects_exist" class="item-toggle"><div class="item-to-toggle"><h3 data-i18n="REGIONAL_EFFECTS"></h3><fieldset class="repeating_regionaleffect"><div class="relative mar-b-sm"><button type="roll" name="roll_action" class="presentation" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{action=1}} {{reach=@{reach}}} {{range=@{range}}} {{recharge=@{recharge}}} @{roll_toggle} @{saving_throw_toggle} @{damage_toggle} @{second_damage_toggle} @{attacher_attack} @{hide_gm_info} @{extras_toggle}"><span name="attr_freetext" class="pre-line"></span></button><div class="shaped-row edit"><div class="col-17 center pad-l-sm pad-r-sm"><select name="attr_type"><option value="Other" data-i18n="OTHER">Other</option><option value="Melee Weapon" data-i18n="MELEE">Melee</option><option value="Ranged Weapon" data-i18n="RANGED">Ranged</option></select><div class="small-label" data-i18n="TYPE"></div></div><div class="col-10 center pad-l-sm pad-r-sm"><input type="text" name="attr_reach" class="center"><div class="small-label" data-i18n="REACH"></div></div><div class="col-18 center pad-l-sm pad-r-sm"><input type="text" name="attr_range" class="center"><div class="small-label" data-i18n="RANGE"></div></div><div class="col-15 center pad-l-sm"><input type="text" name="attr_recharge" class="center"><div class="small-label" data-i18n="RECHARGE"></div></div></div><input type="checkbox" name="attr_toggle_details" class="toggle-icon-settings edit" checked="checked"><span class="toggle-icon-settings pictos edit">y</span><div class="details edit"><input type="hidden" name="attr_attack_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_roll_toggle" value="{{vs_ac=1}} @{roll_info} {{roll1=[[@{shaped_d20}cs>@{crit_range} + @{attack_formula}]]}} @{roll_setting}cs>@{crit_range} + @{attack_formula}]]}} {{targetAC=@{attacks_vs_target_ac}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle" checked="checked"><div class="bold italic mar-r-sm"><span data-i18n="ATTACK"></span>.</div><div class="attack-toggle col-08 center pad-r-sm"><input type="checkbox" name="attr_proficiency" checked="checked"><div class="small-label" data-i18n="PROF"></div></div><div class="attack-toggle col-16 center pad-r-sm"><select name="attr_attack_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_attack_bonus" class="center"></div><div class="attack-toggle col-16 center pad-l-sm"><input type="number" name="attr_crit_range" class="center" value="20" step="1" min="1" max="20"><div class="small-label" data-i18n="CRIT_RANGE"></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_saving_throw_toggle" value="{{saving_throw_condition=@{saving_throw_condition}}} {{saving_throw_dc=@{saving_throw_dc}}} {{saving_throw_vs_ability=@{saving_throw_vs_ability}}} {{saving_throw_failure=@{saving_throw_failure}}} {{saving_throw_success=@{saving_throw_success}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="SAVING_THROW"></span>.</div><div class="attack-toggle col-65"><textarea class="one-line-textarea" name="attr_saving_throw_condition" data-i18n-placeholder="IF_THE_TARGET_IS"></textarea></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_ability"><option value="">&#8212;</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_saving_throw_bonus"></div><div class="attack-toggle center pad-l-sm pad-r-sm">=</div><div class="attack-toggle center pad-l-sm pad-r-sm" data-i18n="DC"></div><div class="attack-toggle col-09 center"><input type="number" name="attr_saving_throw_dc" readonly="readonly"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_vs_ability" accept="Save"><option value="STRENGTH" data-i18n="STR">Str</option><option value="DEXTERITY" data-i18n="DEX">Dex</option><option value="CONSTITUTION" data-i18n="CON">Con</option><option value="INTELLIGENCE" data-i18n="INT">Int</option><option value="WISDOM" data-i18n="WIS">Wis</option><option value="CHARISMA" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-50 pad-r-sm"><textarea class="one-line-textarea" name="attr_saving_throw_failure" data-i18n-placeholder="OR"></textarea></div><div class="attack-toggle col-50 pad-l-sm"><textarea class="one-line-textarea" name="attr_saving_throw_success" data-i18n-placeholder="HALF_DAMAGE" accept="Save Success"></textarea></div></div><input type="hidden" name="attr_damage_formula"> <input type="hidden" name="attr_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_damage_toggle" value="{{damage=[[@{damage_formula}]]}} {{damage_type=@{damage_type}}} {{crit_damage=[[0d0 + @{damage_crit}[crit damage] @{damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_damage" class="center" accept="Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_damage_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_damage_type" class="center" data-i18n-placeholder="SLASHING" accept="Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><input type="hidden" name="attr_second_damage_formula"> <input type="hidden" name="attr_second_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_second_damage_toggle" value="{{second_damage=[[@{second_damage_formula}]]}} {{second_damage_type=@{second_damage_type}}} {{second_crit_damage=[[0d0 + @{second_damage_crit}[crit damage] @{second_damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_second_damage" class="center" accept="Secondary Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_second_damage_ability"><option value="" selected="selected">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_second_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_second_damage_type" class="center" data-i18n-placeholder="FIRE" accept="Secondary Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_second_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_extras_toggle" value="{{emote=@{emote}}} {{freetext=@{freetext}}} @{freeform}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="EXTRAS"></span>.</div><div class="attack-toggle col-75 center mar-b-sm"><textarea class="one-line-textarea" name="attr_emote"></textarea><div class="small-label" data-i18n="EMOTE"></div></div><div class="attack-toggle col-100 center"><textarea name="attr_freetext" class="two-line-textarea"></textarea><div class="small-label" data-i18n="FREETEXT"></div></div><div class="attack-toggle col-100 center mar-t-sm"><textarea name="attr_freeform" class="one-line-textarea"></textarea><div class="small-label" data-i18n="FREEFORM"></div></div></div></div></div></fieldset></div></div></div><input type="hidden" name="attr_character_name"></div></div><div class="bar"></div></div><div class="section-spells"><input type="hidden" name="attr_higher_level_query_1"> <input type="hidden" name="attr_higher_level_query_2"> <input type="hidden" name="attr_higher_level_query_3"> <input type="hidden" name="attr_higher_level_query_4"> <input type="hidden" name="attr_higher_level_query_5"> <input type="hidden" name="attr_higher_level_query_6"> <input type="hidden" name="attr_higher_level_query_7"> <input type="hidden" name="attr_higher_level_query_8"><div class="shaped-row mar-b-sm"><div class="col-80"><div class="wrap-box"><input type="checkbox" name="attr_spell_display_filters" class="toggle-spell-filters" value="1" checked="checked"><span class="toggle-spell-filters button" data-i18n="FILTERS"></span> <input type="checkbox" name="attr_spell_contents" class="toggle-spells-filter-content presentation"><span class="toggle-spells-filter-content presentation button" data-i18n="CONTENT"></span> <input type="checkbox" name="attr_spell_condensed" class="toggle-spells-filter-condense presentation"><span class="toggle-spells-filter-condense presentation button" data-i18n="CONDENSE"></span> <input type="checkbox" name="attr_spell_only_show_prepared" class="toggle-spells-filter-prepared"><span class="toggle-spells-filter-prepared button" data-i18n="PREPARED"></span> <input type="checkbox" name="attr_spell_only_show_rituals" class="toggle-spells-filter-ritual"><span class="toggle-spells-filter-ritual button" data-i18n="RITUAL"></span> <input type="radio" name="attr_spell_level_filter" class="toggle-spells-filter-level-cantrips" value="0"><span class="toggle-spells-filter-level-cantrips button" data-i18n="CANTRIPS"></span><input type="radio" name="attr_spell_level_filter" class="toggle-spells-filter-level-1 spell-level-1" value="1"><span class="toggle-spells-filter-level-1 spell-level-1 button border-left">1</span><input type="radio" name="attr_spell_level_filter" class="toggle-spells-filter-level-2 spell-level-2" value="2"><span class="toggle-spells-filter-level-2 spell-level-2 button border-left">2</span><input type="radio" name="attr_spell_level_filter" class="toggle-spells-filter-level-3 spell-level-3" value="3"><span class="toggle-spells-filter-level-3 spell-level-3 button border-left">3</span><input type="radio" name="attr_spell_level_filter" class="toggle-spells-filter-level-4 spell-level-4" value="4"><span class="toggle-spells-filter-level-4 spell-level-4 button border-left">4</span><input type="radio" name="attr_spell_level_filter" class="toggle-spells-filter-level-5 spell-level-5" value="5"><span class="toggle-spells-filter-level-5 spell-level-5 button border-left">5</span><input type="radio" name="attr_spell_level_filter" class="toggle-spells-filter-level-6 spell-level-6" value="6"><span class="toggle-spells-filter-level-6 spell-level-6 button border-left">6</span><input type="radio" name="attr_spell_level_filter" class="toggle-spells-filter-level-7 spell-level-7" value="7"><span class="toggle-spells-filter-level-7 spell-level-7 button border-left">7</span><input type="radio" name="attr_spell_level_filter" class="toggle-spells-filter-level-8 spell-level-8" value="8"><span class="toggle-spells-filter-level-8 spell-level-8 button border-left">8</span><input type="radio" name="attr_spell_level_filter" class="toggle-spells-filter-level-9 spell-level-9" value="9"><span class="toggle-spells-filter-level-9 spell-level-9 button border-left">9</span><input type="radio" name="attr_spell_level_filter" class="toggle-spells-filter-level-all" value="all" checked="checked"><span class="toggle-spells-filter-level-all button border-left" data-i18n="ALL"></span> <input type="hidden" name="attr_spell_level_filter" class="toggle-spells-filter-level"> <input type="radio" name="attr_spell_casting_time_only_show" class="toggle-spells-filter-casting-time-reaction" value="reaction"><span class="toggle-spells-filter-casting-time-reaction button" data-i18n="REACTION"></span><input type="radio" name="attr_spell_casting_time_only_show" class="toggle-spells-filter-casting-time-bonus" value="bonus"><span class="toggle-spells-filter-casting-time-bonus button border-left" data-i18n="BONUS"></span><input type="radio" name="attr_spell_casting_time_only_show" class="toggle-spells-filter-casting-time-action" value="action"><span class="toggle-spells-filter-casting-time-action button border-left" data-i18n="ACTION"></span><input type="radio" name="attr_spell_casting_time_only_show" class="toggle-spells-filter-casting-time-all" value="all" checked="checked"><span class="toggle-spells-filter-casting-time-all button border-left" data-i18n="ALL"></span> <input type="checkbox" name="attr_spell_only_show_concentration" class="toggle-spells-filter-concentration" checked="checked"><span class="toggle-spells-filter-concentration button" data-i18n="CONCENTRATION"></span> <input type="checkbox" name="attr_spell_only_show_verbal" class="toggle-spells-filter-verbal" checked="checked"><span class="toggle-spells-filter-verbal button" data-i18n="VERBAL_V"></span> <input type="checkbox" name="attr_spell_only_show_somatic" class="toggle-spells-filter-somatic" checked="checked"><span class="toggle-spells-filter-somatic button" data-i18n="SOMATIC_S"></span> <input type="checkbox" name="attr_spell_only_show_material" class="toggle-spells-filter-material" checked="checked"><span class="toggle-spells-filter-material button" data-i18n="MATERIAL_M"></span><div class="mar-t-sm"></div><fieldset class="repeating_spell"><input type="hidden" name="attr_spell_level" class="toggle-spell-level"> <input type="checkbox" name="attr_is_prepared" class="toggle-spells-prepared hidden"> <input type="hidden" name="attr_ritual" class="toggle-spells-ritual"> <input type="hidden" name="attr_concentration" class="toggle-spells-concentration"> <input type="hidden" name="attr_concentration_text"> <input type="hidden" name="attr_casting_time" class="toggle-casting-time"> <input type="hidden" name="attr_components" class="toggle-components"><div class="spell compendium-drop-target relative"><input type="hidden" name="attr_add_casting_modifier" accept="Add Casting Modifier"> <input type="hidden" name="attr_type" accept="Spell Attack"><div class="presentation"><button type="roll" name="roll_spell" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name}}} {{spell=1}} @{attacher_spell} {{friendly_level=@{friendly_level}}} {{school=@{school}}} {{casting_time=@{casting_time}}} @{ritual_output} {{range=@{range}}} {{components=@{components}}} {{materials=@{materials}}} {{concentration=@{concentration_text}}} {{duration=@{duration}}} {{target=@{target}}} @{content_toggle} @{roll_toggle} @{saving_throw_toggle} @{damage_toggle} @{second_damage_toggle} @{heal_toggle} @{higher_level_toggle} @{hide_gm_info} @{special_effects_toggle} @{extras_toggle}"><div class="no-overflow"><span name="attr_name" class="spell-name"></span></div><div class="no-overflow condense"><span name="attr_friendly_level" class="italic"></span> <span name="attr_school" class="italic"></span> <input type="checkbox" name="attr_ritual_show" value="1" class="show-ritual hidden"> <span class="show-ritual italic lowercase">(<span data-i18n="RITUAL"></span>)</span></div><div class="no-overflow condense"><span class="bold mar-r-sm"><span data-i18n="CASTING_TIME"></span>:</span> <span name="attr_casting_time"></span></div><div class="no-overflow condense"><span class="bold mar-r-sm"><span data-i18n="RANGE"></span>:</span> <span name="attr_range"></span></div><div class="no-overflow condense"><span class="bold mar-r-sm"><span data-i18n="COMPONENTS"></span>:</span> <span name="attr_components"></span> <input type="checkbox" name="attr_materials_show" value="1" class="show-materials hidden"> <span class="show-materials">(<span name="attr_materials" class="small-label"></span>)</span></div><div class="no-overflow condense"><span class="bold mar-r-sm"><span data-i18n="DURATION"></span>:</span> <input type="checkbox" name="attr_concentration_show" value="1" class="show-concentration hidden"> <span class="show-concentration"><span data-i18n="CONCENTRATION"></span>, </span><span name="attr_duration"></span></div><div class="no-overflow condense"><span class="bold mar-r-sm"><span data-i18n="TARGET"></span>:</span> <span name="attr_target"></span></div><div class="condense content"><span name="attr_content"></span></div></button></div><input type="checkbox" name="attr_is_prepared" class="toggle-spells-prepared"><span class="toggle-spells-prepared" data-i18n="PREPARED"></span> <input type="checkbox" name="attr_toggle_details" class="toggle-icon-settings edit" checked="checked"><span class="toggle-icon-settings pictos edit">y</span> <input type="text" name="attr_name" class="spell-name edit" data-i18n-placeholder="NAME" accept="Name"><div class="details edit"><div class="shaped-row vert-center"><div class="col-18"><input type="hidden" name="attr_friendly_level"><select name="attr_spell_level" class="italic no-border" accept="Level"><option value="0" data-i18n="CANTRIP">Cantrip</option><option value="1"><span data-i18n="1st">1st</span>-<span data-i18n="level">level</span></option><option value="2"><span data-i18n="2nd">2nd</span>-<span data-i18n="level">level</span></option><option value="3"><span data-i18n="3rd">3rd</span>-<span data-i18n="level">level</span></option><option value="4"><span data-i18n="4th">4th</span>-<span data-i18n="level">level</span></option><option value="5"><span data-i18n="5th">5th</span>-<span data-i18n="level">level</span></option><option value="6"><span data-i18n="6th">6th</span>-<span data-i18n="level">level</span></option><option value="7"><span data-i18n="7th">7th</span>-<span data-i18n="level">level</span></option><option value="8"><span data-i18n="8th">8th</span>-<span data-i18n="level">level</span></option><option value="9"><span data-i18n="9th">9th</span>-<span data-i18n="level">level</span></option></select></div><div class="col-26 center"><select name="attr_school" class="italic no-border" accept="School"><option value="Abjuration" data-i18n="ABJURATION">Abjuration</option><option value="Conjuration" data-i18n="CONJURATION">Conjuration</option><option value="Divination" data-i18n="DIVINATION">Divination</option><option value="Enchantment" data-i18n="ENCHANTMENT">Enchantment</option><option value="Evocation" data-i18n="EVOCATION">Evocation</option><option value="Illusion" data-i18n="ILLUSION">Illusion</option><option value="Necromancy" data-i18n="NECROMANCY">Necromancy</option><option value="Transmutation" data-i18n="TRANSMUTATION">Transmutation</option></select></div><div class="mar-l-lg"><input type="hidden" name="attr_ritual_output"> <input type="checkbox" name="attr_ritual" class="toggle-spells-ritual" value="Yes" accept="Ritual"><span class="toggle-spells-ritual" data-i18n="RITUAL"></span></div></div><div class="shaped-row vert-center"><span class="bold mar-r-sm"><span data-i18n="CASTING_TIME"></span>:</span><div class="flex-grow center pad-l-sm"><input type="text" name="attr_casting_time" class="no-border" data-i18n-placeholder="1_ACTION" accept="Casting Time"></div></div><div class="shaped-row vert-center"><span class="bold mar-r-sm"><span data-i18n="RANGE"></span>:</span><div class="flex-grow center pad-l-sm"><input type="text" name="attr_range" class="no-border" placeholder="90ft" accept="Range"></div></div><div class="shaped-row vert-center"><span class="bold mar-r-sm"><span data-i18n="COMPONENTS"></span>:</span><div class="col-12 center pad-l-sm"><input type="text" name="attr_components" class="no-border" placeholder="V S M" accept="Components"></div><div class="flex-grow pad-l-sm"><div class="shaped-row no-wrap small-label vert-center"><span>(</span> <input type="text" name="attr_materials" class="no-border small-label" accept="Material"> <span>)</span></div></div></div><div class="shaped-row vert-center"><span class="bold mar-r-sm"><span data-i18n="DURATION"></span>:</span><div class="flex-grow center pad-l-sm"><input type="text" name="attr_duration" class="no-border" data-i18n-placeholder="INSTANTANEOUS" accept="Duration"></div><div class="flex-grow"><input type="checkbox" name="attr_concentration" class="toggle-spells-concentration" value="Yes" accept="Concentration"><span class="toggle-spells-concentration" data-i18n="CONCENTRATION"></span></div></div><div class="shaped-row vert-center"><span class="bold mar-r-sm"><span data-i18n="TARGET"></span>:</span><div class="flex-grow center pad-l-sm"><input type="text" name="attr_target" class="no-border" data-i18n-placeholder="ONE_CREATURE" accept="Target"></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_content_toggle" value="{{content=@{content}}}" class="attack-toggle" checked="checked"><div class="bold italic mar-r-sm"><span data-i18n="CONTENT"></span>.</div><div class="col-80 attack-toggle"><textarea name="attr_content" class="three-line-textarea" accept="Content"></textarea></div></div><input type="hidden" name="attr_attack_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_roll_toggle" value="{{vs_ac=1}} @{roll_info} {{roll1=[[@{shaped_d20}cs>@{crit_range} + @{attack_formula}]]}} @{roll_setting}cs>@{crit_range} + @{attack_formula}]]}} {{targetAC=@{attacks_vs_target_ac}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="ATTACK"></span>.</div><div class="attack-toggle col-08 center pad-r-sm"><input type="checkbox" name="attr_proficiency" checked="checked"><div class="small-label" data-i18n="PROF"></div></div><div class="attack-toggle col-16 center pad-r-sm"><select name="attr_attack_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_attack_bonus" class="center"></div><div class="attack-toggle col-16 center pad-l-sm"><input type="number" name="attr_crit_range" class="center" value="20" step="1" min="1" max="20"><div class="small-label" data-i18n="CRIT_RANGE"></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_saving_throw_toggle" value="{{saving_throw_condition=@{saving_throw_condition}}} {{saving_throw_dc=@{saving_throw_dc}}} {{saving_throw_vs_ability=@{saving_throw_vs_ability}}} {{saving_throw_failure=@{saving_throw_failure}}} {{saving_throw_success=@{saving_throw_success}}} {{targetName=@{attacks_vs_target_name}}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="SAVING_THROW"></span>.</div><div class="attack-toggle col-65"><textarea class="one-line-textarea" name="attr_saving_throw_condition" data-i18n-placeholder="IF_THE_TARGET_IS"></textarea></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_ability"><option value="">&#8212;</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_saving_throw_bonus"></div><div class="attack-toggle center pad-l-sm pad-r-sm">=</div><div class="attack-toggle center pad-l-sm pad-r-sm" data-i18n="DC"></div><div class="attack-toggle col-09 center"><input type="number" name="attr_saving_throw_dc" readonly="readonly"></div><div class="attack-toggle col-16 center"><select name="attr_saving_throw_vs_ability" accept="Save"><option value="STRENGTH" data-i18n="STR">Str</option><option value="DEXTERITY" data-i18n="DEX">Dex</option><option value="CONSTITUTION" data-i18n="CON">Con</option><option value="INTELLIGENCE" data-i18n="INT">Int</option><option value="WISDOM" data-i18n="WIS">Wis</option><option value="CHARISMA" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle col-100"></div><div class="attack-toggle col-50 pad-r-sm"><textarea class="one-line-textarea" name="attr_saving_throw_failure" data-i18n-placeholder="OR"></textarea></div><div class="attack-toggle col-50 pad-l-sm"><textarea class="one-line-textarea" name="attr_saving_throw_success" data-i18n-placeholder="HALF_DAMAGE" accept="Save Success"></textarea></div></div><input type="hidden" name="attr_damage_formula"> <input type="hidden" name="attr_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_damage_toggle" value="{{damage=[[@{damage_formula}]]}} {{damage_type=@{damage_type}}} {{crit_damage=[[0d0 + @{damage_crit}[crit damage] @{damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_damage" class="center" accept="Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_damage_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_damage_type" class="center" data-i18n-placeholder="FIRE" accept="Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><input type="hidden" name="attr_second_damage_formula"> <input type="hidden" name="attr_second_damage_crit_formula"><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_second_damage_toggle" value="{{second_damage=[[@{second_damage_formula}]]}} {{second_damage_type=@{second_damage_type}}} {{second_crit_damage=[[0d0 + @{second_damage_crit}[crit damage] @{second_damage_crit_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="DAMAGE"></span>.</div><div class="attack-toggle col-12 center"><input type="text" name="attr_second_damage" class="center" accept="Secondary Damage" placeholder="1d6"></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-14 center"><select name="attr_second_damage_ability"><option value="" selected="selected">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle center pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-10 center pad-r-sm"><input type="number" name="attr_second_damage_bonus"></div><div class="attack-toggle col-18 center pad-r-sm"><input type="text" name="attr_second_damage_type" class="center" data-i18n-placeholder="FIRE" accept="Secondary Damage Type"></div><div class="attack-toggle col-18 center pad-l-sm"><input type="text" name="attr_second_damage_crit" class="center"><div class="small-label relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_DAMAGE_TOOLTIP"></div></div></div></div></div></div><input type="hidden" name="attr_heal_formula"><div class="shaped-row vert-center mar-t-sm"><input type="checkbox" name="attr_heal_toggle" value="{{heal=[[@{heal_formula}]]}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="HEAL"></span>.</div><div class="attack-toggle col-12"><input type="text" name="attr_heal" class="center" accept="Healing" placeholder="1d6"></div><div class="attack-toggle pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-16"><select name="attr_heal_ability"><option value="" selected="selected">&#8212;</option><option value="strength" data-i18n="STR" selected="selected">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select></div><div class="attack-toggle pad-l-sm pad-r-sm">+</div><div class="attack-toggle col-12 center"><input type="number" name="attr_heal_bonus"></div><div class="attack-toggle pad-l-sm pad-r-sm">+</div><div class="attack-toggle center"><input type="checkbox" name="attr_heal_query_toggle" value="?{Heal Bonus Amount|}" class="toggle-query"><span class="toggle-query button" data-i18n="QUERY"></span></div></div><div class="shaped-row vert-top mar-t-sm"><input type="hidden" name="attr_higher_level_query"> <input type="checkbox" name="attr_higher_level_toggle" value="{{cast_as_level=@{higher_level_query}}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="HIGHER_LEVEL"></span>.</div><div class="attack-toggle col-12 center pad-r-sm"><input type="number" name="attr_higher_level_dice" accept="Higher Spell Slot Dice" placeholder="1"><div class="small-label" data-i18n="DICE"></div></div><div class="attack-toggle col-12 border-right center pad-l-sm pad-r-sm"><select name="attr_higher_level_die" accept="Higher Spell Slot Die"><option value="d0">&#8212;</option><option>d2</option><option>d4</option><option>d6</option><option>d8</option><option>d10</option><option>d12</option><option>d20</option></select><div class="small-label" data-i18n="DIE"></div></div><div class="attack-toggle col-12 center pad-l-sm pad-r-sm"><input type="number" name="attr_second_higher_level_dice" accept="Secondary Higher Spell Slot Dice" placeholder="1"><div class="small-label"><span data-i18n="2nd"></span> <span data-i18n="DICE"></span></div></div><div class="attack-toggle col-12 border-right center pad-l-sm pad-r-sm"><select name="attr_second_higher_level_die" accept="Secondary Higher Spell Slot Die"><option value="d0">&#8212;</option><option>d2</option><option>d4</option><option>d6</option><option>d8</option><option>d10</option><option>d12</option><option>d20</option></select><div class="small-label"><span data-i18n="2nd"></span> <span data-i18n="DIE"></span></div></div><div class="attack-toggle col-12 center pad-l-sm"><input type="text" name="attr_higher_level_heal" class="center" accept="Higher Level Healing"><div class="small-label" data-i18n="DIE"></div></div></div><div class="shaped-row vert-top mar-t-sm"><input type="checkbox" name="attr_extras_toggle" value="{{emote=@{emote}}} {{freetext=@{freetext}}} @{freeform}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="EXTRAS"></span>.</div><div class="attack-toggle col-75 center mar-b-sm"><textarea class="one-line-textarea" name="attr_emote"></textarea><div class="small-label" data-i18n="EMOTE"></div></div><div class="attack-toggle col-100 center"><textarea name="attr_freetext" class="two-line-textarea"></textarea><div class="small-label" data-i18n="FREETEXT"></div></div><div class="attack-toggle col-100 center mar-t-sm"><textarea name="attr_freeform" class="one-line-textarea"></textarea><div class="small-label" data-i18n="FREEFORM"></div></div></div><div class="shaped-row vert-top mar-t-sm relative"><input type="checkbox" name="attr_special_effects_toggle" value="{{fx=@{type}-@{color} @{points_of_origin}}}" class="attack-toggle"><div class="bold italic mar-r-sm"><span data-i18n="SPECIAL_EFFECTS"></span>.</div><div class="attack-toggle col-15 center mar-b-sm"><input type="text" name="attr_type" class="center" placeholder="explode"><div class="small-label" data-i18n="TYPE"></div></div><div class="attack-toggle col-15 center pad-l-sm mar-b-sm"><input type="text" name="attr_color" class="center" data-i18n-placeholder="FIRE"><div class="small-label" data-i18n="COLOR"></div></div><div class="attack-toggle col-30 center pad-l-sm mar-b-sm"><select name="attr_points_of_origin"><option value="sourceToTarget @{target|token_id}"><span data-i18n="SOURCE">Source</span> &rarr; <span data-i18n="TARGET">Target</span></option><option value="target @{target|token_id}" data-i18n="TARGET">target</option><option value="source" data-i18n="SOURCE">source</option><option value="targetToSource @{target|token_id}"><span data-i18n="TARGET">Target</span> &rarr; <span data-i18n="SOURCE">Source</span></option></select><div class="small-label" data-i18n="POINTS_OF_ORIGIN"></div></div><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">A</div><div class="tooltip-content-left small-label" data-i18n="REQUIRES_API"></div></div></div></div></div></div></fieldset><div class="center small-label italic" data-i18n="TURN_OFF_FILTERING"></div><button type="roll" name="roll_shaped_spells" class="wrapper-button" value="@{spells_macro_var}"><div class="wrap-box-title center" data-i18n="SPELLS"></div></button></div></div><div class="col-20 spell-slots-points right pad-l-smd"><div class="spell-slots-points wrap-box center mar-b-smd"><input type="checkbox" name="attr_spell_slots_toggle" class="toggle-spell-slots edit" checked="checked"><span class="toggle-spell-slots edit button" data-i18n="SPELL_SLOTS"></span> <input type="checkbox" name="attr_spell_points_toggle" class="toggle-spell-points edit"><span class="toggle-spell-points edit button" data-i18n="SPELL_POINTS"></span> <input type="checkbox" name="attr_spell_slots_all" class="toggle-spell-slots-all edit"><span class="toggle-spell-slots-all edit button" data-i18n="ALL"></span><div class="spell-slots"><div class="shaped-row spell-level-1 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="1st"></div><div class="col-23"><input type="number" name="attr_spell_slots_l1" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l1_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l1_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l1_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-2 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="2nd"></div><div class="col-23"><input type="number" name="attr_spell_slots_l2" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l2_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l2_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l2_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-3 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="3rd"></div><div class="col-23"><input type="number" name="attr_spell_slots_l3" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l3_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l3_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l3_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-4 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="4th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l4" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l4_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l4_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l4_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-5 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="5th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l5" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l5_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l5_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l5_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-6 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="6th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l6" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l6_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l6_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l6_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-7 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="7th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l7" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l7_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l7_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l7_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-8 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="8th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l8" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l8_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l8_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l8_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-9 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="9th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l9" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l9_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l9_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l9_max" class="pseudo-input center border-bottom"></span></div></div><button type="roll" name="roll_shaped_spells" class="wrapper-button" value="@{spells_macro_var}"><div class="wrap-box-title center" data-i18n="SPELL_SLOTS_TITLE"></div></button></div><div class="spell-points"><div class="shaped-row spell-level-1 center vert-center"><div class="col-20 center" data-i18n="1st"></div><div class="col-20 center pad-l-sm"><span>2</span></div></div><div class="shaped-row spell-level-2 center vert-center"><div class="col-20 center" data-i18n="2nd"></div><div class="col-20 center pad-l-sm"><span>3</span></div></div><div class="shaped-row spell-level-3 center vert-center"><div class="col-20 center" data-i18n="3rd"></div><div class="col-20 center pad-l-sm"><span>5</span></div></div><div class="shaped-row spell-level-4 center vert-center"><div class="col-20 center" data-i18n="4th"></div><div class="col-20 center pad-l-sm"><span>6</span></div></div><div class="shaped-row spell-level-5 center vert-center"><div class="col-20 center" data-i18n="5th"></div><div class="col-20 center pad-l-sm"><span>7</span></div></div><div class="shaped-row spell-level-6 center vert-center"><div class="col-20 center" data-i18n="6th"></div><div class="col-20 center pad-l-sm"><span>9</span></div></div><div class="shaped-row spell-level-7 center vert-center"><div class="col-20 center" data-i18n="7th"></div><div class="col-20 center pad-l-sm"><span>10</span></div></div><div class="shaped-row spell-level-8 center vert-center"><div class="col-20 center" data-i18n="8th"></div><div class="col-20 center pad-l-sm"><span>11</span></div></div><div class="shaped-row spell-level-9 center vert-center"><div class="col-20 center" data-i18n="9th"></div><div class="col-20 center pad-l-sm"><span>13</span></div></div><div class="shaped-row center no-background"><div class="col-35 center pad-r-sm"><input type="number" name="attr_spell_points" value="0"></div><div class="col-05 center">&#47;</div><div class="col-35 center pad-l-sm"><input type="number" name="attr_spell_points_max" value="0" min="0"></div></div><div class="wrap-box-title center"><span class="spell-points" data-i18n="SPELL_POINTS_TITLE"></span></div></div></div><div class="general-bonuses center mar-b-smd"><div class="wrap-box"><div class="wrap-box-label light-label center" data-i18n="SPELLCASTING"></div><div class="shaped-row no-wrap mar-b-sm"><div class="center pad-r-sm"><input type="text" name="attr_global_spell_attack_bonus" class="center" value="0"><div class="small-label" data-i18n="ATTACK"></div></div><div class="center"><input type="text" name="attr_global_spell_damage_bonus" class="center" value="0"><div class="small-label" data-i18n="DAMAGE"></div></div><div class="center pad-l-sm"><input type="text" name="attr_global_spell_dc_bonus" class="center" value="0"><div class="small-label" data-i18n="SAVING_DC"></div></div><div class="center pad-l-sm"><input type="text" name="attr_global_spell_heal_bonus" class="center" value="0"><div class="small-label" data-i18n="HEAL"></div></div></div><div class="wrap-box-title" data-i18n="BONUSES_AND_PENALTIES"></div></div></div><div class="shaped-row center"><div class="col-50 pad-r-sm"><div class="wrap-box relative"><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="DEFAULT_ABILITY_TOOLTIP"></div></div></div><select name="attr_default_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select><div class="wrap-box-title center" data-i18n="DEFAULT_ABILITY"></div></div></div><div class="col-50 npc pad-l-sm"><div class="wrap-box"><input type="number" name="attr_caster_level" min="0" step="1"><div class="wrap-box-title center" data-i18n="SPELLCASTING_LEVEL"></div></div></div></div></div></div></div><div class="section-equipment pc"><div class="shaped-row mar-b-smd"><div class="col-70 pad-r-md"><div class="wrap-box"><div class="shaped-row"><div class="col-03 small-label"></div><div class="col-20 wrap-box-label light-label pad-r-sm" data-i18n="ARMOR"></div><div class="col-17 wrap-box-label light-label center pad-r-sm" data-i18n="TYPE"></div><div class="edit col-05 wrap-box-label light-label center" data-i18n="AC"></div><div class="edit col-02"></div><div class="edit col-07 wrap-box-label light-label center" data-i18n="BONUS"></div><div class="edit col-02"></div><div class="col-06 wrap-box-label light-label center" data-i18n="TOTAL"></div><div class="col-11 wrap-box-label light-label pad-l-md" data-i18n="STRENGTH"></div><div class="col-09 wrap-box-label light-label center pad-l-md" data-i18n="STEALTH"></div><div class="col-10 wrap-box-label light-label center" data-i18n="USES"></div><div class="col-08 wrap-box-label light-label center pad-l-md" data-i18n="WEIGHT"></div></div><fieldset class="repeating_armor"><div class="shaped-row compendium-drop-target vert-center"><input type="hidden" name="attr_modifiers" accept="Modifiers"><div class="col-03 center"><input type="checkbox" name="attr_worn" checked="checked"></div><div class="col-20 pad-r-sm"><input type="text" name="attr_name" accept="Name"></div><div class="col-17 center pad-r-sm"><select name="attr_type" accept="Item Type"><option value="Light Armor" data-i18n="LIGHT_ARMOR">Light Armor</option><option value="Medium Armor" data-i18n="MEDIUM_ARMOR">Medium Armor</option><option value="Heavy Armor" data-i18n="HEAVY_ARMOR">Heavy Armor</option><option value="Armored" data-i18n="OTHER_ARMOR">Other Armor</option><option value="Shield" data-i18n="SHIELD">Shield</option><option value="AC" data-i18n="ARMORED_AND_UNARMORED">Armored and Unarmored</option><option value="Unarmored" data-i18n="UNARMORED">Unarmored</option></select></div><div class="edit col-05 center"><input type="number" name="attr_ac_base" class="no-spin" value="0" step="1" accept="AC"></div><div class="edit col-02 center">+</div><div class="edit col-07 center"><input type="number" name="attr_ac_bonus" class="no-spin" value="0" step="1"></div><div class="edit col-02 center">=</div><div class="col-06 center"><span name="attr_ac_total" class="pseudo-input center border-bottom"></span></div><div class="col-11 pad-l-md"><select name="attr_strength_requirements"><option value="no">&#8212;</option><option value="Str 13"><span data-i18n="STR">Str</span> 13</option><option value="Str 15"><span data-i18n="STR">Str</span> 15</option></select></div><div class="col-09 center pad-l-md"><input type="checkbox" name="attr_stealth" value="Disadvantage" accept="Stealth"></div><div class="col-10"><div class="shaped-row vert-center no-wrap"><div class="pad-r-sm"><input type="number" name="attr_uses" class="no-spin" step="1"></div><div>/</div><div class="pad-l-sm"><input type="number" name="attr_uses_max" class="no-spin" step="1"></div></div></div><div class="col-08 center pad-l-md"><input type="number" name="attr_weight" class="no-spin" step="1" accept="Weight"></div></div></fieldset><div class="shaped-row center pad-t-md pad-b-md"><div class="col-12 center pad-r-md"><span name="attr_ac_armored_calc" class="pseudo-input center border-bottom"></span><div class="small-label" data-i18n="AC_ARMORED"></div></div><div class="col-12 center pad-r-md"><select name="attr_ac_unarmored_ability"><option value="" selected="selected">&#8212;</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select><div class="small-label" data-i18n="AC_UNARMORED_ABILITY"></div></div><div class="col-12 center pad-r-md"><span name="attr_ac_unarmored_calc" class="pseudo-input center border-bottom"></span><div class="small-label" data-i18n="AC_UNARMORED"></div></div><div class="col-15 center bold"><button type="roll" name="roll_shaped_ac" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=AC>AC</span>}} {{text_big=[[@{ac}]]}}"><div class="shield"><span name="attr_AC" class="pseudo-input center big-text bold"></span><div class="wrap-box-title center" data-i18n="ARMOR_CLASS"></div></div></button></div></div><div class="wrap-box-title center" data-i18n="ARMOR"></div></div></div><div class="col-30 pad-r-sm"><div class="shaped-row"><div class="col-50 pad-r-sm"><div class="wrap-box"><div class="shaped-row vert-center"><div class="col-50 small-label" data-i18n="ATTACKS"></div><div class="col-50"><span name="attr_weight_attacks" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row vert-center"><div class="col-50 small-label" data-i18n="AMMO"></div><div class="col-50"><span name="attr_weight_ammo" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row vert-center"><div class="col-50 small-label" data-i18n="ARMOR"></div><div class="col-50"><span name="attr_weight_armor" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row vert-center"><div class="col-50 small-label" data-i18n="EQUIPMENT"></div><div class="col-50"><span name="attr_weight_equipment" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row vert-center"><div class="col-50 small-label" data-i18n="COINAGE"></div><div class="col-50"><span name="attr_weight_coinage" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row vert-center"><div class="col-50 small-label" data-i18n="TOTAL"></div><div class="col-50"><span name="attr_weight_total" class="pseudo-input center border-bottom bold"></span></div></div><div class="wrap-box-title center" data-i18n="WEIGHT"></div></div></div><div class="col-50 pad-l-sm"><div class="wrap-box"><div class="shaped-row edit"><div class="col-75 small-label" data-i18n="MULTIPLIER"></div><div class="col-25"><input type="number" name="attr_weight_multiplier" class="no-spin" value="1" step=".05"></div></div><div class="shaped-row"><div class="col-75 small-label" data-i18n="CARRYING_CAPACITY"></div><div class="col-25"><span name="attr_carrying_capacity" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row"><div class="col-75 small-label" data-i18n="CARRYING_PUSH_DRAG_LIFT"></div><div class="col-25"><span name="attr_max_push_drag_lift" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row"><div class="col-75 small-label" data-i18n="ENCUMBERED"></div><div class="col-25"><span name="attr_encumbered" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row"><div class="col-75 small-label" data-i18n="ENCUMBERED_HEAVILY"></div><div class="col-25"><span name="attr_heavily_encumbered" class="pseudo-input center border-bottom"></span></div></div><div class="wrap-box-title center" data-i18n="CARRYING_CAPACITY"></div></div></div></div></div></div><div class="wrap-box"><div class="shaped-row"><div class="col-10"><div class="coin shaped-row no-wrap vert-center mar-t-md"><div class="wrap-box col-38"><button type="roll" name="roll_shaped_coinage_cp" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=COPPER_PIECES>Copper pieces</span>}} {{text_big=[[@{cp}]]}}" tabindex="-1"><div class="light-label pad-r-sm" data-i18n="COINS_CP"></div></button></div><div class="shaped-row wrap-box coin-value-wrap"><input type="number" name="attr_cp" class="no-spin no-border" value="0" min="0" step="1"></div></div><div class="coin shaped-row no-wrap vert-center mar-t-md"><div class="wrap-box col-38"><button type="roll" name="roll_shaped_coinage_sp" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=silver_PIECES>Silver pieces</span>}} {{text_big=[[@{sp}]]}}" tabindex="-1"><div class="light-label pad-r-sm" data-i18n="COINS_SP"></div></button></div><div class="shaped-row wrap-box coin-value-wrap"><input type="number" name="attr_sp" class="no-spin no-border" value="0" min="0" step="1"></div></div><div class="coin shaped-row no-wrap vert-center mar-t-md"><div class="wrap-box col-38"><button type="roll" name="roll_shaped_coinage_ep" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=ELECTRUM_PIECES>Electrum pieces</span>}} {{text_big=[[@{ep}]]}}" tabindex="-1"><div class="light-label pad-r-sm" data-i18n="COINS_EP"></div></button></div><div class="shaped-row wrap-box coin-value-wrap"><input type="number" name="attr_ep" class="no-spin no-border" value="0" min="0" step="1"></div></div><div class="coin shaped-row no-wrap vert-center mar-t-md"><div class="wrap-box col-38"><button type="roll" name="roll_shaped_coinage_gp" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=GOLD_PIECES>Gold pieces</span>}} {{text_big=[[@{gp}]]}}" tabindex="-1"><div class="light-label pad-r-sm" data-i18n="COINS_GP"></div></button></div><div class="shaped-row wrap-box coin-value-wrap"><input type="number" name="attr_gp" class="no-spin no-border" value="0" min="0" step="1"></div></div><div class="coin shaped-row no-wrap vert-center mar-t-md"><div class="wrap-box col-38"><button type="roll" name="roll_shaped_coinage_pp" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=PLATINUM_PIECES>Platinum pieces</span>}} {{text_big=[[@{pp}]]}}" tabindex="-1"><div class="light-label pad-r-sm" data-i18n="COINS_PP"></div></button></div><div class="shaped-row wrap-box coin-value-wrap"><input type="number" name="attr_pp" class="no-spin no-border" value="0" min="0" step="1"></div></div><div class="coin shaped-row no-wrap vert-center mar-t-md"><div class="wrap-box col-38"><button type="roll" name="roll_shaped_coinage_total_gp" class="wrapper-button" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=TOTAL_GOLD_VALUE>Total gold value</span>}} {{text_big=[[@{total_gp}]]}}" tabindex="-1"><div class="light-label bold pad-r-sm" data-i18n="COINS_GP"></div></button></div><div class="shaped-row wrap-box coin-value-wrap"><input type="number" name="attr_total_gp" class="bold no-border" value="0" readonly="readonly"></div></div></div><div class="col-90 pad-l-md"><div class="shaped-row"><div class="col-02"></div><div class="col-20 wrap-box-label light-label pad-r-sm" data-i18n="EQUIPMENT"></div><div class="col-45 wrap-box-label light-label pad-r-sm" data-i18n="CONTENT"></div><div class="col-10 wrap-box-label light-label center" data-i18n="USES"></div><div class="col-07 wrap-box-label light-label center pad-l-md" data-i18n="QTY"></div><div class="col-01"></div><div class="col-07 wrap-box-label light-label center" data-i18n="WEIGHT"></div><div class="col-01"></div><div class="col-07 wrap-box-label light-label center" data-i18n="TOTAL"></div></div><fieldset class="repeating_equipment"><div class="shaped-row compendium-drop-target vert-center"><div class="col-02 center"><input type="checkbox" name="attr_carried" checked="checked"></div><div class="col-20 pad-r-sm"><input type="text" name="attr_name" accept="Name"></div><div class="col-45 pad-r-sm"><textarea name="attr_content" class="one-line-textarea" accept="Content"></textarea></div><div class="col-10"><div class="shaped-row vert-center no-wrap"><div class="pad-r-sm"><input type="number" name="attr_uses" class="no-spin" step="1"></div><div>/</div><div class="pad-l-sm"><input type="number" name="attr_uses_max" class="no-spin" step="1"></div></div></div><div class="col-07 center pad-l-md"><input type="number" name="attr_qty" value="1" min="0" step="1"></div><div class="col-01 center">&times;</div><div class="col-07 center"><input type="number" name="attr_weight" value="0" step="0.01" accept="Weight"></div><div class="col-01 center">=</div><div class="col-07 center"><span name="attr_weight_total" class="pseudo-input center border-bottom"></span></div></div></fieldset><hr><div class="shaped-row vert-center mar-t-md"><div class="col-02"></div><div class="col-20 wrap-box-label light-label pad-r-sm" data-i18n="ATTACK"></div><div class="col-45 wrap-box-label light-label pad-r-sm" data-i18n="FREETEXT"></div><div class="col-10 wrap-box-label light-label center" data-i18n="USES"></div><div class="col-07 wrap-box-label light-label center pad-l-md" data-i18n="QTY"></div><div class="col-01"></div><div class="col-07 wrap-box-label light-label center" data-i18n="WEIGHT"></div><div class="col-01"></div><div class="col-07 wrap-box-label light-label center" data-i18n="TOTAL"></div></div><fieldset class="repeating_attack"><div class="shaped-row compendium-drop-target vert-center"><input type="hidden" name="attr_type" accept="Item Type"> <input type="hidden" name="attr_modifiers" accept="Modifiers"> <input type="hidden" name="attr_properties" accept="Properties"> <input type="hidden" name="attr_damage_type" accept="Damage Type"> <input type="hidden" name="attr_damage" accept="Damage"> <input type="hidden" name="attr_second_damage" accept="Secondary Damage"> <input type="hidden" name="attr_range" accept="Range"><div class="col-02 center"><input type="checkbox" name="attr_carried" checked="checked"></div><div class="col-20 pad-r-sm"><input type="text" name="attr_name" accept="Name"></div><div class="col-45 pad-r-sm"><textarea name="attr_freetext" class="one-line-textarea" accept="Content"></textarea></div><div class="col-10"><div class="shaped-row vert-center no-wrap"><div class="pad-r-sm"><input type="number" name="attr_uses" class="no-spin" step="1"></div><div>/</div><div class="pad-l-sm"><input type="number" name="attr_uses_max" class="no-spin" step="1"></div></div></div><div class="col-07 center pad-l-md"><input type="number" name="attr_qty" value="1" min="0" step="1"></div><div class="col-01 center">&times;</div><div class="col-07 center"><input type="number" name="attr_weight" value="0" step=".25" accept="Weight"></div><div class="col-01 center">=</div><div class="col-07 center"><span name="attr_weight_total" class="pseudo-input center border-bottom"></span></div></div></fieldset><div class="ammo mar-t-md"><div class="edit wrap-box-label light-label mar-b-sm" data-i18n="AMMO"></div><fieldset class="repeating_ammo"><div class="shaped-row compendium-drop-target no-wrap"><div><input type="number" name="attr_qty" min="0" step="1"><div class="small-label edit center" data-i18n="QTY"></div></div><div class="edit pad-l-sm"><input type="number" name="attr_weight" class="no-spin" value=".05" step=".005" accept="Weight"><div class="small-label center" data-i18n="WEIGHT"></div></div></div><div class="small-label center"><button type="roll" name="roll_ammo" class="presentation" value="@{output_option} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=@{name}}} {{subheader=<span data-i18n=AMMO>Ammo</span>}} {{text_top=@{qty}}}" tabindex="-1"><span name="attr_name" class="pseudo-input"></span></button> <input type="text" name="attr_name" class="edit center small-label no-border" data-i18n-placeholder="ARROWS" accept="Name"></div></fieldset></div></div></div><div class="wrap-box-title center" data-i18n="EQUIPMENT"></div></div></div><div class="section-character pc"><div class="shaped-row mar-b-smd"><input type="hidden" attr="attr_caster_level"><div class="col-70 pad-r-sm"><div class="wrap-box mar-b-smd"><input type="hidden" name="attr_level"><div class="shaped-row vert-center"><div class="col-12 wrap-box-label light-label center pad-r-sm" data-i18n="CLASS"></div><div class="col-10 wrap-box-label light-label center pad-l-sm pad-r-sm" data-i18n="LEVEL"></div><div class="col-10 wrap-box-label light-label center pad-l-sm pad-r-sm" data-i18n="HIT_DICE"></div><div class="col-40 wrap-box-label light-label center pad-l-sm" data-i18n="SPELLCASTING"></div><div class="col-20 wrap-box-label light-label center pad-l-sm pad-r-sm" data-i18n="CUSTOM_NAME"></div></div><fieldset class="repeating_class"><div class="shaped-row vert-center"><div class="col-12 pad-r-sm"><select name="attr_name"><option value="barbarian" data-i18n="BARBARIAN"></option><option value="bard" data-i18n="BARD"></option><option value="cleric" data-i18n="CLERIC"></option><option value="druid" data-i18n="DRUID"></option><option value="fighter" data-i18n="FIGHTER"></option><option value="monk" data-i18n="MONK"></option><option value="paladin" data-i18n="PALADIN"></option><option value="ranger" data-i18n="RANGER"></option><option value="rogue" data-i18n="ROGUE"></option><option value="sorcerer" data-i18n="SORCERER"></option><option value="warlock" data-i18n="WARLOCK"></option><option value="wizard" data-i18n="WIZARD"></option><option value="custom" data-i18n="CUSTOM"></option></select></div><div class="col-10 pad-l-sm pad-r-sm"><input type="number" name="attr_level"></div><div class="col-10 pad-l-sm pad-r-sm"><select name="attr_hd"><option value="d0">&#8212;</option><option>d2</option><option>d4</option><option>d6</option><option>d8</option><option>d10</option><option selected="selected">d12</option><option>d20</option></select></div><div class="col-40 pad-l-sm"><select name="attr_spellcasting"><option value="none">&#8212;</option><option value="full" data-i18n="CASTERS_FULL"></option><option value="half" data-i18n="CASTERS_HALF"></option><option value="third" data-i18n="CASTERS_THIRD"></option><option value="warlock" data-i18n="WARLOCK"></option></select></div><div class="col-20 pad-l-sm pad-r-sm"><input type="checkbox" name="attr_custom_class_toggle" class="toggle-custom-class hidden"> <input type="text" name="attr_custom_name" class="custom-class"></div></div></fieldset><div class="wrap-box-title center" data-i18n="CLASS_LEVELS"></div></div><div class="col-12 float-right mar-b-smd mar-r-sm"><div class="wrap-box relative"><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="DEFAULT_ABILITY_TOOLTIP"></div></div></div><select name="attr_default_ability"><option value="">&#8212;</option><option value="finesse" data-i18n="FINESSE">Finesse</option><option value="strength" data-i18n="STR">Str</option><option value="dexterity" data-i18n="DEX">Dex</option><option value="constitution" data-i18n="CON">Con</option><option value="intelligence" data-i18n="INT">Int</option><option value="wisdom" data-i18n="WIS">Wis</option><option value="charisma" data-i18n="CHA">Cha</option></select><div class="wrap-box-title center" data-i18n="DEFAULT_ABILITY"></div></div></div></div><div class="col-30 pad-l-sm"><div class="spell-slots-points wrap-box center mar-b-smd"><input type="checkbox" name="attr_spell_slots_toggle" class="toggle-spell-slots edit" checked="checked"><span class="toggle-spell-slots edit button" data-i18n="SPELL_SLOTS"></span> <input type="checkbox" name="attr_spell_points_toggle" class="toggle-spell-points edit"><span class="toggle-spell-points edit button" data-i18n="SPELL_POINTS"></span> <input type="checkbox" name="attr_spell_slots_all" class="toggle-spell-slots-all edit"><span class="toggle-spell-slots-all edit button" data-i18n="ALL"></span><div class="spell-slots"><div class="shaped-row spell-level-1 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="1st"></div><div class="col-23"><input type="number" name="attr_spell_slots_l1" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l1_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l1_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l1_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-2 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="2nd"></div><div class="col-23"><input type="number" name="attr_spell_slots_l2" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l2_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l2_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l2_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-3 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="3rd"></div><div class="col-23"><input type="number" name="attr_spell_slots_l3" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l3_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l3_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l3_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-4 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="4th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l4" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l4_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l4_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l4_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-5 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="5th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l5" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l5_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l5_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l5_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-6 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="6th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l6" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l6_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l6_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l6_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-7 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="7th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l7" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l7_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l7_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l7_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-8 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="8th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l8" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l8_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l8_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l8_max" class="pseudo-input center border-bottom"></span></div></div><div class="shaped-row spell-level-9 center vert-center"><div class="col-17 center pad-r-sm" data-i18n="9th"></div><div class="col-23"><input type="number" name="attr_spell_slots_l9" value="0"></div><div class="pad-l-sm pad-r-sm">&#47;</div><div class="pc edit col-13"><span name="attr_spell_slots_l9_calc" class="pseudo-input center border-bottom"></span></div><div class="pc edit">+</div><div class="edit col-13"><input type="number" name="attr_spell_slots_l9_bonus" class="no-spin" value="0" min="0"></div><div class="pc edit">=</div><div class="col-16"><span name="attr_spell_slots_l9_max" class="pseudo-input center border-bottom"></span></div></div><button type="roll" name="roll_shaped_spells" class="wrapper-button" value="@{spells_macro_var}"><div class="wrap-box-title center" data-i18n="SPELL_SLOTS_TITLE"></div></button></div><div class="spell-points"><div class="shaped-row spell-level-1 center vert-center"><div class="col-20 center" data-i18n="1st"></div><div class="col-20 center pad-l-sm"><span>2</span></div></div><div class="shaped-row spell-level-2 center vert-center"><div class="col-20 center" data-i18n="2nd"></div><div class="col-20 center pad-l-sm"><span>3</span></div></div><div class="shaped-row spell-level-3 center vert-center"><div class="col-20 center" data-i18n="3rd"></div><div class="col-20 center pad-l-sm"><span>5</span></div></div><div class="shaped-row spell-level-4 center vert-center"><div class="col-20 center" data-i18n="4th"></div><div class="col-20 center pad-l-sm"><span>6</span></div></div><div class="shaped-row spell-level-5 center vert-center"><div class="col-20 center" data-i18n="5th"></div><div class="col-20 center pad-l-sm"><span>7</span></div></div><div class="shaped-row spell-level-6 center vert-center"><div class="col-20 center" data-i18n="6th"></div><div class="col-20 center pad-l-sm"><span>9</span></div></div><div class="shaped-row spell-level-7 center vert-center"><div class="col-20 center" data-i18n="7th"></div><div class="col-20 center pad-l-sm"><span>10</span></div></div><div class="shaped-row spell-level-8 center vert-center"><div class="col-20 center" data-i18n="8th"></div><div class="col-20 center pad-l-sm"><span>11</span></div></div><div class="shaped-row spell-level-9 center vert-center"><div class="col-20 center" data-i18n="9th"></div><div class="col-20 center pad-l-sm"><span>13</span></div></div><div class="shaped-row center no-background"><div class="col-35 center pad-r-sm"><input type="number" name="attr_spell_points" value="0"></div><div class="col-05 center">&#47;</div><div class="col-35 center pad-l-sm"><input type="number" name="attr_spell_points_max" value="0" min="0"></div></div><div class="wrap-box-title center"><span class="spell-points" data-i18n="SPELL_POINTS_TITLE"></span></div></div></div></div></div><div class="wrap-box appearance pc mar-b-smd"><div class="shaped-row mar-b-md"><div class="col-1-8 pad-r-sm"><input type="text" name="attr_gender" class="center"><div class="small-label center" data-i18n="GENDER"></div></div><div class="col-1-8 pad-l-sm pad-r-sm"><input type="text" name="attr_size" class="center"><div class="small-label center" data-i18n="SIZE"></div></div><div class="col-1-8 pad-l-sm pad-r-sm"><input type="number" name="attr_age" class="center"><div class="small-label center" data-i18n="AGE"></div></div><div class="col-1-8 pad-l-sm pad-r-sm"><input type="text" name="attr_height" class="center"><div class="small-label center" data-i18n="HEIGHT"></div></div><div class="col-1-8 pad-l-sm pad-r-sm"><input type="text" name="attr_weight" class="center"><div class="small-label center" data-i18n="WEIGHT"></div></div><div class="col-1-8 pad-l-sm pad-r-sm"><input type="text" name="attr_eyes" class="center"><div class="small-label center" data-i18n="EYES"></div></div><div class="col-1-8 pad-l-sm pad-r-sm"><input type="text" name="attr_skin" class="center"><div class="small-label center" data-i18n="SKIN"></div></div><div class="col-1-8 pad-l-sm"><input type="text" name="attr_hair" class="center"><div class="small-label center" data-i18n="HAIR"></div></div></div><div class="wrap-box-title center" data-i18n="APPEARANCE"></div></div><div class="shaped-row mar-b-smd"><div class="col-50 pad-r-sm"><div class="wrap-box vision"><div class="shaped-row"><div class="col-25 sense relative pad-r-sm"><label class="checkbox-label-sm absolute"><input type="checkbox" name="attr_blindsight_blind_beyond"><span data-i18n="BLIND_BEYOND"></span></label><input type="text" name="attr_blindsight" class="center mar-t-md"><div class="small-label center" data-i18n="BLINDSIGHT"></div></div><div class="col-25 sense mar-t-md pad-l-sm pad-r-sm"><input type="text" name="attr_darkvision" class="center"><div class="small-label center" data-i18n="DARKVISION"></div></div><div class="col-25 sense mar-t-md pad-l-sm pad-r-sm"><input type="text" name="attr_tremorsense" class="center"><div class="small-label center" data-i18n="TREMORSENSE"></div></div><div class="col-25 sense mar-t-md pad-l-sm"><input type="text" name="attr_truesight" class="center"><div class="small-label center" data-i18n="TRUESIGHT"></div></div></div><div class="wrap-box-title center" data-i18n="VISION"></div></div></div><div class="col-50 pad-l-sm"><div class="wrap-box movement"><div class="shaped-row"><div class="col-25 speed mar-t-md pad-r-sm"><input type="text" name="attr_speed_burrow" class="center"><div class="small-label center" data-i18n="BURROW"></div></div><div class="col-25 speed mar-t-md pad-l-sm pad-r-sm"><input type="text" name="attr_speed_climb" class="center"><div class="small-label center" data-i18n="CLIMB"></div></div><div class="col-25 speed relative pad-l-sm pad-r-sm"><label class="checkbox-label-sm absolute"><input type="checkbox" name="attr_speed_fly_hover"><span data-i18n="HOVER"></span></label><input type="text" name="attr_speed_fly" class="center mar-t-md"><div class="small-label center" data-i18n="FLY"></div></div><div class="col-25 speed mar-t-md pad-l-sm"><input type="text" name="attr_speed_swim" class="center"><div class="small-label center" data-i18n="SWIM"></div></div></div><div class="wrap-box-title center" data-i18n="MOVEMENT"></div></div></div></div><div class="wrap-box center mar-b-smd"><div class="shaped-row"><div class="col-80"><input type="hidden" name="attr_jack_of_all_trades"> <input type="checkbox" name="attr_jack_of_all_trades_toggle" value="@{jack_of_all_trades}" class="toggle-jack-of-all-trades"><span class="toggle-jack-of-all-trades button" data-i18n="JACK_OF_ALL_TRADES"></span> <input type="hidden" name="attr_remarkable_athlete"> <input type="checkbox" name="attr_remarkable_athlete_toggle" value="@{remarkable_athlete}" class="toggle-remarkable-athlete"><span class="toggle-remarkable-athlete button" data-i18n="REMARKABLE_ATHLETE"></span> <input type="checkbox" name="attr_halfling_luck" class="toggle-halfling-luck"><span class="toggle-halfling-luck button" data-i18n="HALFLING_LUCK"></span></div></div><div class="col-20 has-sorcerer-levels"><div class="wrap-box-label light-label" data-i18n="SORCERER"></div><div><input type="checkbox" name="attr_careful_spell_toggle" value="1"><span data-i18n="CLASS_FEATURE_METAMAGIC_CAREFUL_SPELL"></span></div><div><input type="checkbox" name="attr_distant_spell_toggle" value="1"><span data-i18n="CLASS_FEATURE_METAMAGIC_DISTANT_SPELL"></span></div><div><input type="checkbox" name="attr_empowered_spell_toggle" value="1"><span data-i18n="CLASS_FEATURE_METAMAGIC_EMPOWERED_SPELL"></span></div><div><input type="checkbox" name="attr_extended_spell_toggle" value="1"><span data-i18n="CLASS_FEATURE_METAMAGIC_EXTENDED_SPELL"></span></div><div><input type="checkbox" name="attr_heightened_spell_toggle" value="1"><span data-i18n="CLASS_FEATURE_METAMAGIC_HEIGHTENED_SPELL"></span></div><div><input type="checkbox" name="attr_quickened_spell_toggle" value="1"><span data-i18n="CLASS_FEATURE_METAMAGIC_QUICKENED_SPELL"></span></div><div><input type="checkbox" name="attr_subtle_spell_toggle" value="1"><span data-i18n="CLASS_FEATURE_METAMAGIC_SUBTLE_SPELL"></span></div><div><input type="checkbox" name="attr_twinned_spell_toggle" value="1"><span data-i18n="CLASS_FEATURE_METAMAGIC_TWINNED_SPELL"></span></div></div><div class="wrap-box-title" data-i18n="FEATURES"></div></div><div class="wrap-box center"><textarea name="attr_miscellaneous_notes" class="eight-line-textarea"></textarea><div class="wrap-box-title" data-i18n="MISCELLANEOUS_NOTES"></div></div></div><div class="section-settings"><div class="shaped-row mar-b-smd"><div class="col-22 pad-r-sm"><div class="wrap-box"><div class="shaped-row space-between vert-center mar-b-sm"><div class="small-label" data-i18n="SHEET"></div><div class="col-60"><select name="attr_output_option"><option value="" data-i18n="PUBLIC_FOR_ALL" selected="selected">Public for all to see</option><option value="/w GM" data-i18n="WHISPERED_TO_GM">Whispered to the GM</option></select></div></div><div class="shaped-row space-between vert-center mar-b-sm"><div class="small-label" data-i18n="DEATH_SAVES"></div><div class="col-60"><select name="attr_death_save_output_option"><option value="@{output_option}" data-i18n="SHEET_OUTPUT" selected="selected">Sheet output</option><option value="" data-i18n="PUBLIC_FOR_ALL">Public for all to see</option><option value="/w GM" data-i18n="WHISPERED_TO_GM">Whispered to the GM</option></select></div></div><div class="shaped-row space-between vert-center"><div class="small-label" data-i18n="HIT_DICE"></div><div class="col-60"><select name="attr_hit_dice_output_option"><option value="@{output_option}" data-i18n="SHEET_OUTPUT" selected="selected">Sheet output</option><option value="" data-i18n="PUBLIC_FOR_ALL">Public for all to see</option><option value="/w GM" data-i18n="WHISPERED_TO_GM">Whispered to the GM</option></select></div></div><div class="wrap-box-title center" data-i18n="OUTPUT"></div></div></div><div class="col-22 pad-l-sm pad-r-sm"><div class="wrap-box"><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="OUTPUT"></span><div class="col-60"><select name="attr_initiative_output_option"><option value="@{output_option}" data-i18n="SHEET_OUTPUT" selected="selected">Sheet output</option><option value="" data-i18n="PUBLIC_FOR_ALL">Public for all to see</option><option value="/w GM" data-i18n="WHISPERED_TO_GM">Whispered to the GM</option></select></div></div><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="ROLL_OPTIONS"></span><div class="col-60"><select name="attr_initiative_roll"><option value="@{shaped_d20}" data-i18n="NORMAL">Normal</option><option value="2d20@{d20_mod}kh1" data-i18n="ADVANTAGE">Advantage</option><option value="2d20@{d20_mod}kl1" data-i18n="DISADVANTAGE">Disadvantage</option></select></div></div><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="TRACKER"></span><div class="col-60"><select name="attr_initiative_to_tracker"><option value="@{selected|initiative_formula} &{tracker}" data-i18n="TO_TRACKER" selected="selected">Send to Tracker</option><option value="@{initiative_formula}" data-i18n="DONT">Don't</option></select></div></div><div class="shaped-row space-between vert-center"><span class="small-label" data-i18n="BREAK_TIES"></span> <input type="checkbox" name="attr_initiative_tie_breaker" class="mar-l-md" value="[[@{initiative} / 100]][tie breaker]"></div><div class="wrap-box-title center" data-i18n="INITIATIVE"></div></div></div><div class="col-28 pad-l-sm pad-r-sm"><div class="wrap-box"><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="CHARACTER_NAME_ON_ROLL_TEMPLATES"></span><div class="col-15"><select name="attr_show_character_name"><option value="" data-i18n="NO" selected="selected">No</option><option value="{{show_character_name=1}}" data-i18n="YES">Yes</option></select></div></div><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="SHOW_TARGET_AC_ON_ATTACKS"></span><div class="col-15"><select name="attr_attacks_vs_target_ac"><option value="" data-i18n="NO" selected="selected">No</option><option value="[[@{target|AC}]]" data-i18n="YES">Yes</option></select></div></div><div class="shaped-row space-between vert-center"><span class="small-label" data-i18n="SHOW_TARGET_NAME_ON_ATTACKS"></span><div class="col-15"><select name="attr_attacks_vs_target_name"><option value="" data-i18n="NO" selected="selected">No</option><option value="@{target|token_name}" data-i18n="YES">Yes</option></select></div></div><div class="wrap-box-title center" data-i18n="ROLL_TEMPLATE"></div></div></div><div class="pad-l-sm"><div class="wrap-box relative"><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="AMMO_AUTO_USE"></span> <input type="checkbox" name="attr_ammo_auto_use" class="mar-l-md" value="1"></div><div class="shaped-row space-between vert-center"><span class="small-label" data-i18n="AUTO_REVERT_ADV"></span> <input type="checkbox" name="attr_auto_revert_advantage" class="mar-l-md"></div><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">A</div><div class="tooltip-content-left small-label" data-i18n="REQUIRES_API"></div></div></div><div class="wrap-box-title center" data-i18n="API"></div></div></div><div class="pad-l-sm pad-r-sm"><input type="radio" name="attr_roll_setting" class="toggle-roll-two" value="{{roll2=[[d20@{d20_mod}"><span class="toggle-roll-two button" data-i18n="ROLL_2"></span></div></div><div class="shaped-row mar-b-smd"><div class="col-22 pad-r-sm"><div class="wrap-box"><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="ADD_HALF_PROFICIENCY_TO_UNPROFICIENT_SAVING_THROWS"></span> <input type="checkbox" name="attr_saving_throws_half_proficiency" class="mar-l-md"></div><div class="shaped-row space-between vert-center"><span class="small-label center" data-i18n="MEDIUM_ARMOR_MAX_DEX"></span><div class="col-25"><input type="number" name="attr_medium_armor_max_dex" value="2"></div></div><div class="wrap-box-title center" data-i18n="HOUSERULES"></div></div></div><div class="col-30 pad-l-sm pad-r-sm"><div class="general-bonuses wrap-box relative center"><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="BONUSES_AND_PENALTIES_TOOLTIP"></div></div></div><div class="shaped-row"><div class="col-1-3 wrap-box-label light-label center" data-i18n="ATTACKS"></div><div class="col-1-3 wrap-box-label light-label center" data-i18n="MELEE"></div><div class="col-1-3 wrap-box-label light-label center" data-i18n="RANGED"></div></div><div class="shaped-row no-wrap mar-b-sm"><div class="center"><input type="text" name="attr_global_attack_bonus" class="center" value="0"><div class="small-label" data-i18n="ATTACK"></div></div><div class="center pad-r-sm"><input type="text" name="attr_global_damage_bonus" class="center" value="0"><div class="small-label" data-i18n="DAMAGE"></div></div><div class="center pad-l-sm"><input type="text" name="attr_global_melee_attack_bonus" class="center" value="0"><div class="small-label" data-i18n="ATTACK"></div></div><div class="center pad-r-sm"><input type="text" name="attr_global_melee_damage_bonus" class="center" value="0"><div class="small-label" data-i18n="DAMAGE"></div></div><div class="center pad-l-sm"><input type="text" name="attr_global_ranged_attack_bonus" class="center" value="0"><div class="small-label" data-i18n="ATTACK"></div></div><div class="center"><input type="text" name="attr_global_ranged_damage_bonus" class="center" value="0"><div class="small-label" data-i18n="DAMAGE"></div></div></div><hr><div class="wrap-box-label light-label center" data-i18n="SPELLCASTING"></div><div class="shaped-row no-wrap mar-b-sm"><div class="center pad-r-sm"><input type="text" name="attr_global_spell_attack_bonus" class="center" value="0"><div class="small-label" data-i18n="ATTACK"></div></div><div class="center"><input type="text" name="attr_global_spell_damage_bonus" class="center" value="0"><div class="small-label" data-i18n="DAMAGE"></div></div><div class="center pad-l-sm"><input type="text" name="attr_global_spell_dc_bonus" class="center" value="0"><div class="small-label" data-i18n="SAVING_DC"></div></div><div class="center pad-l-sm"><input type="text" name="attr_global_spell_heal_bonus" class="center" value="0"><div class="small-label" data-i18n="HEAL"></div></div></div><hr><div class="shaped-row no-wrap"><div class="pc center pad-r-sm"><input type="number" name="attr_global_ability_bonus" class="no-spin" value="0" step="1"><div class="small-label" data-i18n="ABILITY_SCORES"></div></div><div class="center pad-r-sm"><input type="text" name="attr_global_saving_throw_bonus" class="center" value="0"><div class="small-label" data-i18n="SAVING_THROWS"></div></div><div class="center"><input type="text" name="attr_global_check_bonus" class="center" value="0"><div class="small-label" data-i18n="ABILITY_CHECKS"></div></div></div><div class="wrap-box-title" data-i18n="BONUSES_AND_PENALTIES"></div></div></div><div class="pad-l-sm pad-r-sm"><div class="wrap-box relative"><input type="hidden" name="attr_hide_gm_info" value="@{hide_attack} @{hide_damage} @{hide_saving_throw_dc} @{hide_spell_content} @{hide_action_freetext} @{hide_saving_throw_failure} @{hide_saving_throw_success} @{hide_recharge}"><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="HIDE_NPC_INFO_ATTACK"></span> <input type="checkbox" name="attr_hide_attack" class="mar-l-md" value="{{hide_attack=1}}"></div><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="HIDE_NPC_INFO_DAMAGE"></span> <input type="checkbox" name="attr_hide_damage" class="mar-l-md" value="{{hide_damage=1}}"></div><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="HIDE_NPC_INFO_SAVING_THROW_DC"></span> <input type="checkbox" name="attr_hide_saving_throw_dc" class="mar-l-md" value="{{hide_saving_throw_dc=1}}"></div><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="HIDE_NPC_INFO_SPELL_CONTENT"></span> <input type="checkbox" name="attr_hide_spell_content" class="mar-l-md" value="{{hide_spell_content=1}}"></div><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="HIDE_NPC_INFO_ACTION_FREETEXT"></span> <input type="checkbox" name="attr_hide_action_freetext" class="mar-l-md" value="{{hide_freetext=1}}"></div><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="HIDE_NPC_INFO_SAVING_THROW_FAILURE"></span> <input type="checkbox" name="attr_hide_saving_throw_failure" class="mar-l-md" value="{{hide_saving_throw_failure=1}}"></div><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="HIDE_NPC_INFO_SAVING_THROW_SUCCESS"></span> <input type="checkbox" name="attr_hide_saving_throw_success" class="mar-l-md" value="{{hide_saving_throw_success=1}}"></div><div class="shaped-row space-between vert-center"><span class="small-label" data-i18n="HIDE_NPC_INFO_RECHARGE"></span> <input type="checkbox" name="attr_hide_recharge" class="mar-l-md" value="{{hide_recharge=1}}"></div><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="HIDE_NPC_INFO_NOTE"></div></div></div><div class="wrap-box-title center" data-i18n="HIDE_NPC_INFO"></div></div></div><div class="col-22 pad-l-sm"><div class="wrap-box"><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="COIN_CONVERSION_GP_PER_CP"></span><div class="col-25"><input type="number" name="attr_copper_per_gold" value="100"></div></div><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="COIN_CONVERSION_GP_PER_SP"></span><div class="col-25"><input type="number" name="attr_silver_per_gold" value="10"></div></div><div class="shaped-row space-between vert-center mar-b-sm"><span class="small-label" data-i18n="COIN_CONVERSION_GP_PER_EP"></span><div class="col-25"><input type="number" name="attr_electrum_per_gold" value="2"></div></div><div class="shaped-row space-between vert-center"><span class="small-label" data-i18n="COIN_CONVERSION_GP_PER_PP"></span><div class="col-25"><input type="number" name="attr_platinum_per_gold" value="10"></div></div><div class="wrap-box-title center" data-i18n="CUSTOM_GOLD_VALUES"></div></div></div></div><div class="wrap-box macros-for-consumption center"><div class="shaped-row"><div class="col-20"><div class="shaped-row center"><div class="col-40"><select name="attr_ability_checks_text_size"><option value="text" data-i18n="NORMAL">Normal</option><option value="text_big" selected="selected" data-i18n="BIG">Big</option></select><div class="small-label" data-i18n="TEXT_SIZE"></div></div></div><div class="mar-t-sm"></div><span data-i18n="SHOW_TOTALS"></span><input type="checkbox" name="attr_ability_checks_show_totals" checked="checked"><div class="mar-t-sm"></div><input type="hidden" name="attr_ability_checks_macro_var"> <button type="roll" name="roll_shaped_ability_checks" class="visible-button" value="/w @{character_name} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=ABILITY_CHECKS>Ability checks</span>}} {{@{ability_checks_text_size}=@{ability_checks_macro_var}}}" data-i18n="ABILITY_CHECKS"></button><div class="mar-t-sm"></div><button type="roll" name="roll_shaped_ability_checks_small" class="hidden" value="/w @{character_name} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=ABILITY_CHECKS>Ability checks</span>}} {{text=@{ability_checks_macro_var}}}" data-i18n="ABILITY_CHECKS"></button> <input type="hidden" name="attr_ability_checks_query_var"> <button type="roll" name="roll_shaped_ability_checks_query" class="hidden" value="@{output_option} &{template:5e-shaped} {{ability=1}} {{character_name=@{character_name}}} @{show_character_name} @{roll_info} @{ability_checks_query_var}" data-i18n="ABILITY_CHECKS_QUERY"></button></div><div class="col-20"><div class="mar-t-sm"></div><div class="shaped-row center"><div class="col-40"><select name="attr_saving_throws_text_size"><option value="text" data-i18n="NORMAL">Normal</option><option value="text_big" selected="selected" data-i18n="BIG">Big</option></select><div class="small-label" data-i18n="TEXT_SIZE"></div></div></div><div class="mar-t-sm"></div><input type="hidden" name="attr_saving_throw_macro_var" value="[Strength](~shaped_strength_saving_throw), [Dexterity](~shaped_dexterity_saving_throw), [Constitution](~shaped_constitution_saving_throw), [Intelligence](~shaped_intelligence_saving_throw), [Wisdom](~shaped_wisdom_saving_throw), [Charisma](~shaped_charisma_saving_throw), [Death](~shaped_death_saving_throw)"> <button type="roll" name="roll_shaped_saving_throw" class="visible-button" value="/w @{character_name} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=SAVING_THROWS>Saving throws</span>}} {{@{saving_throws_text_size}=@{saving_throw_macro_var}}}" data-i18n="SAVING_THROWS"></button><div class="mar-t-sm"></div><button type="roll" name="roll_shaped_saving_throw_small" class="hidden" value="/w @{character_name} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=SAVING_THROWS>Saving throws</span>}} {{text=@{saving_throw_macro_var}}}" data-i18n="SAVING_THROWS"></button> <input type="hidden" name="attr_saving_throw_query_var" value="?{Saving Throw|Strength, {{title=Strength&amp;#125;&amp;#125; {{roll1=[[@{shaped_d20} + @{strength_saving_throw_mod}]]&amp;#125;&amp;#125; @{roll_setting} + @{strength_saving_throw_mod}]]&amp;#125;&amp;#125;|Dexterity, {{title=Dexterity&amp;#125;&amp;#125; {{roll1=[[@{shaped_d20} + @{dexterity_saving_throw_mod}]]&amp;#125;&amp;#125; @{roll_setting} + @{dexterity_saving_throw_mod}]]&amp;#125;&amp;#125;|Constitution, {{title=Constitution&amp;#125;&amp;#125; {{roll1=[[@{shaped_d20} + @{constitution_saving_throw_mod}]]&amp;#125;&amp;#125; @{roll_setting} + @{constitution_saving_throw_mod}]]&amp;#125;&amp;#125;|Intelligence, {{title=Intelligence&amp;#125;&amp;#125; {{roll1=[[@{shaped_d20} + @{intelligence_saving_throw_mod}]]&amp;#125;&amp;#125; @{roll_setting} + @{intelligence_saving_throw_mod}]]&amp;#125;&amp;#125;|Wisdom, {{title=Wisdom&amp;#125;&amp;#125; {{roll1=[[@{shaped_d20} + @{wisdom_saving_throw_mod}]]&amp;#125;&amp;#125; @{roll_setting} + @{wisdom_saving_throw_mod}]]&amp;#125;&amp;#125;|Charisma, {{title=Charisma&amp;#125;&amp;#125; {{roll1=[[@{shaped_d20} + @{charisma_saving_throw_mod}]]&amp;#125;&amp;#125; @{roll_setting} + @{charisma_saving_throw_mod}]]&amp;#125;&amp;#125;}"> <button type="roll" name="roll_shaped_saving_throw_query" class="hidden" value="@{output_option} &{template:5e-shaped} {{saving_throw=1}} {{character_name=@{character_name}}} @{show_character_name} @{roll_info} @{saving_throw_query_var}" data-i18n="SAVING_THROWS_QUERY"></button></div><div class="col-20"><div class="npc"><input type="hidden" name="attr_skills_macro_var"> <input type="hidden" name="attr_languages_chat_var"> <input type="hidden" name="attr_damage_resistances_var"> <input type="hidden" name="attr_traits_chat_var"> <input type="hidden" name="attr_actions_chat_var"> <input type="hidden" name="attr_reactions_chat_var"> <input type="hidden" name="attr_legendaryactions_chat_var"> <input type="hidden" name="attr_lairactions_chat_var"> <input type="hidden" name="attr_regionaleffects_chat_var"> <button type="roll" name="roll_shaped_statblock" class="visible-button" value="/w @{character_name} @{output_option} &{template:5e-shaped} {{title=@{character_name}}} {{subheader=@{size} @{type}, @{alignment}}} {{Armor Class=@{ac} (@{ac_note})}} {{Hit Points=@{HP} (@{hp_formula})}} {{Speed=@{npc_speed}}} {{Abilities=[Str @{strength} (@{strength_mod_with_sign})](~shaped_strength_check), [Dex @{dexterity} (@{dexterity_mod_with_sign})](~shaped_dexterity_check), [Con @{constitution} (@{constitution_mod_with_sign})](~shaped_constitution_check), [Int @{intelligence} (@{intelligence_mod_with_sign})](~shaped_intelligence_check), [Wis @{wisdom} (@{wisdom_mod_with_sign})](~shaped_wisdom_check), [Cha @{charisma} (@{charisma_mod_with_sign})](~shaped_charisma_check)}} {{Saving Throws=[Str @{strength_saving_throw_mod_with_sign}](~shaped_strength_saving_throw), [Dex @{dexterity_saving_throw_mod_with_sign}](~shaped_dexterity_saving_throw), [Con @{constitution_saving_throw_mod_with_sign}](~shaped_constitution_saving_throw), [Int @{intelligence_saving_throw_mod_with_sign}](~shaped_intelligence_saving_throw), [Wis @{wisdom_saving_throw_mod_with_sign}](~shaped_wisdom_saving_throw), [Cha @{charisma_saving_throw_mod_with_sign}](~shaped_charisma_saving_throw)}} {{Skills=@{skills_macro_var}}} @{damage_resistances_var} {{Senses=@{senses}}} @{languages_chat_var} {{Challenge=@{challenge} (@{xp_readable})}} @{traits_chat_var} @{actions_chat_var} @{reactions_chat_var} @{legendaryactions_chat_var} @{lairactions_chat_var} @{regionaleffects_chat_var}" data-i18n="STATBLOCK"></button></div><div class="mar-t-sm"></div><input type="hidden" name="attr_traits_exist" class="item-toggle"><div class="item-to-toggle"><input type="hidden" name="attr_traits_macro_var"> <button type="roll" name="roll_shaped_traits" class="visible-button" value="/w @{character_name} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=TRAITS>Traits</span>}} {{text_big=@{traits_macro_var}}}" data-i18n="TRAITS"></button></div><div class="mar-t-sm"></div><div class="pc"><input type="hidden" name="attr_attacks_macro_var"> <button type="roll" name="roll_shaped_attacks" class="visible-button" value="/w @{character_name} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=ATTACKS>Attacks</span>}} {{text_big=@{attacks_macro_var}}}" data-i18n="ATTACKS"></button></div><input type="hidden" name="attr_actions_exist" class="item-toggle"><div class="npc item-to-toggle"><input type="hidden" name="attr_actions_macro_var"> <button type="roll" name="roll_shaped_actions" class="visible-button" value="/w @{character_name} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=ACTIONS>Actions</span>}} {{text_big=@{actions_macro_var}}}" data-i18n="ACTIONS"></button></div><div class="mar-t-sm npc"></div><input type="hidden" name="attr_reactions_exist" class="item-toggle"><div class="npc item-to-toggle"><input type="hidden" name="attr_reactions_macro_var"> <button type="roll" name="roll_shaped_reactions" class="visible-button" value="/w @{character_name} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=REACTIONS>Reactions</span>}} {{text_big=@{reactions_macro_var}}}" data-i18n="REACTIONS"></button></div><div class="mar-t-sm npc"></div><input type="hidden" name="attr_legendaryactions_exist" class="item-toggle"><div class="npc item-to-toggle"><input type="hidden" name="attr_legendaryactions_macro_var"> <button type="roll" name="roll_shaped_legendaryactions" class="visible-button" value="/w @{character_name} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=LEGENDARY_ACTIONS>Legendary Actions</span>}} {{text_big=@{legendaryactions_macro_var}}}" data-i18n="LEGENDARY_ACTIONS"></button></div><div class="mar-t-sm npc"></div><input type="hidden" name="attr_lairactions_exist" class="item-toggle"><div class="npc item-to-toggle"><input type="hidden" name="attr_lairactions_macro_var"> <button type="roll" name="roll_shaped_lairactions" class="visible-button" value="/w @{character_name} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=LAIR_ACTIONS>Lair Actions</span>}} {{text_big=@{lairactions_macro_var}}}" data-i18n="LAIR_ACTIONS"></button></div><div class="mar-t-sm npc"></div><input type="hidden" name="attr_regionaleffects_exist" class="item-toggle"><div class="npc item-to-toggle"><input type="hidden" name="attr_regionaleffects_macro_var"> <button type="roll" name="roll_shaped_regionaleffects" class="visible-button" value="/w @{character_name} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=REGIONAL_EFFECTS>Regional Effects</span>}} {{text_big=@{regionaleffects_macro_var}}}" data-i18n="REGIONAL_EFFECTS"></button></div></div><div class="col-20"><input type="hidden" name="attr_spells_level_0_macro_var"> <input type="hidden" name="attr_spells_level_1_macro_var"> <input type="hidden" name="attr_spells_level_2_macro_var"> <input type="hidden" name="attr_spells_level_3_macro_var"> <input type="hidden" name="attr_spells_level_4_macro_var"> <input type="hidden" name="attr_spells_level_5_macro_var"> <input type="hidden" name="attr_spells_level_6_macro_var"> <input type="hidden" name="attr_spells_level_7_macro_var"> <input type="hidden" name="attr_spells_level_8_macro_var"> <input type="hidden" name="attr_spells_level_9_macro_var"> <input type="hidden" name="attr_spell_slots_macro_var" value="{{spells_text_size=@{spells_text_size}}} {{spells_level_1_uses=@{spell_slots_l1}/@{spell_slots_l1|max}}} {{spells_level_1_show=@{spells_level_1_show}}} {{spells_level_2_uses=@{spell_slots_l2}/@{spell_slots_l2|max}}} {{spells_level_2_show=@{spells_level_2_show}}}{{spells_level_3_uses=@{spell_slots_l3}/@{spell_slots_l3|max}}} {{spells_level_3_show=@{spells_level_3_show}}} {{spells_level_4_uses=@{spell_slots_l4}/@{spell_slots_l4|max}}} {{spells_level_4_show=@{spells_level_4_show}}} {{spells_level_5_uses=@{spell_slots_l5}/@{spell_slots_l5|max}}} {{spells_level_5_show=@{spells_level_5_show}}} {{spells_level_6_uses=@{spell_slots_l6}/@{spell_slots_l6|max}}} {{spells_level_6_show=@{spells_level_6_show}}} {{spells_level_7_uses=@{spell_slots_l7}/@{spell_slots_l7|max}}} {{spells_level_7_show=@{spells_level_7_show}}} {{spells_level_8_uses=@{spell_slots_l8}/@{spell_slots_l8|max}}} {{spells_level_8_show=@{spells_level_8_show}}} {{spells_level_9_uses=@{spell_slots_l9}/@{spell_slots_l9|max}}} {{spells_level_9_show=@{spells_level_9_show}}}"> <input type="hidden" name="attr_spells_macro_var" value="/w @{character_name} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=SPELLS>Spells</span>}} {{spell_list=1}} {{cantrips=@{spells_level_0_macro_var}}} @{spell_slots_macro_var} {{spells_level_1=@{spells_level_1_macro_var}}} {{spells_level_2=@{spells_level_2_macro_var}}} {{spells_level_3=@{spells_level_3_macro_var}}} {{spells_level_4=@{spells_level_4_macro_var}}} {{spells_level_5=@{spells_level_5_macro_var}}} {{spells_level_6=@{spells_level_6_macro_var}}} {{spells_level_7=@{spells_level_7_macro_var}}} {{spells_level_8=@{spells_level_8_macro_var}}} {{spells_level_9=@{spells_level_9_macro_var}}}"><div class="shaped-row center"><div class="col-40"><select name="attr_spells_text_size"><option value="" data-i18n="NORMAL">Normal</option><option value="big" data-i18n="BIG">Big</option></select><div class="small-label" data-i18n="TEXT_SIZE"></div></div></div><div class="mar-t-sm"></div><span data-i18n="SHOW_UNPREPARED_SPELLS"></span><input type="checkbox" name="attr_spells_show_unprepared" checked="checked"><div class="mar-t-sm"></div><span checked="checked" data-i18n="SHOW_SPELL_LEVEL_IF_ALL_SLOTS_ARE_USED"></span><input type="checkbox" name="attr_spells_show_spell_level_if_all_slots_are_used"><div class="mar-t-sm"></div><button type="roll" name="roll_shaped_spells" class="visible-button" value="@{spells_macro_var}" data-i18n="SPELLS"></button><div class="mar-t-sm"></div><button type="roll" name="roll_shaped_spell_slots" class="visible-button" value="/w @{character_name} &{template:5e-shaped} {{character_name=@{character_name}}} @{show_character_name} {{title=<span data-i18n=SPELLS>Spells</span>}} {{spell_list=1}} @{spell_slots_macro_var}" data-i18n="SPELL_SLOTS"></button></div></div><div class="wrap-box-title" data-i18n="MACROS"></div></div><div class="wrap-box relative mar-t-smd mar-b-smd"><fieldset class="repeating_attacher"><div class="shaped-row"><div class="col-95"><input type="text" class="action-name" data-i18n-placeholder="NAME" name="attr_name"></div><input type="checkbox" name="attr_toggle_details" class="toggle-icon-settings" checked="checked"><span class="toggle-icon-settings pictos">y</span></div><input type="checkbox" name="attr_toggle_details" class="toggle-icon-settings hidden" checked="checked"><div class="shaped-row details mar-b-lg"><div class="col-45 pad-r-sm"><div class="shaped-row"><div class="col-50 center pad-l-sm pad-r-sm"><textarea class="eight-line-textarea" name="attr_freetext"></textarea><div class="small-label" data-i18n="FREETEXT"></div></div><div class="col-50 center pad-l-sm pad-r-sm"><textarea class="eight-line-textarea" name="attr_freeform"></textarea><div class="small-label" data-i18n="FREEFORM"></div></div></div></div><div class="col-55 pad-l-sm"><div class="shaped-row center"><div class="col-20 wrap-box-label light-label" data-i18n="ABILITY_CHECKS"></div><div class="col-20 wrap-box-label light-label" data-i18n="SAVING_THROWS"></div><div class="col-20 wrap-box-label light-label" data-i18n="MISC"></div><div class="col-40 wrap-box-label light-label" data-i18n="SKILLS"></div></div><div class="shaped-row"><div class="col-20 pad-l-lg"><div class="zebra-rows"><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="STRENGTH"></div><div class="col-10"><input type="checkbox" name="attr_strength_check_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="DEXTERITY"></div><div class="col-10"><input type="checkbox" name="attr_dexterity_check_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="CONSTITUTION"></div><div class="col-10"><input type="checkbox" name="attr_constitution_check_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="INTELLIGENCE"></div><div class="col-10"><input type="checkbox" name="attr_intelligence_check_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="WISDOM"></div><div class="col-10"><input type="checkbox" name="attr_wisdom_check_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="CHARISMA"></div><div class="col-10"><input type="checkbox" name="attr_charisma_check_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="INITIATIVE"></div><div class="col-10"><input type="checkbox" name="attr_initiative_attacher"></div></div></div></div><div class="col-20 pad-l-lg"><div class="zebra-rows"><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="STRENGTH"></div><div class="col-10"><input type="checkbox" name="attr_strength_saving_throw_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="DEXTERITY"></div><div class="col-10"><input type="checkbox" name="attr_dexterity_saving_throw_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="CONSTITUTION"></div><div class="col-10"><input type="checkbox" name="attr_constitution_saving_throw_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="INTELLIGENCE"></div><div class="col-10"><input type="checkbox" name="attr_intelligence_saving_throw_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="WISDOM"></div><div class="col-10"><input type="checkbox" name="attr_wisdom_saving_throw_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="CHARISMA"></div><div class="col-10"><input type="checkbox" name="attr_charisma_saving_throw_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="DEATH_SAVES"></div><div class="col-10"><input type="checkbox" name="attr_death_saving_throw_attacher"></div></div></div></div><div class="col-20 pad-l-lg"><div class="zebra-rows"><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="HIT_DICE"></div><div class="col-10"><input type="checkbox" name="attr_hit_dice_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="ATTACK"></div><div class="col-10"><input type="checkbox" name="attr_attack_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="SPELL"></div><div class="col-10"><input type="checkbox" name="attr_spell_attacher"></div></div><div class="shaped-row mar-r-md"><div class="col-90 relative"><span data-i18n="CRIT"></span><div class="tooltip-position-wrapper"><div class="tooltip"><div class="tooltip-toggle-text center">?</div><div class="tooltip-content-left small-label" data-i18n="CRIT_ATTACHER_TOOLTIP"></div></div></div></div><div class="col-10"><input type="checkbox" name="attr_crit_attacher"></div></div></div></div><div class="col-20 pad-l-lg"><div class="zebra-rows"><div class="shaped-row mar-r-md"><div class="col-90" data-i18n="SKILL"></div><div class="col-10"><input type="checkbox" name="attr_skill_attacher"></div></div></div></div></div></div></div></fieldset><div class="wrap-box-title center" data-i18n="ATTACHERS"></div></div><input type="hidden" name="attr_attacher_strength_saving_throw"> <input type="hidden" name="attr_attacher_dexterity_saving_throw"> <input type="hidden" name="attr_attacher_constitution_saving_throw"> <input type="hidden" name="attr_attacher_intelligence_saving_throw"> <input type="hidden" name="attr_attacher_wisdom_saving_throw"> <input type="hidden" name="attr_attacher_charisma_saving_throw"> <input type="hidden" name="attr_attacher_death_saving_throw"> <input type="hidden" name="attr_attacher_strength_check"> <input type="hidden" name="attr_attacher_dexterity_check"> <input type="hidden" name="attr_attacher_constitution_check"> <input type="hidden" name="attr_attacher_intelligence_check"> <input type="hidden" name="attr_attacher_wisdom_check"> <input type="hidden" name="attr_attacher_charisma_check"> <input type="hidden" name="attr_attacher_initiative"> <input type="hidden" name="attr_attacher_hit_dice"> <input type="hidden" name="attr_attacher_attack"> <input type="hidden" name="attr_attacher_spell"> <input type="hidden" name="attr_attacher_skill"> <input type="hidden" name="attr_attacher_crit"></div><hr><div class="center footer"><div><input type="checkbox" name="attr_edit_mode" class="toggle-edit-mode negative-mar-t-eight"><span class="toggle-edit-mode pictos negative-mar-t-eight">p</span></div><div>Documentation: <span class="selectable">https://docs.google.com/document/d/1yPcIZ_bIc3JlnWsKZt2tAB0EQSIVEfeMtT0GifbpJIg</span></div></div><input type="checkbox" name="attr_import_data_present" class="import-data-present hidden"><div class="overlay absolute"><div class="shaped-row fixed pad-l-hundred pad-t-hundred"><div class="pad-r-md"><input type="checkbox" name="attr_reject_import" class="toggle-pseudo-button"><span class="toggle-pseudo-button button" data-i18n="CANCEL"></span></div><div class="pad-l-md"><input type="checkbox" name="attr_accept_import" class="toggle-pseudo-button"><span class="toggle-pseudo-button button" data-i18n="IMPORT"></span></div></div></div></div>
<script type="text/worker">'use strict';var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol?"symbol":typeof obj;};var currentVersion='4.3.1';var SKILLS={ACROBATICS:'dexterity',ANIMALHANDLING:'wisdom',ARCANA:'intelligence',ATHLETICS:'strength',DECEPTION:'charisma',HISTORY:'intelligence',INSIGHT:'wisdom',INTIMIDATION:'charisma',INVESTIGATION:'intelligence',MEDICINE:'wisdom',NATURE:'intelligence',PERCEPTION:'wisdom',PERFORMANCE:'charisma',PERSUASION:'charisma',RELIGION:'intelligence',SLEIGHTOFHAND:'dexterity',STEALTH:'dexterity',SURVIVAL:'wisdom'};var CLASSES=['barbarian','bard','cleric','druid','fighter','monk','paladin','ranger','rogue','sorcerer','warlock','wizard'];var ABILITIES=['strength','dexterity','constitution','intelligence','wisdom','charisma'];var toggleVars={roll:'{{vs_ac=1}} @{roll_info} {{roll1=[[@{shaped_d20}cs>@{crit_range} + @{attack_formula}]]}} @{roll_setting}cs>@{crit_range} + @{attack_formula}]]}} {{targetAC=@{attacks_vs_target_ac}}} {{targetName=@{attacks_vs_target_name}}}',saving_throw:'{{saving_throw_condition=@{saving_throw_condition}}} {{saving_throw_dc=@{saving_throw_dc}}} {{saving_throw_vs_ability=@{saving_throw_vs_ability}}} {{saving_throw_failure=@{saving_throw_failure}}} {{saving_throw_success=@{saving_throw_success}}} {{targetName=@{attacks_vs_target_name}}}',damage:'{{damage=[[@{damage_formula}]]}} {{damage_type=@{damage_type}}} {{crit_damage=[[0d0 + @{damage_crit}[crit damage] @{damage_crit_formula}]]}}',second_damage:'{{second_damage=[[@{second_damage_formula}]]}} {{second_damage_type=@{second_damage_type}}} {{second_crit_damage=[[0d0 + @{second_damage_crit}[crit damage] @{second_damage_crit_formula}]]}}',heal:'{{heal=[[@{heal_formula}]]}}',heal_query:'?{Heal Bonus Amount|}',extras:'{{emote=@{emote}}} {{freetext=@{freetext}}} @{freeform}',higher_level:'{{cast_as_level=@{higher_level_query}}}'};var capitalize=function capitalize(string){return string.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1);});};var firstThree=function firstThree(string){return string.substring(0,3);};var round=function round(value,places){return +(Math.round(value+'e+'+places)+'e-'+places);};var calculatePercentDifference=function calculatePercentDifference(oldValue,newValue){return Math.abs((oldValue-newValue)/oldValue*100);};var isUndefined=function isUndefined(value){if(typeof value==='undefined'||value===''){return true;}return false;};var getIntValue=function getIntValue(value,defaultValue){if(!defaultValue){defaultValue=0;}if(value===0||value==='0'){return 0;}return parseInt(value,10)||defaultValue;};var getFloatValue=function getFloatValue(value,defaultValue){if(!defaultValue){defaultValue=0;}return parseFloat(value)||defaultValue;};var exists=function exists(value){if(isUndefined(value)||value===''||value==='0'||value===0){return false;}return true;};var getAbilityModName=function getAbilityModName(varName){if(!varName){return 'strength_mod';}else if(typeof varName==='string'){varName=varName.replace(/\W/g,'');}return varName;};var getAbilityName=function getAbilityName(varName){if(!varName){return 'strength';}return getAbilityModName(varName).replace('_mod','');};var getAbilityValue=function getAbilityValue(v,varName,defaultAbility){if(typeof varName==='undefined'){if(defaultAbility){return getIntValue(v[defaultAbility+'_mod']);}}else if(exists(varName)){varName=getAbilityModName(varName);return getIntValue(v[varName+'_mod'],0);}return 0;};var getAbilityShortName=function getAbilityShortName(varName,capital){if(!varName){return 'Str';}varName=varName.replace(/\W/g,'');if(capital){varName=capitalize(varName);}return firstThree(varName);};var getRepeatingInfo=function getRepeatingInfo(leadingString,eventInfo){var re=new RegExp(leadingString+'_(-[a-zA-Z0-9-]*)_(.*)');var match=eventInfo.sourceAttribute.match(re);var result=void 0;if(match&&match[1]&&match[2]){result={rowId:match[1],field:match[2]};}return result;};var isEmpty=function isEmpty(obj){for(var prop in obj){if(obj.hasOwnProperty(prop)){return false;}}return true;};var setFinalAttrs=function setFinalAttrs(v,finalSetAttrs,callback){if(!isEmpty(finalSetAttrs)){for(var key in finalSetAttrs){if(finalSetAttrs.hasOwnProperty(key)){if(v[key]===finalSetAttrs[key]){delete finalSetAttrs[key];}}}if(!isEmpty(finalSetAttrs)){console.info('finalSetAttrs',finalSetAttrs);}if(!isEmpty(finalSetAttrs)){if(callback){setAttrs(finalSetAttrs,{},callback);}else {setAttrs(finalSetAttrs);}}}};var fromVOrFinalSetAttrs=function fromVOrFinalSetAttrs(v,finalSetAttrs,value){if(exists(finalSetAttrs[value])){return finalSetAttrs[value];}return v[value];};var parseAttackComponent=function parseAttackComponent(v,repeatingString,finalSetAttrs,options){var parsed=v[repeatingString+'parsed'];if(isUndefined(parsed)){parsed=finalSetAttrs[repeatingString+'parsed'];}if(isUndefined(parsed)||parsed.indexOf(options.parseName)===-1){var aTriggerFieldExists=false;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=options.triggerFields[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var triggerField=_step.value;if(!isUndefined(v[repeatingString+triggerField])){aTriggerFieldExists=true;}}}catch(err){_didIteratorError=true;_iteratorError=err;}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return();}}finally {if(_didIteratorError){throw _iteratorError;}}}if(aTriggerFieldExists&&isUndefined(v[repeatingString+options.toggleField])){finalSetAttrs[repeatingString+options.toggleField]=options.toggleFieldSetTo;if(isUndefined(finalSetAttrs[repeatingString+'parsed'])){finalSetAttrs[repeatingString+'parsed']='';}finalSetAttrs[repeatingString+'parsed']+=' '+options.parseName;}if(options.attackAbility&&isUndefined(v[repeatingString+'attack_ability'])){finalSetAttrs[repeatingString+'attack_ability']=v.default_ability;}if(options.addCastingModifier){if(!isUndefined(v[repeatingString+'damage'])&&isUndefined(v[repeatingString+'damage_ability'])){finalSetAttrs[repeatingString+'damage_ability']=v.default_ability;}if(!isUndefined(v[repeatingString+'heal'])&&isUndefined(v[repeatingString+'heal_ability'])){finalSetAttrs[repeatingString+'heal_ability']=v.default_ability;}}}};var hasUpperCase=function hasUpperCase(string){return (/[A-Z]/.test(string));};var ordinalSpellLevel=function ordinalSpellLevel(level){var spellLevel='';if(level===0){spellLevel='Cantrip';}else {switch(level%10){case 1:spellLevel=level+'st-level';break;case 2:spellLevel=level+'nd-level';break;case 3:spellLevel=level+'rd-level';break;default:spellLevel=level+'th-level';break;}}return spellLevel;};var versionCompare=function versionCompare(v1,v2,options){var lexicographical=options&&options.lexicographical;var zeroExtend=options&&options.zeroExtend;var v1parts=v1.split('.');var v2parts=v2.split('.');var isValidPart=function isValidPart(x){return (lexicographical?/^\d+[A-Za-z]*$/:/^\d+$/).test(x);};if(!v1parts.every(isValidPart)||!v2parts.every(isValidPart)){return NaN;}if(zeroExtend){while(v1parts.length<v2parts.length){v1parts.push('0');}while(v2parts.length<v1parts.length){v2parts.push('0');}}if(!lexicographical){v1parts=v1parts.map(Number);v2parts=v2parts.map(Number);}for(var i=0;i<v1parts.length;++i){if(v2parts.length===i){return 1;}if(v1parts[i]===v2parts[i]){continue;}else if(v1parts[i]>v2parts[i]){return 1;}else {return -1;}}if(v1parts.length!==v2parts.length){return -1;}return 0;};var getAbilityMod=function getAbilityMod(score){return Math.floor((getIntValue(score)-10)/2);};var addArithmeticOperator=function addArithmeticOperator(string,number){var value=number;if(string){if(number<0){value=' - '+Math.abs(number);}else {value=' + '+number;}}return value;};var numberWithCommas=function numberWithCommas(x){var parts=x.toString().split('.');parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,',');return parts.join('.');};var findClosest=function findClosest(array,goal){return array.reduce(function(prev,curr){return Math.abs(curr-goal)<Math.abs(prev-goal)?curr:prev;});};var getCorrectAbilityBasedOnBonus=function getCorrectAbilityBasedOnBonus(finalSetAttrs,repeatingString,fieldName,bonus,spellMods,meleeMods,spellAttack,rangedAttack,dexMod){var closest=void 0;if(bonus){if(spellAttack){closest=findClosest(spellMods,bonus);bonus-=closest;if(closest===spellMods[0]){finalSetAttrs[repeatingString+fieldName]='intelligence';}else if(closest===spellMods[1]){finalSetAttrs[repeatingString+fieldName]='wisdom';}else if(closest===spellMods[2]){finalSetAttrs[repeatingString+fieldName]='charisma';}}else {if(rangedAttack){finalSetAttrs[repeatingString+'attack_ability']='dexterity';bonus-=dexMod;}else {closest=findClosest(meleeMods,bonus);bonus-=closest;if(closest===meleeMods[0]){finalSetAttrs[repeatingString+fieldName]='strength';}else if(closest===meleeMods[1]){finalSetAttrs[repeatingString+fieldName]='dexterity';}}}}else {finalSetAttrs[repeatingString+fieldName]=0;}return bonus;};var getAnyCorrectAbilityBasedOnBonus=function getAnyCorrectAbilityBasedOnBonus(finalSetAttrs,repeatingString,fieldName,bonus,abilityMods){var closest=findClosest(abilityMods,bonus);if(bonus){bonus-=closest;if(closest===abilityMods[0]){finalSetAttrs[repeatingString+fieldName]='strength';}else if(closest===abilityMods[1]){finalSetAttrs[repeatingString+fieldName]='dexterity';}else if(closest===abilityMods[2]){finalSetAttrs[repeatingString+fieldName]='constitution';}else if(closest===abilityMods[3]){finalSetAttrs[repeatingString+fieldName]='intelligence';}else if(closest===abilityMods[4]){finalSetAttrs[repeatingString+fieldName]='wisdom';}else if(closest===abilityMods[5]){finalSetAttrs[repeatingString+fieldName]='charisma';}}else {finalSetAttrs[repeatingString+fieldName]=0;}return bonus;};var lowercaseDamageTypes=function lowercaseDamageTypes(string){if(!string){string='';}return string.replace('Acid','acid').replace('Cold','cold').replace('Fire','fire').replace('Force','force').replace('Lightning','lightning').replace('Necrotic','necrotic').replace('Poison','poison').replace('Psychic','psychic').replace('Radiant','radiant').replace('Thunder','thunder').replace('Bludgeoning','bludgeoning').replace('Piercing','piercing').replace('Slashing','slashing').replace('And','and').replace('From','from').replace('Nonmagical','nonmagical').replace('Weapons','weapons').replace('That','that').replace('Aren\'t','aren\'t').replace('Silvered','silvered').replace('Adamantine','adamantine');};var showSign=function showSign(value){if(value>=0){value='+'+value;}return value;};var camelize=function camelize(str){return str.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(match,index){if(+match===0)return '';return index===0?match.toLowerCase():match.toUpperCase();});};var calculateGold=function calculateGold(){var collectionArray=['cp','copper_per_gold','sp','silver_per_gold','ep','electrum_per_gold','gp','pp','platinum_per_gold'];var finalSetAttrs={};getAttrs(collectionArray,function(v){var copperPieces=getFloatValue(v.cp);var silverPieces=getFloatValue(v.sp);var electrumPieces=getFloatValue(v.ep);var goldPieces=getFloatValue(v.gp);var platinumPieces=getFloatValue(v.pp);var copperPerGold=getFloatValue(v.copper_per_gold,100);var silverPerGold=getFloatValue(v.silver_per_gold,10);var electrumPerGold=getFloatValue(v.electrum_per_gold,2);var platinumPerGold=getFloatValue(v.platinum_per_gold,10);finalSetAttrs.total_gp=(copperPieces/copperPerGold+silverPieces/silverPerGold+electrumPieces/electrumPerGold+goldPieces+platinumPieces*platinumPerGold).toFixed(2);finalSetAttrs.weight_coinage=(copperPieces+silverPieces+electrumPieces+goldPieces+platinumPieces)/50;setFinalAttrs(v,finalSetAttrs);});};on('change:cp change:copper_per_gold change:sp change:silver_per_gold change:ep change:electrum_per_gold change:gp change:pp change:platinum_per_gold',function(){calculateGold();});var updateAbilityModifier=function updateAbilityModifier(ability){var collectionArray=[ability,ability+'_bonus',ability+'_mod',ability+'_mod_with_sign',ability+'_check_mod',ability+'_check_mod_formula',ability+'_check_bonus','global_ability_bonus','strength_mod','dexterity_mod','jack_of_all_trades_toggle','jack_of_all_trades','remarkable_athlete_toggle','remarkable_athlete','global_check_bonus'];var finalSetAttrs={};if(ability==='strength'||ability==='dexterity'){collectionArray.push('finesse_mod');}if(ability==='strength'){collectionArray.push('weight_multiplier');collectionArray.push('carrying_capacity');collectionArray.push('max_push_drag_lift');collectionArray.push('encumbered');collectionArray.push('heavily_encumbered');}getAttrs(collectionArray,function(v){var abilityScore=getIntValue(v[ability]);var abilityBonus=getIntValue(v[ability+'_bonus']);var globalAbilityBonus=v.global_ability_bonus;var abilityScoreCalc=abilityScore+abilityBonus;if(!isNaN(globalAbilityBonus)){abilityScoreCalc+=getIntValue(globalAbilityBonus);}var abilityCheckBonus=getIntValue(v[ability+'_check_bonus']);var abilityMod=getAbilityMod(abilityScoreCalc);var abilityCheck=abilityMod;var abilityCheckFormula='';if(abilityMod!==0){abilityCheckFormula=abilityMod+'['+firstThree(ability)+' mod with bonus]';}if((ability==='strength'||ability==='dexterity'||ability==='constitution')&&v.remarkable_athlete_toggle==='@{remarkable_athlete}'){var remarkableAthlete=getIntValue(v.remarkable_athlete);abilityCheck+=remarkableAthlete;abilityCheckFormula+=addArithmeticOperator(abilityCheckFormula,remarkableAthlete)+'[remarkable athlete]';}else if(v.jack_of_all_trades_toggle==='@{jack_of_all_trades}'){var jackOfAllTrades=getIntValue(v.jack_of_all_trades);abilityCheck+=jackOfAllTrades;abilityCheckFormula+=addArithmeticOperator(abilityCheckFormula,jackOfAllTrades)+'[jack of all trades]';}if(abilityCheckBonus){abilityCheck+=abilityCheckBonus;abilityCheckFormula+=addArithmeticOperator(abilityCheckFormula,abilityCheckBonus)+'['+ability+' check bonus]';}if(v.global_check_bonus){if(!isNaN(v.global_check_bonus)){abilityCheck+=getIntValue(v.global_check_bonus);}if(abilityCheckFormula){abilityCheckFormula+=' + ';}abilityCheckFormula+='(@{global_check_bonus})[global check bonus]';}finalSetAttrs[ability+'_calculated']=abilityScoreCalc;finalSetAttrs[ability+'_mod']=abilityMod;finalSetAttrs[ability+'_mod_with_sign']=showSign(abilityMod);finalSetAttrs[ability+'_check_mod']=abilityCheck;finalSetAttrs[ability+'_check_mod_with_sign']=showSign(abilityCheck);finalSetAttrs[ability+'_check_mod_formula']=abilityCheckFormula;if(ability==='strength'){finalSetAttrs.finesse_mod=Math.max(abilityMod,getIntValue(v.dexterity_mod));var weightMultiplier=getFloatValue(v.weight_multiplier,1);finalSetAttrs.carrying_capacity=abilityScore*15*weightMultiplier;finalSetAttrs.max_push_drag_lift=abilityScore*30*weightMultiplier;finalSetAttrs.encumbered=abilityScore*5*weightMultiplier;finalSetAttrs.heavily_encumbered=abilityScore*10*weightMultiplier;}else if(ability==='dexterity'){finalSetAttrs.finesse_mod=Math.max(abilityMod,getIntValue(v.strength_mod));}setFinalAttrs(v,finalSetAttrs);});};var updateAbilityModifiers=function updateAbilityModifiers(){updateAbilityModifier('strength');updateAbilityModifier('dexterity');updateAbilityModifier('constitution');updateAbilityModifier('intelligence');updateAbilityModifier('wisdom');updateAbilityModifier('charisma');};on('change:jack_of_all_trades_toggle change:jack_of_all_trades change:global_ability_bonus change:global_check_bonus',function(){updateAbilityModifiers();});on('change:strength change:strength_bonus change:strength_check_mod change:strength_check_bonus change:remarkable_athlete_toggle change:remarkable_athlete change:weight_multiplier',function(){updateAbilityModifier('strength');});on('change:dexterity change:dexterity_bonus change:dexterity_check_mod change:dexterity_check_bonus change:remarkable_athlete_toggle change:remarkable_athlete',function(){updateAbilityModifier('dexterity');});on('change:constitution change:constitution_bonus change:constitution_check_mod change:constitution_check_bonus change:remarkable_athlete_toggle change:remarkable_athlete',function(){updateAbilityModifier('constitution');});on('change:intelligence change:intelligence_bonus change:intelligence_check_mod change:intelligence_check_bonus',function(){updateAbilityModifier('intelligence');});on('change:wisdom change:wisdom_bonus change:wisdom_check_mod change:wisdom_check_bonus',function(){updateAbilityModifier('wisdom');});on('change:charisma change:charisma_bonus change:charisma_check_mod change:charisma_check_bonus',function(){updateAbilityModifier('charisma');});var setTrait=function setTrait(obj){var repeatingItem='repeating_trait';var collectionArray=[];var finalSetAttrs={};var itemId=void 0;if(!obj.name){obj.name=obj.storageName;}getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=ids[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var id=_step2.value;var repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+'storage_name');collectionArray.push(repeatingString+'name');collectionArray.push(repeatingString+'uses');collectionArray.push(repeatingString+'freetext');collectionArray.push(repeatingString+'saving_throw_toggle');collectionArray.push(repeatingString+'damage_toggle');collectionArray.push(repeatingString+'heal_toggle');collectionArray.push(repeatingString+'extras_toggle');if(repeatingItem==='repeating_trait'){collectionArray.push(repeatingString+'display_text');}for(var prop in obj){if(obj.hasOwnProperty(prop)){collectionArray.push(''+repeatingString+prop);}}}}catch(err){_didIteratorError2=true;_iteratorError2=err;}finally {try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return();}}finally {if(_didIteratorError2){throw _iteratorError2;}}}getAttrs(collectionArray,function(v){var repeatingString=void 0;var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=ids[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var id=_step3.value;repeatingString=repeatingItem+'_'+id+'_';if(v[repeatingString+'storage_name']===obj.storageName){itemId=id;}}}catch(err){_didIteratorError3=true;_iteratorError3=err;}finally {try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return();}}finally {if(_didIteratorError3){throw _iteratorError3;}}}if(!itemId){itemId=generateRowID();}repeatingString=repeatingItem+'_'+itemId+'_';if(!obj.clear&&isUndefined(v[repeatingString+'storage_name'])){finalSetAttrs[repeatingString+'storage_name']=obj.storageName;}if(!obj.clear&&v[repeatingString+'name']!==obj.name){finalSetAttrs[repeatingString+'name']=obj.name;}delete obj.storageName;if(obj.clear){delete obj.clear;for(var prop in obj){if(obj.hasOwnProperty(prop)&&!isUndefined(v[''+repeatingString+prop])){finalSetAttrs[''+repeatingString+prop]=obj[prop];}}}else {for(var _prop in obj){if(obj.hasOwnProperty(_prop)){if((_prop==='name'||_prop==='freetext')&&(isUndefined(v[''+repeatingString+_prop])||calculatePercentDifference(v[''+repeatingString+_prop].length,obj[_prop].length)<10)){finalSetAttrs[''+repeatingString+_prop]=obj[_prop];}else if(v[''+repeatingString+_prop]!==obj[_prop]){finalSetAttrs[''+repeatingString+_prop]=obj[_prop];}}}if(obj.saving_throw_ability||obj.saving_throw_bonus||obj.saving_throw_vs_ability){finalSetAttrs[repeatingString+'saving_throw_toggle']=toggleVars.saving_throw;}if(obj.damage||obj.damage_ability||obj.damage_bonus){finalSetAttrs[repeatingString+'damage_toggle']=toggleVars.damage;}if(obj.heal||obj.heal_ability||obj.heal_bonus||obj.heal_query_toggle){finalSetAttrs[repeatingString+'heal_toggle']=toggleVars.heal;}if(obj.freetext&&isUndefined(v[repeatingString+'extras_toggle'])){finalSetAttrs[repeatingString+'extras_toggle']=toggleVars.extras;}if(obj.uses_max&&!obj.uses&&isUndefined(v[repeatingString+'uses'])){finalSetAttrs[repeatingString+'uses']=obj.uses_max;}if(obj.freetext&&repeatingItem==='repeating_trait'&&(isUndefined(v[repeatingString+'display_text'])||calculatePercentDifference(v[repeatingString+'display_text'].length,obj.freetext.length)<10)){finalSetAttrs[repeatingString+'display_text']=obj.freetext;}}setFinalAttrs(v,finalSetAttrs);return itemId;});});};var setClassFeatures=function setClassFeatures(){var finalSetAttrs={};var collectionArray=['ac_unarmored_ability','jack_of_all_trades_toggle','careful_spell_toggle','distant_spell_toggle','empowered_spell_toggle','extended_spell_toggle','heightened_spell_toggle','quickened_spell_toggle','subtle_spell_toggle','twinned_spell_toggle'];var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=ABILITIES[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var ability=_step4.value;collectionArray.push(ability+'_mod');}}catch(err){_didIteratorError4=true;_iteratorError4=err;}finally {try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return();}}finally {if(_didIteratorError4){throw _iteratorError4;}}}var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=CLASSES[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var className=_step5.value;collectionArray.push(className+'_level');}}catch(err){_didIteratorError5=true;_iteratorError5=err;}finally {try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return();}}finally {if(_didIteratorError5){throw _iteratorError5;}}}getAttrs(collectionArray,function(v){if(v.fighter_level>=5){var extraAttackTimes=void 0;if(v.fighter_level>=20){extraAttackTimes=getTranslationByKey('CLASS_FEATURE_EXTRA_ATTACK_FOUR');}else if(v.fighter_level>=11){extraAttackTimes=getTranslationByKey('CLASS_FEATURE_EXTRA_ATTACK_THREE');}else {extraAttackTimes=getTranslationByKey('CLASS_FEATURE_EXTRA_ATTACK_TWICE');}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_EXTRA_ATTACK_TEXT').replace('NUMBER_OF_TIMES',extraAttackTimes),name:getTranslationByKey('CLASS_FEATURE_EXTRA_ATTACK'),storageName:'Extra Attack'});}else if(v.barbarian_level>=5||v.monk_level>=5||v.paladin_level>=5||v.ranger_level>=5){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_EXTRA_ATTACK_TEXT').replace('NUMBER_OF_TIMES',getTranslationByKey('CLASS_FEATURE_EXTRA_ATTACK_TWICE')),name:getTranslationByKey('CLASS_FEATURE_EXTRA_ATTACK'),storageName:'Extra Attack'});}if(v.barbarian_level){var rageUses=void 0;if(v.barbarian_level>=20){rageUses=999999;}else if(v.barbarian_level>=17){rageUses=6;}else if(v.barbarian_level>=12){rageUses=5;}else if(v.barbarian_level>=6){rageUses=4;}else if(v.barbarian_level>=3){rageUses=3;}else {rageUses=2;}var rageDamage=void 0;if(v.barbarian_level>=16){rageDamage=4;}else if(v.barbarian_level>=9){rageDamage=3;}else {rageDamage=2;}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_RAGE_TEXT').replace('RAGE_DAMAGE',rageDamage),name:getTranslationByKey('CLASS_FEATURE_RAGE'),recharge:'Long Rest',storageName:'Rage',uses_max:rageUses});if(isUndefined(v.ac_unarmored_ability)){finalSetAttrs.ac_unarmored_ability='constitution';}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_UNARMORED_DEFENSE_BARBARIAN_TEXT'),name:getTranslationByKey('CLASS_FEATURE_UNARMORED_DEFENSE'),storageName:'Unarmored Defense Barbarian'});if(v.barbarian_level>=2){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_RECKLESS_ATTACK_TEXT'),name:getTranslationByKey('CLASS_FEATURE_RECKLESS_ATTACK'),storageName:'Reckless Attack'});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_DANGER_SENSE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_DANGER_SENSE'),storageName:'Danger Sense'});}if(v.barbarian_level>=5){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_FAST_MOVEMENT_TEXT'),name:getTranslationByKey('CLASS_FEATURE_FAST_MOVEMENT'),storageName:'Fast Movement'});}if(v.barbarian_level>=7){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_FERAL_INSTINCT_TEXT'),name:getTranslationByKey('CLASS_FEATURE_FERAL_INSTINCT'),storageName:'Feral Instinct'});}if(v.barbarian_level>=9){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_BRUTAL_CRITICAL_TEXT'),name:getTranslationByKey('CLASS_FEATURE_BRUTAL_CRITICAL'),storageName:'Brutal Critical'});}if(v.barbarian_level>=11){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_RELENTLESS_RAGE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_RELENTLESS_RAGE'),storageName:'Relentless Rage'});}if(v.barbarian_level>=15){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_PERSISTENT_RAGE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_PERSISTENT_RAGE'),storageName:'Persistent Rage'});}if(v.barbarian_level>=18){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_INDOMITABLE_MIGHT_TEXT'),name:getTranslationByKey('CLASS_FEATURE_INDOMITABLE_MIGHT'),storageName:'Indomitable Might'});}if(v.barbarian_level>=20){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_PRIMAL_CHAMPION_TEXT'),name:getTranslationByKey('CLASS_FEATURE_PRIMAL_CHAMPION'),storageName:'Primal Champion'});}}if(v.bard_level){var die=void 0;if(v.bard_level>=15){die='d12';}else if(v.bard_level>=10){die='d10';}else if(v.bard_level>=5){die='d8';}else {die='d6';}var recharge='Long Rest';if(v.bard_level>=5){recharge='Short Rest';}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_BARDIC_INSPIRATION_TEXT').replace('d6',die),name:getTranslationByKey('CLASS_FEATURE_BARDIC_INSPIRATION'),recharge:recharge,storageName:'Bardic Inspiration',uses_max:Math.max(getIntValue(v.charisma_mod),1)});if(v.bard_level>=2){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_JACK_OF_ALL_TRADES_TEXT'),name:getTranslationByKey('CLASS_FEATURE_JACK_OF_ALL_TRADES'),storageName:'Jack of All Trades'});finalSetAttrs.jack_of_all_trades_toggle='@{jack_of_all_trades}';var heal=void 0;if(v.bard_level>=17){heal='d12';}else if(v.bard_level>=13){heal='d10';}else if(v.bard_level>=9){heal='d8';}else {heal='d6';}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_SONG_OF_REST_TEXT'),heal:heal,name:getTranslationByKey('CLASS_FEATURE_SONG_OF_REST'),storageName:'Song of Rest'});}if(v.bard_level>=3){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_EXPERTISE_BARD_TEXT'),name:getTranslationByKey('CLASS_FEATURE_EXPERTISE'),storageName:'Expertise Bard'});}if(v.bard_level>=6){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_COUNTERCHARM_TEXT'),name:getTranslationByKey('CLASS_FEATURE_COUNTERCHARM'),storageName:'Countercharm'});}if(v.bard_level>=10){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_MAGICAL_SECRETS_TEXT'),name:getTranslationByKey('CLASS_FEATURE_MAGICAL_SECRETS'),storageName:'Magical Secrets'});}if(v.bard_level>=20){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_SUPERIOR_INSPIRATION_TEXT'),name:getTranslationByKey('CLASS_FEATURE_SUPERIOR_INSPIRATION'),storageName:'Superior Inspiration'});}}if(v.cleric_level){if(v.cleric_level>=2){var channelDivinityUses=void 0;if(v.cleric_level>=18){channelDivinityUses=3;}else if(v.cleric_level>=6){channelDivinityUses=2;}else {channelDivinityUses=1;}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_CHANNEL_DIVINITY_CLERIC_TEXT'),name:getTranslationByKey('CLASS_FEATURE_CHANNEL_DIVINITY'),recharge:'Short Rest',storageName:'Channel Divinity Cleric',uses_max:channelDivinityUses});var turnUndeadText=getTranslationByKey('CLASS_FEATURE_CHANNEL_DIVINITY_TURN_UNDEAD_TEXT');if(v.cleric_level>=5){var turnUndeadDestroyCR=void 0;if(v.cleric_level>=17){turnUndeadDestroyCR='4';}else if(v.cleric_level>=14){turnUndeadDestroyCR='3';}else if(v.cleric_level>=11){turnUndeadDestroyCR='2';}else if(v.cleric_level>=8){turnUndeadDestroyCR='1';}else {turnUndeadDestroyCR='1/2';}turnUndeadText+='\n'+getTranslationByKey('CLASS_FEATURE_CHANNEL_DIVINITY_TURN_UNDEAD_TEXT_PART_2').replace('CHALLENGE_RATING',turnUndeadDestroyCR);}setTrait({freetext:turnUndeadText,name:getTranslationByKey('CLASS_FEATURE_CHANNEL_DIVINITY_TURN_UNDEAD'),saving_throw_ability:'wisdom',saving_throw_vs_ability:'WISDOM',storageName:'Turn Undead'});if(v.cleric_level>=10){setTrait({freeform:'{{text_top=[[d100]] > [[@{cleric_level}]]}}',freetext:getTranslationByKey('CLASS_FEATURE_DIVINE_INTERVENTION_TEXT'),name:getTranslationByKey('CLASS_FEATURE_DIVINE_INTERVENTION'),storageName:'Divine Intervention',uses_max:1});}}}if(v.druid_level){if(v.druid_level>=2){var wildShapeHours=Math.floor(v.druid_level/2);var wildShapeUses=void 0;var wildShapeCR=void 0;var wildShapeLimitations=void 0;if(v.druid_level>=4){wildShapeCR='1/2';wildShapeLimitations=getTranslationByKey('CLASS_FEATURE_WILD_SHAPE_NO_FLYING');}else if(v.druid_level>=8){wildShapeCR=1;wildShapeLimitations='';}else {wildShapeCR='1/4';wildShapeLimitations=getTranslationByKey('CLASS_FEATURE_WILD_SHAPE_NO_FLYING_OR_SWIMMING');}if(v.druid_level>=20){wildShapeUses=999999;}else {wildShapeUses=2;}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_WILD_SHAPE_TEXT').replace('WILD_SHAPE_HOURS',wildShapeHours).replace('CHALLENGE_RATING',wildShapeCR).replace('LIMITATIONS',' '+wildShapeLimitations),name:getTranslationByKey('CLASS_FEATURE_WILD_SHAPE'),recharge:'Short Rest',storageName:'Wild Shape',uses_max:wildShapeUses});}if(v.druid_level>=18){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_TIMELESS_BODY_DRUID_TEXT'),name:getTranslationByKey('CLASS_FEATURE_TIMELESS_BODY'),storageName:'Timeless Body'});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_BEAST_SPELLS_TEXT'),name:getTranslationByKey('CLASS_FEATURE_BEAST_SPELLS'),storageName:'Beast Spells'});}if(v.druid_level>=20){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_ARCHDRUID_TEXT'),name:getTranslationByKey('CLASS_FEATURE_ARCHDRUID'),storageName:'Archdruid'});}}if(v.fighter_level){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_FIGHTING_STYLE_TEXT')+' '+getTranslationByKey('CLASS_FEATURE_FIGHTING_STYLE_FIGHTER_OPTIONS'),name:getTranslationByKey('CLASS_FEATURE_FIGHTING_STYLE'),storageName:'Fighting Style'});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_SECOND_WIND_TEXT'),name:getTranslationByKey('CLASS_FEATURE_SECOND_WIND'),heal:'d10 + @{fighter_level}',recharge:'Short Rest',storageName:'Second Wind',uses_max:1});if(v.fighter_level>=2){var actionSurgeUses=void 0;if(v.fighter_level>=17){actionSurgeUses=2;}else {actionSurgeUses=1;}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_ACTION_SURGE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_ACTION_SURGE'),recharge:'Short Rest',storageName:'Action Surge',uses_max:actionSurgeUses});}if(v.fighter_level>=9){var indomitableUses=void 0;if(v.fighter_level>=17){indomitableUses=3;}else if(v.fighter_level>=13){indomitableUses=2;}else {indomitableUses=1;}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_INDOMITABLE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_INDOMITABLE'),recharge:'Long Rest',storageName:'Indomitable',uses_max:indomitableUses});}}if(v.monk_level){if(isUndefined(v.ac_unarmored_ability)){finalSetAttrs.ac_unarmored_ability='wisdom';}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_UNARMORED_DEFENSE_MONK_TEXT'),name:getTranslationByKey('CLASS_FEATURE_UNARMORED_DEFENSE'),storageName:'Unarmored Defense Monk'});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_MARTIAL_ARTS_TEXT'),name:getTranslationByKey('CLASS_FEATURE_MARTIAL_ARTS'),storageName:'Martial Arts'});if(v.monk_level>=2){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_KI_TEXT'),name:getTranslationByKey('CLASS_FEATURE_KI'),recharge:'Short Rest',storageName:'Ki',uses_max:v.monk_level});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_FLURRY_OF_BLOWS_TEXT'),name:getTranslationByKey('CLASS_FEATURE_FLURRY_OF_BLOWS'),storageName:'Flurry of Blows'});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_PATIENT_DEFENSE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_PATIENT_DEFENSE'),storageName:'Patient Defense'});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_STEP_OF_THE_WIND_TEXT'),name:getTranslationByKey('CLASS_FEATURE_STEP_OF_THE_WIND'),storageName:'Step of the Wind'});var unarmoredMovementFeet=void 0;if(v.monk_level>=18){unarmoredMovementFeet=30;}else if(v.monk_level>=14){unarmoredMovementFeet=25;}else if(v.monk_level>=10){unarmoredMovementFeet=20;}else if(v.monk_level>=6){unarmoredMovementFeet=15;}else {unarmoredMovementFeet=10;}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_UNARMORED_MOVEMENT_TEXT').replace('UNARMORED_MOVEMENT_FEET',unarmoredMovementFeet),name:getTranslationByKey('CLASS_FEATURE_UNARMORED_MOVEMENT'),storageName:'Unarmored Movement'});}if(v.monk_level>=3){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_DEFLECT_MISSILES_TEXT'),name:getTranslationByKey('CLASS_FEATURE_DEFLECT_MISSILES'),storageName:'Deflect Missiles'});}if(v.monk_level>=4){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_SLOW_FALL_TEXT'),name:getTranslationByKey('CLASS_FEATURE_SLOW_FALL'),storageName:'Slow Fall'});}if(v.monk_level>=5){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_STUNNING_STRIKE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_STUNNING_STRIKE'),saving_throw_ability:'wisdom',saving_throw_failure:getTranslationByKey('CLASS_FEATURE_STUNNING_STRIKE_SAVING_THROW_FAILURE'),saving_throw_vs_ability:'CONSTITUTION',storageName:'Stunning Strike'});}if(v.monk_level>=6){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_KI_EMPOWERED_STRIKES_TEXT'),name:getTranslationByKey('CLASS_FEATURE_KI_EMPOWERED_STRIKES'),storageName:'Ki-Empowered Strikes'});}if(v.monk_level>=7){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_EVASION_TEXT'),name:getTranslationByKey('CLASS_FEATURE_EVASION'),storageName:'Evasion'});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_STILLNESS_OF_MIND_TEXT'),name:getTranslationByKey('CLASS_FEATURE_STILLNESS_OF_MIND'),storageName:'Stillness of Mind'});}if(v.monk_level>=10){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_PURITY_OF_BODY_TEXT'),name:getTranslationByKey('CLASS_FEATURE_PURITY_OF_BODY'),storageName:'Purity of Body'});}if(v.monk_level>=13){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_TONGUE_OF_THE_SUN_AND_MOON_TEXT'),name:getTranslationByKey('CLASS_FEATURE_TONGUE_OF_THE_SUN_AND_MOON'),storageName:'Tongue of the Sun and Moon'});}if(v.monk_level>=14){finalSetAttrs.death_saving_throw_prof='@{pb}';setTrait({freetext:getTranslationByKey('CLASS_FEATURE_DIAMOND_SOUL_TEXT'),name:getTranslationByKey('CLASS_FEATURE_DIAMOND_SOUL'),storageName:'Diamond Soul'});}if(v.monk_level>=15){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_TIMELESS_BODY_MONK_TEXT'),name:getTranslationByKey('CLASS_FEATURE_TIMELESS_BODY'),storageName:'Timeless Body'});}if(v.monk_level>=15){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_EMPTY_BODY_TEXT'),name:getTranslationByKey('CLASS_FEATURE_EMPTY_BODY'),storageName:'Empty Body'});}if(v.monk_level>=20){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_PERFECT_SELF_TEXT'),name:getTranslationByKey('CLASS_FEATURE_PERFECT_SELF'),storageName:'Perfect Self'});}}if(v.paladin_level){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_DIVINE_SENSE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_DIVINE_SENSE'),recharge:'Long Rest',storageName:'Divine Sense',uses_max:Math.max(1+v.charisma_mod,1)});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_LAY_ON_HANDS_TEXT'),heal_query_toggle:toggleVars.heal_query,name:getTranslationByKey('CLASS_FEATURE_LAY_ON_HANDS'),recharge:'Long Rest',storageName:'Lay on Hands',uses_max:5*v.paladin_level});if(v.paladin_level>=2){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_FIGHTING_STYLE_TEXT')+' '+getTranslationByKey('CLASS_FEATURE_FIGHTING_STYLE_PALADIN_OPTIONS'),name:getTranslationByKey('CLASS_FEATURE_FIGHTING_STYLE'),storageName:'Fighting Style'});setTrait({damage:'(?{Spell Level|1|2|3|4+, 4} + 1)d8',damage_type:getTranslationByKey('RADIANT'),freeform:'{{subheader=(as ?{Spell Level|1|2|3|4+})}}',freetext:getTranslationByKey('CLASS_FEATURE_DIVINE_SMITE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_DIVINE_SMITE'),second_damage:'d8',second_damage_type:getTranslationByKey('VS_FIEND_OR_UNDEAD'),storageName:'Divine Smite'});}if(v.paladin_level>=3){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_DIVINE_HEALTH_TEXT'),name:getTranslationByKey('CLASS_FEATURE_DIVINE_HEALTH'),storageName:'Divine Health'});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_CHANNEL_DIVINITY_PALADIN_TEXT'),name:getTranslationByKey('CLASS_FEATURE_CHANNEL_DIVINITY'),recharge:'Short Rest',storageName:'Channel Divinity Paladin',uses_max:1});}if(v.paladin_level>=6){var auraRange=void 0;if(v.paladin_level>=18){auraRange=30;}else {auraRange=10;}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_AURA_OF_PROTECTION_TEXT').replace('AURA_RANGE',auraRange),name:getTranslationByKey('CLASS_FEATURE_AURA_OF_PROTECTION'),storageName:'Aura of Protection'});if(v.paladin_level>=10){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_AURA_OF_COURAGE_TEXT').replace('AURA_RANGE',auraRange),name:getTranslationByKey('CLASS_FEATURE_AURA_OF_COURAGE'),storageName:'Aura of Courage'});}}if(v.paladin_level>=11){setTrait({damage:'1d8',damage_ability:'',damage_type:'radiant',freetext:getTranslationByKey('CLASS_FEATURE_IMPROVED_DIVINE_SMITE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_IMPROVED_DIVINE_SMITE'),storageName:'Improved Divine Smite'});}if(v.paladin_level>=14){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_CLEANSING_TOUCH_TEXT'),name:getTranslationByKey('CLASS_FEATURE_CLEANSING_TOUCH'),recharge:'Long Rest',storageName:'Cleaning Touch',uses_max:Math.max(getIntValue(v.charisma_mod),1)});}}if(v.ranger_level){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_FAVORED_ENEMY_TEXT'),name:getTranslationByKey('CLASS_FEATURE_FAVORED_ENEMY'),storageName:'Favored Enemy'});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_NATURAL_EXPLORER_TEXT'),name:getTranslationByKey('CLASS_FEATURE_NATURAL_EXPLORER'),storageName:'Natural Explorer'});if(v.ranger_level>=2){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_FIGHTING_STYLE_TEXT')+' '+getTranslationByKey('CLASS_FEATURE_FIGHTING_STYLE_RANGER_OPTIONS'),name:getTranslationByKey('CLASS_FEATURE_FIGHTING_STYLE'),storageName:'Fighting Style'});}if(v.ranger_level>=3){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_PRIMEVAL_AWARENESS_TEXT'),name:getTranslationByKey('CLASS_FEATURE_PRIMEVAL_AWARENESS'),storageName:'Primeval Awareness'});}if(v.ranger_level>=8){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_LANDS_STRIDE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_LANDS_STRIDE'),storageName:'Land\'s Stride'});}if(v.ranger_level>=10){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_HIDE_IN_PLAIN_SIGHT_TEXT'),name:getTranslationByKey('CLASS_FEATURE_HIDE_IN_PLAIN_SIGHT'),storageName:'Hide in Plain Sight'});}if(v.ranger_level>=14){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_VANISH_TEXT'),name:getTranslationByKey('CLASS_FEATURE_VANISH'),storageName:'Vanish'});}if(v.ranger_level>=18){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_FERAL_SENSES_TEXT'),name:getTranslationByKey('CLASS_FEATURE_FERAL_SENSES'),storageName:'Feral Senses'});}if(v.ranger_level>=20){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_FOE_SLAYER_TEXT'),name:getTranslationByKey('CLASS_FEATURE_FOE_SLAYER'),storageName:'Foe Slayer'});}}if(v.rogue_level){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_EXPERTISE_ROGUE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_EXPERTISE'),storageName:'Expertise Rogue'});setTrait({damage:Math.ceil(getIntValue(v.rogue_level)/2)+'d6',freetext:getTranslationByKey('CLASS_FEATURE_SNEAK_ATTACK_TEXT'),name:getTranslationByKey('CLASS_FEATURE_SNEAK_ATTACK'),storageName:'Sneak Attack'});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_THIEVES_CANT_TEXT'),name:getTranslationByKey('CLASS_FEATURE_THIEVES_CANT'),storageName:'Thieves\' Cant'});if(v.rogue_level>=2){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_CUNNING_ACTION_TEXT'),name:getTranslationByKey('CLASS_FEATURE_CUNNING_ACTION'),storageName:'Cunning Action'});}if(v.rogue_level>=5){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_UNCANNY_DODGE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_UNCANNY_DODGE'),storageName:'Uncanny Dodge'});}if(v.rogue_level>=7){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_EVASION_TEXT'),name:getTranslationByKey('CLASS_FEATURE_EVASION'),storageName:'Evasion'});}if(v.rogue_level>=11){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_RELIABLE_TALENT_TEXT'),name:getTranslationByKey('CLASS_FEATURE_RELIABLE_TALENT'),storageName:'Reliable Talent'});}if(v.rogue_level>=14){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_BLINDSENSE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_BLINDSENSE'),storageName:'Blindsense'});}if(v.rogue_level>=15){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_SLIPPERY_MIND_TEXT'),name:getTranslationByKey('CLASS_FEATURE_SLIPPERY_MIND'),storageName:'Slippery Mind'});}if(v.rogue_level>=18){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_ELUSIVE_TEXT'),name:getTranslationByKey('CLASS_FEATURE_ELUSIVE'),storageName:'Elusive'});}if(v.rogue_level>=20){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_STROKE_OF_LUCK_TEXT'),name:getTranslationByKey('CLASS_FEATURE_STROKE_OF_LUCK'),recharge:'Short Rest',storageName:'Stroke of Luck',uses_max:1});}}if(v.sorcerer_level){if(v.sorcerer_level>=2){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_SORCERY_POINTS_TEXT'),name:getTranslationByKey('CLASS_FEATURE_SORCERY_POINTS'),recharge:'Long Rest',storageName:'Sorcery Points',uses_max:v.sorcerer_level});setTrait({freetext:getTranslationByKey('CLASS_FEATURE_FLEXIBLE_CASTING_TEXT'),name:getTranslationByKey('CLASS_FEATURE_FLEXIBLE_CASTING'),storageName:'Flexible Casting'});if(v.sorcerer_level>=3){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_METAMAGIC_TEXT'),name:getTranslationByKey('CLASS_FEATURE_METAMAGIC'),storageName:'Metamagic'});}if(v.sorcerer_level>=20){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_SORCEROUS_RESTORATION_TEXT'),name:getTranslationByKey('CLASS_FEATURE_SORCEROUS_RESTORATION'),storageName:'Sorcerous Restoration'});}}}if(v.careful_spell_toggle==='1'){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_METAMAGIC_CAREFUL_SPELL_TEXT'),name:getTranslationByKey('CLASS_FEATURE_METAMAGIC_CAREFUL_SPELL'),storageName:'Careful Spell'});}if(v.distant_spell_toggle==='1'){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_METAMAGIC_DISTANT_SPELL_TEXT'),name:getTranslationByKey('CLASS_FEATURE_METAMAGIC_DISTANT_SPELL'),storageName:'Distant Spell'});}if(v.empowered_spell_toggle==='1'){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_METAMAGIC_EMPOWERED_SPELL_TEXT'),name:getTranslationByKey('CLASS_FEATURE_METAMAGIC_EMPOWERED_SPELL'),storageName:'Empowered Spell'});}if(v.extended_spell_toggle==='1'){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_METAMAGIC_EXTENDED_SPELL_TEXT'),name:getTranslationByKey('CLASS_FEATURE_METAMAGIC_EXTENDED_SPELL'),storageName:'Extended Spell'});}if(v.heightened_spell_toggle==='1'){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_METAMAGIC_HEIGHTENED_SPELL_TEXT'),name:getTranslationByKey('CLASS_FEATURE_METAMAGIC_HEIGHTENED_SPELL'),storageName:'Heightened Spell'});}if(v.quickened_spell_toggle==='1'){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_METAMAGIC_QUICKENED_SPELL_TEXT'),name:getTranslationByKey('CLASS_FEATURE_METAMAGIC_QUICKENED_SPELL'),storageName:'Quickened Spell'});}if(v.subtle_spell_toggle==='1'){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_METAMAGIC_SUBTLE_SPELL_TEXT'),name:getTranslationByKey('CLASS_FEATURE_METAMAGIC_SUBTLE_SPELL'),storageName:'Subtle Spell'});}if(v.twinned_spell_toggle==='1'){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_METAMAGIC_TWINNED_SPELL_TEXT'),name:getTranslationByKey('CLASS_FEATURE_METAMAGIC_TWINNED_SPELL'),storageName:'Twinned Spell'});}if(v.warlock_level){var warlockSpellSlots=void 0;if(v.warlock_level>=17){warlockSpellSlots=4;}else if(v.warlock_level>=11){warlockSpellSlots=3;}else if(v.warlock_level>=2){warlockSpellSlots=2;}else {warlockSpellSlots=1;}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_WARLOCK_SPELL_SLOTS_TEXT'),name:getTranslationByKey('CLASS_FEATURE_WARLOCK_SPELL_SLOTS'),recharge:'Short Rest',storageName:'Warlock Spell Slots',uses_max:warlockSpellSlots});if(v.warlock_level>=2){var eldritchInvocations=void 0;if(v.warlock_level>=17){eldritchInvocations=8;}else if(v.warlock_level>=15){eldritchInvocations=7;}else if(v.warlock_level>=12){eldritchInvocations=6;}else if(v.warlock_level>=9){eldritchInvocations=5;}else if(v.warlock_level>=7){eldritchInvocations=4;}else if(v.warlock_level>=5){eldritchInvocations=3;}else {eldritchInvocations=2;}setTrait({freetext:getTranslationByKey('CLASS_FEATURE_ELDRITCH_INVOCATIONS_TEXT').replace('NUMBER_OF_INVOCATIONS_KNOWN',eldritchInvocations),name:getTranslationByKey('CLASS_FEATURE_ELDRITCH_INVOCATIONS'),storageName:'Eldritch Invocations'});}if(v.warlock_level>=3){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_PACT_BOON_TEXT'),name:getTranslationByKey('CLASS_FEATURE_PACT_BOON'),storageName:'Pact Boon'});}if(v.warlock_level>=11){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_MYSTIC_ARCANUM_TEXT'),name:getTranslationByKey('CLASS_FEATURE_MYSTIC_ARCANUM'),storageName:'Mystic Arcanum'});}if(v.warlock_level>=20){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_ELDRITCH_MASTER_TEXT'),name:getTranslationByKey('CLASS_FEATURE_ELDRITCH_MASTER'),recharge:'Long Rest',storageName:'Eldritch Master'});}}if(v.wizard_level){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_ARCANE_RECOVERY_TEXT'),name:getTranslationByKey('CLASS_FEATURE_ARCANE_RECOVERY'),recharge:'Long Rest',storageName:'Arcane Recovery',uses_max:1});if(v.wizard_level>=18){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_SPELL_MASTERY_TEXT'),name:getTranslationByKey('CLASS_FEATURE_SPELL_MASTERY'),storageName:'Spell Mastery'});}if(v.wizard_level>=20){setTrait({freetext:getTranslationByKey('CLASS_FEATURE_SIGNATURE_SPELLS_TEXT'),name:getTranslationByKey('CLASS_FEATURE_SIGNATURE_SPELLS'),storageName:'Signature Spells'});}}setFinalAttrs(v,finalSetAttrs);});};var updateSpellSlots=function updateSpellSlots(){var collectionArray=['caster_level','caster_type'];var finalSetAttrs={};var spellSlots={1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0};for(var level in spellSlots){if(spellSlots.hasOwnProperty(level)){var repeatingString='spell_slots_l'+level;collectionArray.push(repeatingString+'_calc');collectionArray.push(repeatingString+'_bonus');collectionArray.push(repeatingString+'_max');collectionArray.push(repeatingString+'_toggle');}}getAttrs(collectionArray,function(v){var casterLevel=getIntValue(v.caster_level);var casterType=v.caster_type;if(casterType==='full'){if(casterLevel>=3){spellSlots[1]=4;}else if(casterLevel===2){spellSlots[1]=3;}else if(casterLevel===1){spellSlots[1]=2;}if(casterLevel>=4){spellSlots[2]=3;}else if(casterLevel===3){spellSlots[2]=2;}if(casterLevel>=6){spellSlots[3]=3;}else if(casterLevel===5){spellSlots[3]=2;}if(casterLevel>=9){spellSlots[4]=3;}else if(casterLevel===8){spellSlots[4]=2;}else if(casterLevel===7){spellSlots[4]=1;}if(casterLevel>=18){spellSlots[5]=3;}else if(casterLevel>=10){spellSlots[5]=2;}else if(casterLevel===9){spellSlots[5]=1;}if(casterLevel>=19){spellSlots[6]=2;}else if(casterLevel>=11){spellSlots[6]=1;}if(casterLevel>=20){spellSlots[7]=2;}else if(casterLevel>=13){spellSlots[7]=1;}if(casterLevel>=15){spellSlots[8]=1;}if(casterLevel>=17){spellSlots[9]=1;}}if(casterType==='half'){if(casterLevel>=5){spellSlots[1]=4;}else if(casterLevel>=3){spellSlots[1]=3;}else if(casterLevel===2){spellSlots[1]=2;}if(casterLevel>=7){spellSlots[2]=3;}else if(casterLevel>=5){spellSlots[2]=2;}if(casterLevel>=11){spellSlots[3]=3;}else if(casterLevel>=9){spellSlots[3]=2;}if(casterLevel>=17){spellSlots[4]=3;}else if(casterLevel>=15){spellSlots[4]=2;}else if(casterLevel>=13){spellSlots[4]=1;}if(casterLevel>=19){spellSlots[5]=2;}else if(casterLevel>=17){spellSlots[5]=1;}}if(casterType==='third'){if(casterLevel>=7){spellSlots[1]=4;}else if(casterLevel>=4){spellSlots[1]=3;}else if(casterLevel===3){spellSlots[1]=2;}if(casterLevel>=10){spellSlots[2]=3;}else if(casterLevel>=7){spellSlots[2]=2;}if(casterLevel>=16){spellSlots[3]=3;}else if(casterLevel>=13){spellSlots[3]=2;}if(casterLevel>=19){spellSlots[4]=1;}}for(var _level in spellSlots){if(spellSlots.hasOwnProperty(_level)){var _repeatingString='spell_slots_l'+_level;finalSetAttrs[_repeatingString]=0;if(spellSlots[_level]!==0||exists(v[_repeatingString+'_calc'])){finalSetAttrs['spell_slots_l'+_level+'_calc']=spellSlots[_level];}var slots=v[''+_repeatingString];var slotBonus=getIntValue(v[_repeatingString+'_bonus']);var spellSlotMax=spellSlots[_level]+slotBonus;if(spellSlotMax>0){finalSetAttrs[_repeatingString+'_max']=spellSlotMax;if(isUndefined(slots)){finalSetAttrs[_repeatingString]=spellSlotMax;}finalSetAttrs[_repeatingString+'_toggle']='on';}else {if(exists(v[_repeatingString+'_max'])){finalSetAttrs[_repeatingString+'_max']=0;}if(exists(v[_repeatingString+'_toggle'])){finalSetAttrs[_repeatingString+'_toggle']=0;}}}}setFinalAttrs(v,finalSetAttrs);});};var updateHD=function updateHD(v,finalSetAttrs,hd){for(var key in hd){if(hd.hasOwnProperty(key)){if(hd[key]&&hd[key]!==0){finalSetAttrs['hd_'+key+'_max']=hd[key];finalSetAttrs['hd_'+key+'_query']='?{HD';for(var x=1;x<=hd[key];x++){finalSetAttrs['hd_'+key+'_query']+='|'+x;}finalSetAttrs['hd_'+key+'_query']+='}';finalSetAttrs['hd_'+key+'_toggle']=1;}else {if(!isUndefined(v['hd_'+key+'_max'])){finalSetAttrs['hd_'+key+'_max']=0;}if(!isUndefined(v['hd_'+key+'_query'])){finalSetAttrs['hd_'+key+'_query']='';}if(exists(v['hd_'+key+'_toggle'])){finalSetAttrs['hd_'+key+'_toggle']=0;}}}}};var updateLevels=function updateLevels(repeatingInfo){var repeatingItem='repeating_class';var collectionArray=['is_npc','caster_level','caster_type','class_and_level','level','xp_next_level'];var finalSetAttrs={};var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=CLASSES[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=true){var className=_step6.value;collectionArray.push(className+'_level');collectionArray.push('has_'+className+'_levels');}}catch(err){_didIteratorError6=true;_iteratorError6=err;}finally {try{if(!_iteratorNormalCompletion6&&_iterator6.return){_iterator6.return();}}finally {if(_didIteratorError6){throw _iteratorError6;}}}var defaultClassDetails={barbarian:{hd:'d12'},bard:{hd:'d8',spellcasting:'full'},cleric:{hd:'d8',spellcasting:'full'},druid:{hd:'d8',spellcasting:'full'},fighter:{hd:'d10'},monk:{hd:'d8'},paladin:{hd:'d10',spellcasting:'half'},ranger:{hd:'d10',spellcasting:'half'},rogue:{hd:'d8'},sorcerer:{hd:'d6',spellcasting:'full'},warlock:{hd:'d8',spellcasting:'warlock'},wizard:{hd:'d6',spellcasting:'full'}};var hd={d20:0,d12:0,d10:0,d8:0,d6:0,d4:0,d2:0,d0:0};var spellcasting={full:0,half:0,third:0,warlock:0};var totalLevel=0;var classLevels={};var classesWithSpellcasting=0;var xpTable=[0,300,900,2700,6500,14000,23000,34000,48000,64000,85000,100000,120000,140000,165000,195000,225000,265000,305000,355000,385000,405000,435000,465000,495000,525000,555000,585000,605000,635000,665000];for(var key in hd){if(hd.hasOwnProperty(key)){collectionArray.push('hd_'+key+'_max');collectionArray.push('hd_'+key+'_query');collectionArray.push('hd_'+key+'_toggle');}}getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion7=true;var _didIteratorError7=false;var _iteratorError7=undefined;try{for(var _iterator7=ids[Symbol.iterator](),_step7;!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=true){var id=_step7.value;var repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+'level');collectionArray.push(repeatingString+'name');collectionArray.push(repeatingString+'custom_name');collectionArray.push(repeatingString+'hd');collectionArray.push(repeatingString+'spellcasting');collectionArray.push(repeatingString+'custom_class_toggle');}}catch(err){_didIteratorError7=true;_iteratorError7=err;}finally {try{if(!_iteratorNormalCompletion7&&_iterator7.return){_iterator7.return();}}finally {if(_didIteratorError7){throw _iteratorError7;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion8=true;var _didIteratorError8=false;var _iteratorError8=undefined;try{for(var _iterator8=CLASSES[Symbol.iterator](),_step8;!(_iteratorNormalCompletion8=(_step8=_iterator8.next()).done);_iteratorNormalCompletion8=true){var className=_step8.value;finalSetAttrs[className+'_level']=0;}}catch(err){_didIteratorError8=true;_iteratorError8=err;}finally {try{if(!_iteratorNormalCompletion8&&_iterator8.return){_iterator8.return();}}finally {if(_didIteratorError8){throw _iteratorError8;}}}var _iteratorNormalCompletion9=true;var _didIteratorError9=false;var _iteratorError9=undefined;try{for(var _iterator9=ids[Symbol.iterator](),_step9;!(_iteratorNormalCompletion9=(_step9=_iterator9.next()).done);_iteratorNormalCompletion9=true){var id=_step9.value;var repeatingString=repeatingItem+'_'+id+'_';var _className=v[repeatingString+'name'];var classLevel=v[repeatingString+'level'];if(isUndefined(_className)&&isUndefined(classLevel)){continue;}if(isUndefined(_className)){_className='barbarian';}if(_className==='custom'){finalSetAttrs[repeatingString+'custom_class_toggle']='on';var customName=v[repeatingString+'custom_name'];if(exists(customName)){_className=customName;}else {_className='custom';}}else if(v[repeatingString+'custom_class_toggle']){finalSetAttrs[repeatingString+'custom_class_toggle']=0;}if(isUndefined(classLevel)){classLevel=1;finalSetAttrs[repeatingString+'level']=classLevel;finalSetAttrs[_className+'_level']=classLevel;}else {classLevel=getIntValue(classLevel);totalLevel+=classLevel;if(classLevels[_className]){classLevels[_className]+=classLevel;}else {classLevels[_className]=classLevel;}}var classHd=v[repeatingString+'hd'];if(isUndefined(classHd)||repeatingInfo.field==='name'){if(defaultClassDetails.hasOwnProperty(_className)){classHd=defaultClassDetails[_className].hd;}else {classHd='d12';}finalSetAttrs[repeatingString+'hd']=classHd;}if(classHd&&classLevel){hd[classHd]+=classLevel;}var classSpellcasting=v[repeatingString+'spellcasting'];if(isUndefined(classSpellcasting)){if(defaultClassDetails.hasOwnProperty(_className)){classSpellcasting=defaultClassDetails[_className].spellcasting;if(classSpellcasting){finalSetAttrs[repeatingString+'spellcasting']=classSpellcasting;}}else {finalSetAttrs[repeatingString+'spellcasting']='none';}}else if(classSpellcasting==='warlock'){spellcasting[classSpellcasting]+=classLevel;}else {classesWithSpellcasting+=1;spellcasting[classSpellcasting]+=classLevel;}}}catch(err){_didIteratorError9=true;_iteratorError9=err;}finally {try{if(!_iteratorNormalCompletion9&&_iterator9.return){_iterator9.return();}}finally {if(_didIteratorError9){throw _iteratorError9;}}}finalSetAttrs.number_of_classes=0;finalSetAttrs.class_and_level='';for(var prop in classLevels){if(classLevels.hasOwnProperty(prop)){finalSetAttrs.number_of_classes=finalSetAttrs.number_of_classes+1;if(classLevels.hasOwnProperty(prop)){finalSetAttrs[prop+'_level']=classLevels[prop];if(finalSetAttrs.class_and_level!==''){finalSetAttrs.class_and_level+=', ';}finalSetAttrs.class_and_level+=capitalize(prop)+' '+classLevels[prop];}}}finalSetAttrs.level=totalLevel;var xpForNextLevel=0;if(!totalLevel){totalLevel=0;}if(totalLevel>30){xpForNextLevel=xpTable[30];}else {xpForNextLevel=xpTable[totalLevel];}finalSetAttrs.xp_next_level=xpForNextLevel;var _iteratorNormalCompletion10=true;var _didIteratorError10=false;var _iteratorError10=undefined;try{for(var _iterator10=CLASSES[Symbol.iterator](),_step10;!(_iteratorNormalCompletion10=(_step10=_iterator10.next()).done);_iteratorNormalCompletion10=true){var _className2=_step10.value;if(finalSetAttrs[_className2+'_level']>0){finalSetAttrs['has_'+_className2+'_levels']=1;}else if(!isUndefined(v['has_'+_className2+'_levels'])){finalSetAttrs['has_'+_className2+'_levels']=0;}}}catch(err){_didIteratorError10=true;_iteratorError10=err;}finally {try{if(!_iteratorNormalCompletion10&&_iterator10.return){_iterator10.return();}}finally {if(_didIteratorError10){throw _iteratorError10;}}}updateHD(v,finalSetAttrs,hd);var casterLevel=0;if(!v.is_npc||v.is_npc==='0'||v.is_npc===0){if(classesWithSpellcasting>1){casterLevel+=spellcasting.full;casterLevel+=Math.floor(spellcasting.half/2);casterLevel+=Math.floor(spellcasting.third/3);}else {casterLevel=spellcasting.full+spellcasting.half+spellcasting.third;}finalSetAttrs.caster_level=casterLevel;}if(classesWithSpellcasting>1||spellcasting.full){finalSetAttrs.caster_type='full';}else if(spellcasting.half){finalSetAttrs.caster_type='half';}else if(spellcasting.third){finalSetAttrs.caster_type='third';}setFinalAttrs(v,finalSetAttrs,function(){setClassFeatures();updateSpellSlots();});});});};on('change:repeating_class',function(eventInfo){var repeatingInfo=getRepeatingInfo('repeating_class',eventInfo);if(repeatingInfo){updateLevels(repeatingInfo);}});on('remove:repeating_class',function(){updateLevels();});var watchForClassLevelChanges=function watchForClassLevelChanges(){var classFeatureWatch=[];var _iteratorNormalCompletion11=true;var _didIteratorError11=false;var _iteratorError11=undefined;try{for(var _iterator11=ABILITIES[Symbol.iterator](),_step11;!(_iteratorNormalCompletion11=(_step11=_iterator11.next()).done);_iteratorNormalCompletion11=true){var ability=_step11.value;classFeatureWatch.push('change:'+ability+'_mod');}}catch(err){_didIteratorError11=true;_iteratorError11=err;}finally {try{if(!_iteratorNormalCompletion11&&_iterator11.return){_iterator11.return();}}finally {if(_didIteratorError11){throw _iteratorError11;}}}classFeatureWatch.push('change:careful_spell_toggle');classFeatureWatch.push('change:distant_spell_toggle');classFeatureWatch.push('change:empowered_spell_toggle');classFeatureWatch.push('change:extended_spell_toggle');classFeatureWatch.push('change:heightened_spell_toggle');classFeatureWatch.push('change:quickened_spell_toggle');classFeatureWatch.push('change:subtle_spell_toggle');classFeatureWatch.push('change:twinned_spell_toggle');on(classFeatureWatch.join(' '),function(){setClassFeatures();});};watchForClassLevelChanges();on('change:spell_slots_l1_bonus change:spell_slots_l2_bonus change:spell_slots_l3_bonus change:spell_slots_l4_bonus change:spell_slots_l5_bonus change:spell_slots_l6_bonus change:spell_slots_l7_bonus change:spell_slots_l8_bonus change:spell_slots_l9_bonus',function(){updateSpellSlots();});var getPB=function getPB(level,challenge){var pb=2;level=getIntValue(level);if(challenge==='1/8'||challenge==='1/4'||challenge==='1/2'){challenge=1;}else {getIntValue(challenge);}var levelOrChallenge=Math.max(level,challenge);if(exists(levelOrChallenge)){pb+=Math.floor(Math.abs((levelOrChallenge-1)/4));}return pb;};var updatePb=function updatePb(){var collectionArray=['level','challenge','pb','exp','h_PB'];var finalSetAttrs={};getAttrs(collectionArray,function(v){var pb=getPB(v.level,v.challenge);finalSetAttrs.pb=pb;finalSetAttrs.exp=pb*2;finalSetAttrs.h_PB=pb/2;setFinalAttrs(v,finalSetAttrs);});};on('change:level',function(){updatePb();});var sumRepeating=function sumRepeating(options,sumItems){var repeatingItem='repeating_'+options.collection;var collectionArray=[];var finalSetAttrs={};getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion12=true;var _didIteratorError12=false;var _iteratorError12=undefined;try{for(var _iterator12=ids[Symbol.iterator](),_step12;!(_iteratorNormalCompletion12=(_step12=_iterator12.next()).done);_iteratorNormalCompletion12=true){var id=_step12.value;var repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+options.toggle);if(options.qty){collectionArray.push(repeatingString+options.qty);}var _iteratorNormalCompletion16=true;var _didIteratorError16=false;var _iteratorError16=undefined;try{for(var _iterator16=sumItems[Symbol.iterator](),_step16;!(_iteratorNormalCompletion16=(_step16=_iterator16.next()).done);_iteratorNormalCompletion16=true){var sumItem=_step16.value;finalSetAttrs[sumItem.totalField]=0;if(sumItem.totalFieldSecondary){finalSetAttrs[sumItem.totalFieldSecondary]=0;}collectionArray.push(repeatingString+sumItem.fieldToAdd);if(sumItem.bonus){collectionArray.push(repeatingString+sumItem.bonus);}if(sumItem.armorType){collectionArray.push(repeatingString+sumItem.armorType);}if(sumItem.addOnAfterQty){collectionArray.push(repeatingString+sumItem.addOnAfterQty);}}}catch(err){_didIteratorError16=true;_iteratorError16=err;}finally {try{if(!_iteratorNormalCompletion16&&_iterator16.return){_iterator16.return();}}finally {if(_didIteratorError16){throw _iteratorError16;}}}}}catch(err){_didIteratorError12=true;_iteratorError12=err;}finally {try{if(!_iteratorNormalCompletion12&&_iterator12.return){_iterator12.return();}}finally {if(_didIteratorError12){throw _iteratorError12;}}}if(options.getExtraFields){collectionArray=collectionArray.concat(options.getExtraFields);}getAttrs(collectionArray,function(v){var dexMod=0;if(options.collection==='armor'){dexMod=getIntValue(v.dexterity_mod);}var _iteratorNormalCompletion13=true;var _didIteratorError13=false;var _iteratorError13=undefined;try{for(var _iterator13=ids[Symbol.iterator](),_step13;!(_iteratorNormalCompletion13=(_step13=_iterator13.next()).done);_iteratorNormalCompletion13=true){var id=_step13.value;var repeatingString=repeatingItem+'_'+id+'_';var qty=getIntValue(v[repeatingString+options.qty],1);var _iteratorNormalCompletion15=true;var _didIteratorError15=false;var _iteratorError15=undefined;try{for(var _iterator15=sumItems[Symbol.iterator](),_step15;!(_iteratorNormalCompletion15=(_step15=_iterator15.next()).done);_iteratorNormalCompletion15=true){var sumItem=_step15.value;var fieldToAdd=getFloatValue(v[repeatingString+sumItem.fieldToAdd]);if(sumItem.bonus){fieldToAdd+=getFloatValue(v[repeatingString+sumItem.bonus]);}if(sumItem.armorType){if(!v[repeatingString+sumItem.armorType]||v[repeatingString+sumItem.armorType]==='Light Armor'){fieldToAdd+=dexMod;}else if(v[repeatingString+sumItem.armorType]==='Medium Armor'){var mediumArmorDexMod=getIntValue(v.medium_armor_max_dex,2);fieldToAdd+=Math.min(mediumArmorDexMod,dexMod);}}var itemTotal=round(qty*fieldToAdd,2);if(sumItem.addOnAfterQty){itemTotal+=getFloatValue(v[repeatingString+sumItem.addOnAfterQty]);}itemTotal=round(itemTotal,2);if(sumItem.itemTotal){finalSetAttrs[repeatingString+sumItem.itemTotal]=itemTotal;}var toggle=v[repeatingString+options.toggle];if(toggle!==0&&toggle!=='0'){var addToPrimary=true;var addToSecondary=false;if(sumItem.armorType){if(v[repeatingString+sumItem.armorType]==='Shield'||v[repeatingString+sumItem.armorType]==='AC'){addToSecondary=true;}else if(v[repeatingString+sumItem.armorType]==='Unarmored'){addToPrimary=false;addToSecondary=true;}}if(addToPrimary){finalSetAttrs[sumItem.totalField]+=itemTotal;}if(addToSecondary){finalSetAttrs[sumItem.totalFieldSecondary]+=itemTotal;}}}}catch(err){_didIteratorError15=true;_iteratorError15=err;}finally {try{if(!_iteratorNormalCompletion15&&_iterator15.return){_iterator15.return();}}finally {if(_didIteratorError15){throw _iteratorError15;}}}}}catch(err){_didIteratorError13=true;_iteratorError13=err;}finally {try{if(!_iteratorNormalCompletion13&&_iterator13.return){_iterator13.return();}}finally {if(_didIteratorError13){throw _iteratorError13;}}}var _iteratorNormalCompletion14=true;var _didIteratorError14=false;var _iteratorError14=undefined;try{for(var _iterator14=sumItems[Symbol.iterator](),_step14;!(_iteratorNormalCompletion14=(_step14=_iterator14.next()).done);_iteratorNormalCompletion14=true){var _sumItem=_step14.value;if(_sumItem.totalField&&!exists(finalSetAttrs[_sumItem.totalField])){finalSetAttrs[_sumItem.totalField]=0;}if(_sumItem.totalFieldSecondary&&!exists(finalSetAttrs[_sumItem.totalFieldSecondary])){finalSetAttrs[_sumItem.totalFieldSecondary]=0;}}}catch(err){_didIteratorError14=true;_iteratorError14=err;}finally {try{if(!_iteratorNormalCompletion14&&_iterator14.return){_iterator14.return();}}finally {if(_didIteratorError14){throw _iteratorError14;}}}if(options.collection==='armor'&&!getIntValue(v.is_npc)){finalSetAttrs.ac_unarmored_calc+=10+dexMod+getAbilityValue(v,v.ac_unarmored_ability);finalSetAttrs.AC=Math.max(finalSetAttrs.ac_armored_calc,finalSetAttrs.ac_unarmored_calc);}setFinalAttrs(v,finalSetAttrs);});});};var updateArmor=function updateArmor(rowId){var repeatingItem='repeating_armor';var collectionArray=[];var finalSetAttrs={};var stealthPenalty=void 0;getSectionIDs(repeatingItem,function(ids){if(rowId){ids=[];ids.push(rowId);}var _iteratorNormalCompletion17=true;var _didIteratorError17=false;var _iteratorError17=undefined;try{for(var _iterator17=ids[Symbol.iterator](),_step17;!(_iteratorNormalCompletion17=(_step17=_iterator17.next()).done);_iteratorNormalCompletion17=true){var id=_step17.value;var repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+'parsed');collectionArray.push(repeatingString+'modifiers');collectionArray.push(repeatingString+'stealth');}}catch(err){_didIteratorError17=true;_iteratorError17=err;}finally {try{if(!_iteratorNormalCompletion17&&_iterator17.return){_iterator17.return();}}finally {if(_didIteratorError17){throw _iteratorError17;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion18=true;var _didIteratorError18=false;var _iteratorError18=undefined;try{for(var _iterator18=ids[Symbol.iterator](),_step18;!(_iteratorNormalCompletion18=(_step18=_iterator18.next()).done);_iteratorNormalCompletion18=true){var id=_step18.value;var repeatingString=repeatingItem+'_'+id+'_';if(isUndefined(v[repeatingString+'parsed'])||v[repeatingString+'parsed'].indexOf('acBonus')===-1){var armorModifiers=v[repeatingString+'modifiers'];if(exists(armorModifiers)){finalSetAttrs[repeatingString+'ac_bonus']=armorModifiers.replace(/^\D+/g,'');}if(isUndefined(finalSetAttrs[repeatingString+'parsed'])){finalSetAttrs[repeatingString+'parsed']='';}finalSetAttrs[repeatingString+'parsed']+=' acBonus';}if(v[repeatingString+'stealth']==='Disadvantage'){stealthPenalty=true;}}}catch(err){_didIteratorError18=true;_iteratorError18=err;}finally {try{if(!_iteratorNormalCompletion18&&_iterator18.return){_iterator18.return();}}finally {if(_didIteratorError18){throw _iteratorError18;}}}if(stealthPenalty){setAdvantageOnStealth('dis');}else {setAdvantageOnStealth('normal');}setFinalAttrs(v,finalSetAttrs);});});var options={collection:'armor',getExtraFields:['medium_armor_max_dex','dexterity_mod','ac_unarmored_ability','is_npc'],toggle:'worn'};var _iteratorNormalCompletion19=true;var _didIteratorError19=false;var _iteratorError19=undefined;try{for(var _iterator19=ABILITIES[Symbol.iterator](),_step19;!(_iteratorNormalCompletion19=(_step19=_iterator19.next()).done);_iteratorNormalCompletion19=true){var ability=_step19.value;options.getExtraFields.push(ability+'_mod');}}catch(err){_didIteratorError19=true;_iteratorError19=err;}finally {try{if(!_iteratorNormalCompletion19&&_iterator19.return){_iterator19.return();}}finally {if(_didIteratorError19){throw _iteratorError19;}}}var sumItems=[{fieldToAdd:'weight',totalField:'weight_armor'},{fieldToAdd:'ac_base',bonus:'ac_bonus',armorType:'type',itemTotal:'ac_total',totalField:'ac_armored_calc',totalFieldSecondary:'ac_unarmored_calc'}];sumRepeating(options,sumItems);};on('change:repeating_armor',function(eventInfo){var repeatingInfo=getRepeatingInfo('repeating_armor',eventInfo);if(repeatingInfo&&repeatingInfo.field!=='ac_total'){updateArmor(repeatingInfo.rowId);}});on('change:dexterity_mod change:medium_armor_max_dex change:ac_unarmored_ability remove:repeating_armor',function(){updateArmor();});var updateEquipment=function updateEquipment(rowId){var repeatingItem='repeating_equipment';var collectionArray=[];var finalSetAttrs={};getSectionIDs(repeatingItem,function(ids){if(rowId){ids=[];ids.push(rowId);}var _iteratorNormalCompletion20=true;var _didIteratorError20=false;var _iteratorError20=undefined;try{for(var _iterator20=ids[Symbol.iterator](),_step20;!(_iteratorNormalCompletion20=(_step20=_iterator20.next()).done);_iteratorNormalCompletion20=true){var id=_step20.value;var repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+'content');}}catch(err){_didIteratorError20=true;_iteratorError20=err;}finally {try{if(!_iteratorNormalCompletion20&&_iterator20.return){_iterator20.return();}}finally {if(_didIteratorError20){throw _iteratorError20;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion21=true;var _didIteratorError21=false;var _iteratorError21=undefined;try{for(var _iterator21=ids[Symbol.iterator](),_step21;!(_iteratorNormalCompletion21=(_step21=_iterator21.next()).done);_iteratorNormalCompletion21=true){var id=_step21.value;var repeatingString=repeatingItem+'_'+id+'_';if(isUndefined(v[repeatingString+'parsed'])||v[repeatingString+'parsed'].indexOf('content')===-1){var content=v[repeatingString+'content'];if(exists(content)){content=content.replace(/\s(\d+d\d+\s(?:\+|\-)\s\d+)\s/g,' [[$1]] ').replace(/\s(\d+d\d+)\s/g,' [[$1]] ').replace(/\s(\d+)\s/g,' [[$1]] ');finalSetAttrs[repeatingString+'content']=content;if(isUndefined(finalSetAttrs[repeatingString+'parsed'])){finalSetAttrs[repeatingString+'parsed']='';}finalSetAttrs[repeatingString+'parsed']+=' content';}}}}catch(err){_didIteratorError21=true;_iteratorError21=err;}finally {try{if(!_iteratorNormalCompletion21&&_iterator21.return){_iterator21.return();}}finally {if(_didIteratorError21){throw _iteratorError21;}}}setFinalAttrs(v,finalSetAttrs);});});};on('change:repeating_equipment',function(eventInfo){var repeatingInfo=getRepeatingInfo('repeating_equipment',eventInfo);updateEquipment(repeatingInfo.rowId);});var weighEquipment=function weighEquipment(){var options={collection:'equipment',toggle:'carried',qty:'qty'};var sumItems=[{fieldToAdd:'weight',itemTotal:'weight_total',totalField:'weight_equipment'}];sumRepeating(options,sumItems);};on('change:repeating_equipment:carried change:repeating_equipment:qty change:repeating_equipment:weight remove:repeating_equipment',function(){weighEquipment();});var weighAmmo=function weighAmmo(){var options={collection:'ammo',qty:'qty'};var sumItems=[{fieldToAdd:'weight',totalField:'weight_ammo'}];sumRepeating(options,sumItems);};on('change:repeating_ammo:weight change:repeating_ammo:qty',function(){weighAmmo();});var updateJackOfAllTrades=function updateJackOfAllTrades(){var collectionArray=['pb','jack_of_all_trades'];var finalSetAttrs={};getAttrs(collectionArray,function(v){finalSetAttrs.jack_of_all_trades=Math.floor(getIntValue(v.pb)/2);setFinalAttrs(v,finalSetAttrs);});};on('change:jack_of_all_trades_toggle',function(){updateJackOfAllTrades();});var updateRemarkableAthlete=function updateRemarkableAthlete(){var collectionArray=['pb','remarkable_athlete'];var finalSetAttrs={};getAttrs(collectionArray,function(v){finalSetAttrs.remarkable_athlete=Math.ceil(getIntValue(v.pb)/2);setFinalAttrs(v,finalSetAttrs);});};on('change:remarkable_athlete_toggle',function(){updateRemarkableAthlete();});var updateInitiative=function updateInitiative(){var collectionArray=['initiative','initiative_formula','dexterity_mod','dexterity_check_bonus','initiative_bonus','jack_of_all_trades_toggle','jack_of_all_trades','remarkable_athlete_toggle','remarkable_athlete','global_check_bonus'];var finalSetAttrs={};finalSetAttrs.initiative=0;getAttrs(collectionArray,function(v){var dexMod=getIntValue(v.dexterity_mod);if(exists(dexMod)){finalSetAttrs.initiative+=dexMod;}finalSetAttrs.initiative_formula=dexMod+'[dex]';var dexCheckBonus=getIntValue(v.dexterity_check_bonus);if(exists(dexCheckBonus)){finalSetAttrs.initiative+=dexCheckBonus;finalSetAttrs.initiative_formula+=addArithmeticOperator(finalSetAttrs.initiative_formula,dexCheckBonus)+'[dex check bonus]';}var initiativeBonus=v.initiative_bonus;if(exists(initiativeBonus)){if(!isNaN(initiativeBonus)){finalSetAttrs.initiative+=getIntValue(initiativeBonus);}finalSetAttrs.initiative_formula+=addArithmeticOperator(finalSetAttrs.initiative_formula,initiativeBonus)+'[initiative bonus]';}if(v.remarkable_athlete_toggle==='@{remarkable_athlete}'){var remarkableAthlete=getIntValue(v.remarkable_athlete);if(exists(remarkableAthlete)){finalSetAttrs.initiative+=remarkableAthlete;finalSetAttrs.initiative_formula+=addArithmeticOperator(finalSetAttrs.initiative_formula,remarkableAthlete)+'[remarkable athlete]';}}else if(v.jack_of_all_trades_toggle==='@{jack_of_all_trades}'){var jackOfAllTrades=getIntValue(v.jack_of_all_trades);if(exists(jackOfAllTrades)){finalSetAttrs.initiative+=jackOfAllTrades;finalSetAttrs.initiative_formula+=addArithmeticOperator(finalSetAttrs.initiative_formula,jackOfAllTrades)+'[jack of all trades]';}}var globalCheckBonus=v.global_check_bonus;if(exists(globalCheckBonus)){if(finalSetAttrs.initiative_formula){finalSetAttrs.initiative_formula+=' + ';}finalSetAttrs.initiative_formula+='(@{global_check_bonus})[global check bonus]';}setFinalAttrs(v,finalSetAttrs);});};on('change:dexterity_mod change:dexterity_check_bonus change:initiative_bonus change:jack_of_all_trades_toggle change:jack_of_all_trades change:remarkable_athlete_toggle change:remarkable_athlete change:global_check_bonus',function(){updateInitiative();});var updateWeight=function updateWeight(){var collectionArray=['weight_attacks','weight_ammo','weight_armor','weight_equipment','weight_coinage'];var finalSetAttrs={};getAttrs(collectionArray,function(v){finalSetAttrs.weight_total=round(getFloatValue(v.weight_attacks)+getFloatValue(v.weight_ammo)+getFloatValue(v.weight_armor)+getFloatValue(v.weight_equipment)+getFloatValue(v.weight_coinage),2);setFinalAttrs(v,finalSetAttrs);});};on('change:weight_attacks change:weight_ammo change:weight_armor change:weight_equipment change:weight_coinage',function(){updateWeight();});var updateAttackToggle=function updateAttackToggle(v,finalSetAttrs,repeatingString,options){var attackParse={attackAbility:options.attackAbility,parseName:'attack',toggleField:'roll_toggle',toggleFieldSetTo:toggleVars.roll,triggerFields:['type','attack_bonus']};parseAttackComponent(v,repeatingString,finalSetAttrs,attackParse);var attackFormula='';var attackToggle=v[repeatingString+'roll_toggle'];var toHit=0;if(!attackToggle||attackToggle===toggleVars.roll){var proficiency=v[repeatingString+'proficiency'];if(!proficiency||proficiency==='on'){var pb=getIntValue(v.pb);toHit+=pb;attackFormula+=pb+'[proficient]';}var attackAbility=v[repeatingString+'attack_ability'];if(isUndefined(attackAbility)&&v[repeatingString+'type']==='Ranged Weapon'){attackAbility='dexterity';finalSetAttrs[repeatingString+'attack_ability']=attackAbility;}else if(finalSetAttrs[repeatingString+'attack_ability']){attackAbility=finalSetAttrs[repeatingString+'attack_ability'];}attackAbility=getAbilityValue(v,attackAbility,options.defaultAbility);if(exists(attackAbility)){toHit+=attackAbility;attackFormula+=addArithmeticOperator(attackFormula,attackAbility)+'['+getAbilityShortName(v[repeatingString+'attack_ability'])+']';}var attackBonus=getIntValue(v[repeatingString+'attack_bonus']);if(exists(attackBonus)){toHit+=attackBonus;attackFormula+=addArithmeticOperator(attackFormula,attackBonus)+'[bonus]';}if(exists(options.globalAttackBonus)){if(!isNaN(options.globalAttackBonus)){toHit+=getIntValue(options.globalAttackBonus);}attackFormula+=addArithmeticOperator(attackFormula,options.globalAttackBonus)+'['+options.globalAttackBonusLabel+']';}if(v[repeatingString+'type']==='Melee Weapon'){if(exists(options.globalMeleeAttackBonus)){if(!isNaN(options.globalMeleeAttackBonus)){toHit+=getIntValue(options.globalMeleeAttackBonus);}attackFormula+=addArithmeticOperator(attackFormula,options.globalMeleeAttackBonus)+'[global melee attack bonus]';}}else if(v[repeatingString+'type']==='Ranged Weapon'){if(exists(options.globalRangedAttackBonus)){if(!isNaN(options.globalRangedAttackBonus)){toHit+=getIntValue(options.globalRangedAttackBonus);}attackFormula+=addArithmeticOperator(attackFormula,options.globalRangedAttackBonus)+'[global ranged attack bonus]';}}finalSetAttrs[repeatingString+'attack_formula']=attackFormula;}if(options.type==='attack'){finalSetAttrs[repeatingString+'to_hit']=toHit;}};var updateSavingThrowToggle=function updateSavingThrowToggle(v,finalSetAttrs,repeatingString,options){var savingThrowParse={parseName:'savingThrow',toggleField:'saving_throw_toggle',toggleFieldSetTo:toggleVars.saving_throw,triggerFields:['saving_throw_ability','saving_throw_bonus','saving_throw_vs_ability']};parseAttackComponent(v,repeatingString,finalSetAttrs,savingThrowParse);var savingThrowToggle=v[repeatingString+'saving_throw_toggle'];if(savingThrowToggle===toggleVars.saving_throw){var savingThrowDC=8+getIntValue(v.pb);var savingThrowAbility=v[repeatingString+'saving_throw_ability'];if(!savingThrowAbility&&savingThrowAbility!=='0'){savingThrowAbility=v.default_ability;finalSetAttrs[repeatingString+'saving_throw_ability']=v.default_ability;}savingThrowDC+=getAbilityValue(v,savingThrowAbility,'strength');if(options&&options.bonusDC){savingThrowDC+=getIntValue(options.bonusDC);}savingThrowDC+=getIntValue(v[repeatingString+'saving_throw_bonus']);finalSetAttrs[repeatingString+'saving_throw_dc']=savingThrowDC;}};var updateDamageToggle=function updateDamageToggle(v,finalSetAttrs,repeatingString,options){var damageParse={addCastingModifier:exists(v[repeatingString+'add_casting_modifier']),parseName:'damage',toggleField:'damage_toggle',toggleFieldSetTo:toggleVars.damage,triggerFields:['damage','damage_ability','damage_bonus','damage_type']};parseAttackComponent(v,repeatingString,finalSetAttrs,damageParse);var damageString='';var damageFormula='';var damageToggle=v[repeatingString+'damage_toggle'];var damageAbility=void 0;var damageType=void 0;if(!damageToggle||damageToggle===toggleVars.damage){var damageAddition=0;var damage=v[repeatingString+'damage'];if(exists(damage)){damageString+=damage;damageFormula+=damage+'[damage]';}if(!options.defaultDamageAbility){options.defaultDamageAbility=0;}damageAbility=v[repeatingString+'damage_ability'];if(isUndefined(damageAbility)&&v[repeatingString+'type']==='Melee Weapon'){damageAbility='strength';finalSetAttrs[repeatingString+'damage_ability']=damageAbility;}if(isUndefined(damageAbility)&&v[repeatingString+'type']==='Ranged Weapon'){damageAbility='dexterity';finalSetAttrs[repeatingString+'damage_ability']=damageAbility;}if(exists(damageAbility)||options.defaultDamageAbility){var damageAbilityValue=getAbilityValue(v,damageAbility,options.defaultDamageAbility);if(exists(damageAbilityValue)){damageAddition+=damageAbilityValue;damageFormula+=addArithmeticOperator(damageFormula,damageAbilityValue)+'['+getAbilityShortName(v[repeatingString+'damage_ability'])+']';}}var damageBonus=getIntValue(v[repeatingString+'damage_bonus']);if(exists(damageBonus)){damageAddition+=damageBonus;damageFormula+=addArithmeticOperator(damageFormula,damageBonus)+'[bonus]';}if(exists(options.globalDamageBonus)){if(!isNaN(options.globalDamageBonus)){damageAddition+=getIntValue(options.globalDamageBonus);}else {damageString+=''+addArithmeticOperator(damageString,options.globalDamageBonus);}damageFormula+=addArithmeticOperator(damageFormula,options.globalDamageBonus)+'[global damage bonus]';}if(options&&exists(options.globalMeleeDamageBonus)&&v[repeatingString+'type']==='Melee Weapon'){if(!isNaN(options.globalMeleeDamageBonus)){damageAddition+=getIntValue(options.globalMeleeDamageBonus);}else {damageString+=''+addArithmeticOperator(damageString,options.globalMeleeDamageBonus);}damageFormula+=addArithmeticOperator(damageFormula,options.globalMeleeDamageBonus)+'[global melee damage bonus]';}else if(options&&exists(options.globalRangedDamageBonus)&&v[repeatingString+'type']==='Ranged Weapon'){if(!isNaN(options.globalRangedDamageBonus)){damageAddition+=getIntValue(options.globalRangedDamageBonus);}else {damageString+=''+addArithmeticOperator(damageString,options.globalRangedDamageBonus);}damageFormula+=addArithmeticOperator(damageFormula,options.globalRangedDamageBonus)+'[global ranged damage bonus]';}if(exists(damageAddition)){damageString+=addArithmeticOperator(damageString,damageAddition);}damageType=v[repeatingString+'damage_type'];if(exists(damageType)){if(hasUpperCase(damageType)){damageType=damageType.toLowerCase();finalSetAttrs[repeatingString+'damage_type']=damageType;}damageString+=' '+damageType;}}if(!exists(damageFormula)){damageFormula=0;}finalSetAttrs[repeatingString+'damage_formula']=damageFormula;var secondDamageParse={parseName:'secondDamage',toggleField:'second_damage_toggle',toggleFieldSetTo:toggleVars.second_damage,triggerFields:['second_damage','second_damage_ability','second_damage_bonus','second_damage_type']};parseAttackComponent(v,repeatingString,finalSetAttrs,secondDamageParse);var secondDamageFormula='';var secondDamageToggle=fromVOrFinalSetAttrs(v,finalSetAttrs,repeatingString+'second_damage_toggle');if(secondDamageToggle===toggleVars.second_damage){var secondDamageAddition=0;var secondDamage=v[repeatingString+'second_damage'];if(exists(secondDamage)){damageString+=' + '+secondDamage;secondDamageFormula+=secondDamage+'[second damage]';}var secondDamageAbility=v[repeatingString+'second_damage_ability'];if(exists(secondDamageAbility)){secondDamageAbility=getAbilityValue(v,secondDamageAbility);if(exists(secondDamageAbility)){secondDamageAddition+=secondDamageAbility;secondDamageFormula+=addArithmeticOperator(secondDamageFormula,secondDamageAbility)+'['+getAbilityShortName(v[repeatingString+'second_damage_ability'])+']';}}var secondDamageBonus=getIntValue(v[repeatingString+'second_damage_bonus']);if(exists(secondDamageBonus)){secondDamageAddition+=secondDamageBonus;secondDamageFormula+=addArithmeticOperator(secondDamageFormula,secondDamageBonus)+'[bonus]';}if(exists(secondDamageAddition)){damageString+=addArithmeticOperator(damageString,secondDamageAddition);}var secondDamageType=v[repeatingString+'second_damage_type'];if(exists(secondDamageType)){if(hasUpperCase(secondDamageType)){secondDamageType=secondDamageType.toLowerCase();finalSetAttrs[repeatingString+'second_damage_type']=secondDamageType;}damageString+=' '+secondDamageType;}if(isUndefined(v[repeatingString+'parsed'])||v[repeatingString+'parsed'].indexOf('damageProperties')===-1){var damageProperties=v[repeatingString+'properties'];if(exists(damageProperties)){if(damageProperties.indexOf('Versatile')!==-1){if(!exists(damageAbility)){damageAbility='strength';}finalSetAttrs[repeatingString+'second_damage_ability']=damageAbility;finalSetAttrs[repeatingString+'second_damage_type']=damageType;}if(!finalSetAttrs[repeatingString+'parsed']){finalSetAttrs[repeatingString+'parsed']='';}finalSetAttrs[repeatingString+'parsed']+=' damageProperties';}}}if(!exists(secondDamageFormula)){secondDamageFormula=0;}finalSetAttrs[repeatingString+'second_damage_formula']=secondDamageFormula;if(options.type==='attack'){finalSetAttrs[repeatingString+'damage_string']=damageString;}};var updateHealToggle=function updateHealToggle(v,finalSetAttrs,repeatingString){var healParse={addCastingModifier:exists(v[repeatingString+'add_casting_modifier']),parseName:'heal',toggleField:'heal_toggle',toggleFieldSetTo:toggleVars.heal,triggerFields:['heal','heal_query_toggle']};parseAttackComponent(v,repeatingString,finalSetAttrs,healParse);var healFormula='';var healToggle=v[repeatingString+'heal_toggle'];if(healToggle===toggleVars.heal){if(!isUndefined(v[repeatingString+'heal'])){healFormula='@{heal}[heal]';}if(!isUndefined(v[repeatingString+'heal_ability'])){var healAbility=getAbilityValue(v,v[repeatingString+'heal_ability']);healFormula+=addArithmeticOperator(healFormula,healAbility)+'['+getAbilityShortName(v[repeatingString+'heal_ability'])+']';}if(!isUndefined(v[repeatingString+'heal_bonus'])){var healBonus=getIntValue(v[repeatingString+'heal_bonus']);healFormula+=addArithmeticOperator(healFormula,healBonus)+'[bonus]';}if(!isUndefined(v.global_spell_heal_bonus)){if(healFormula){healFormula+=' + ';}healFormula+='@{global_spell_heal_bonus}[global spell heal bonus]';}if(v[repeatingString+'heal_query_toggle']===toggleVars.heal_query){if(healFormula){healFormula+=' + ';}healFormula+='@{heal_query_toggle}[query amount]';}finalSetAttrs[repeatingString+'heal_formula']=healFormula;}};var updateHigherLevelToggle=function updateHigherLevelToggle(v,finalSetAttrs,repeatingString){var higherLevelParse={addCastingModifier:exists(v[repeatingString+'add_casting_modifier']),parseName:'higherLevel',toggleField:'higher_level_toggle',toggleFieldSetTo:toggleVars.higher_level,triggerFields:['higher_level_dice','higher_level_die','second_higher_level_dice','second_higher_level_die','higher_level_heal']};parseAttackComponent(v,repeatingString,finalSetAttrs,higherLevelParse);var higherLevelToggle=v[repeatingString+'higher_level_toggle'];if(exists(higherLevelToggle)&&higherLevelToggle===toggleVars.higher_level){var spellLevel=getIntValue(v[repeatingString+'spell_level']);finalSetAttrs[repeatingString+'higher_level_query']='@{higher_level_query_'+spellLevel+'}';var damageToggle=v[repeatingString+'damage_toggle'];if(damageToggle&&damageToggle===toggleVars.damage){var higherLevelDamage='((@{higher_level_query} - @{spell_level}) * @{higher_level_dice})@{higher_level_die}[higher lvl]';finalSetAttrs[repeatingString+'damage_formula']+=addArithmeticOperator(finalSetAttrs[repeatingString+'damage_formula'],higherLevelDamage);finalSetAttrs[repeatingString+'damage_crit_formula']=higherLevelDamage;}var secondDamageToggle=v[repeatingString+'second_damage_toggle'];if(secondDamageToggle&&secondDamageToggle===toggleVars.second_damage){var higherLevelSecondDamage='((@{higher_level_query} - @{spell_level}) * @{second_higher_level_dice})@{second_higher_level_die}[higher lvl]';finalSetAttrs[repeatingString+'second_damage_formula']+=addArithmeticOperator(finalSetAttrs[repeatingString+'second_damage_formula'],higherLevelSecondDamage);finalSetAttrs[repeatingString+'second_damage_crit_formula']=higherLevelSecondDamage;}var healToggle=v[repeatingString+'heal_toggle'];if(healToggle&&healToggle===toggleVars.heal){if(finalSetAttrs[repeatingString+'heal_formula']){finalSetAttrs[repeatingString+'heal_formula']+=' + ';}finalSetAttrs[repeatingString+'heal_formula']+='((@{higher_level_query} - @{spell_level}) * @{higher_level_dice})@{higher_level_die}[higher lvl] + (@{higher_level_heal} * (@{higher_level_query} - @{spell_level}))[higher lvl flat amount]';}}};var updateCritDamage=function updateCritDamage(){var repeatingItems=['repeating_attack','repeating_spell','repeating_trait','repeating_action','repeating_reaction','repeating_legendaryaction','repeating_lairaction','repeating_regionaleffect'];var collectionArray=[];var finalSetAttrs={};var _iteratorNormalCompletion22=true;var _didIteratorError22=false;var _iteratorError22=undefined;try{var _loop=function _loop(){var repeatingItem=_step22.value;getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion23=true;var _didIteratorError23=false;var _iteratorError23=undefined;try{for(var _iterator23=ids[Symbol.iterator](),_step23;!(_iteratorNormalCompletion23=(_step23=_iterator23.next()).done);_iteratorNormalCompletion23=true){var id=_step23.value;var repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+'damage');collectionArray.push(repeatingString+'damage_crit');collectionArray.push(repeatingString+'second_damage');collectionArray.push(repeatingString+'second_damage_crit');}}catch(err){_didIteratorError23=true;_iteratorError23=err;}finally {try{if(!_iteratorNormalCompletion23&&_iterator23.return){_iterator23.return();}}finally {if(_didIteratorError23){throw _iteratorError23;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion24=true;var _didIteratorError24=false;var _iteratorError24=undefined;try{for(var _iterator24=ids[Symbol.iterator](),_step24;!(_iteratorNormalCompletion24=(_step24=_iterator24.next()).done);_iteratorNormalCompletion24=true){var id=_step24.value;var repeatingString=repeatingItem+'_'+id+'_';if(!v[repeatingString+'damage_crit']&&v[repeatingString+'damage']){finalSetAttrs[repeatingString+'damage_crit']=v[repeatingString+'damage'];}else if(v[repeatingString+'damage']&&v[repeatingString+'damage_crit']){finalSetAttrs[repeatingString+'damage_crit']=v[repeatingString+'damage']+' + '+v[repeatingString+'damage_crit'];}if(!v[repeatingString+'second_damage_crit']&&v[repeatingString+'second_damage']){finalSetAttrs[repeatingString+'second_damage_crit']=v[repeatingString+'second_damage'];}else if(v[repeatingString+'second_damage']&&v[repeatingString+'second_damage_crit']){finalSetAttrs[repeatingString+'second_damage_crit']=v[repeatingString+'second_damage']+' + '+v[repeatingString+'second_damage_crit'];}}}catch(err){_didIteratorError24=true;_iteratorError24=err;}finally {try{if(!_iteratorNormalCompletion24&&_iterator24.return){_iterator24.return();}}finally {if(_didIteratorError24){throw _iteratorError24;}}}setFinalAttrs(v,finalSetAttrs);});});};for(var _iterator22=repeatingItems[Symbol.iterator](),_step22;!(_iteratorNormalCompletion22=(_step22=_iterator22.next()).done);_iteratorNormalCompletion22=true){_loop();}}catch(err){_didIteratorError22=true;_iteratorError22=err;}finally {try{if(!_iteratorNormalCompletion22&&_iterator22.return){_iterator22.return();}}finally {if(_didIteratorError22){throw _iteratorError22;}}}};var setCritDamage=function setCritDamage(v,finalSetAttrs,repeatingString){if(!v[repeatingString+'damage_crit']&&v[repeatingString+'damage']){finalSetAttrs[repeatingString+'damage_crit']=v[repeatingString+'damage'];}if(!v[repeatingString+'second_damage_crit']&&v[repeatingString+'second_damage']){finalSetAttrs[repeatingString+'second_damage_crit']=v[repeatingString+'second_damage'];}};var findAmmo=function findAmmo(name,callback){var repeatingItem='repeating_ammo';var collectionArray=[];getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion25=true;var _didIteratorError25=false;var _iteratorError25=undefined;try{for(var _iterator25=ids[Symbol.iterator](),_step25;!(_iteratorNormalCompletion25=(_step25=_iterator25.next()).done);_iteratorNormalCompletion25=true){var id=_step25.value;var repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+'name');collectionArray.push(repeatingString+'qty');}}catch(err){_didIteratorError25=true;_iteratorError25=err;}finally {try{if(!_iteratorNormalCompletion25&&_iterator25.return){_iterator25.return();}}finally {if(_didIteratorError25){throw _iteratorError25;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion26=true;var _didIteratorError26=false;var _iteratorError26=undefined;try{for(var _iterator26=ids[Symbol.iterator](),_step26;!(_iteratorNormalCompletion26=(_step26=_iterator26.next()).done);_iteratorNormalCompletion26=true){var id=_step26.value;var repeatingString=repeatingItem+'_'+id+'_';if(v[repeatingString+'name']===name){callback('@{'+repeatingString+'qty}');}}}catch(err){_didIteratorError26=true;_iteratorError26=err;}finally {try{if(!_iteratorNormalCompletion26&&_iterator26.return){_iterator26.return();}}finally {if(_didIteratorError26){throw _iteratorError26;}}}console.warn('cannot find ammo field by the name '+name);});});};var updateActionChatMacro=function updateActionChatMacro(type){var repeatingItem='repeating_'+type;var collectionArray=[type+'s_macro_var',type+'s_chat_var',type+'s_exist'];var finalSetAttrs={};finalSetAttrs[type+'s_macro_var']='';finalSetAttrs[type+'s_chat_var']='';getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion27=true;var _didIteratorError27=false;var _iteratorError27=undefined;try{for(var _iterator27=ids[Symbol.iterator](),_step27;!(_iteratorNormalCompletion27=(_step27=_iterator27.next()).done);_iteratorNormalCompletion27=true){var id=_step27.value;var repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+'name');collectionArray.push(repeatingString+'freetext');}}catch(err){_didIteratorError27=true;_iteratorError27=err;}finally {try{if(!_iteratorNormalCompletion27&&_iterator27.return){_iterator27.return();}}finally {if(_didIteratorError27){throw _iteratorError27;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion28=true;var _didIteratorError28=false;var _iteratorError28=undefined;try{for(var _iterator28=ids[Symbol.iterator](),_step28;!(_iteratorNormalCompletion28=(_step28=_iterator28.next()).done);_iteratorNormalCompletion28=true){var id=_step28.value;var repeatingString=repeatingItem+'_'+id+'_';var actionName=v[repeatingString+'name'];var freeText=v[repeatingString+'freetext'];if(id!==ids[0]){finalSetAttrs[type+'s_macro_var']+=', ';}var actionType='action';var title=void 0;if(type==='trait'){title='Traits';actionType='trait';}else if(type==='action'){title='Actions';}else if(type==='reaction'){title='Reactions';}else if(type==='legendaryaction'){title='Legendary Actions';}else if(type==='lairaction'){title='Lair Actions';actionName=freeText;}else if(type==='regionaleffect'){title='Regional Effects';actionName=freeText;}if(actionName&&actionName.length>50){actionName=actionName.substring(0,50)+'...';}finalSetAttrs[type+'s_macro_var']+='['+actionName+'](~repeating_'+type+'_'+id+'_'+actionType+')';finalSetAttrs[type+'s_chat_var']+='{{'+title+'='+finalSetAttrs[type+'s_macro_var']+'}}';}}catch(err){_didIteratorError28=true;_iteratorError28=err;}finally {try{if(!_iteratorNormalCompletion28&&_iterator28.return){_iterator28.return();}}finally {if(_didIteratorError28){throw _iteratorError28;}}}setFinalAttrs(v,finalSetAttrs);});});};var updateAction=function updateAction(type,rowId){var repeatingItem='repeating_'+type;var collectionArray=['pb','strength_mod','finesse_mod','global_attack_bonus','global_melee_attack_bonus','global_ranged_attack_bonus','global_damage_bonus','global_melee_damage_bonus','global_ranged_damage_bonus','default_ability'];var finalSetAttrs={};var rechargeRegex=/\s*?\((?:Recharge\s*?(\d+\-\d+|\d+)|Recharges\safter\sa\s(.*))\)/gi;var rechargeDayRegex=/\s*?\((\d+\/Day)\)/gi;var _iteratorNormalCompletion29=true;var _didIteratorError29=false;var _iteratorError29=undefined;try{for(var _iterator29=ABILITIES[Symbol.iterator](),_step29;!(_iteratorNormalCompletion29=(_step29=_iterator29.next()).done);_iteratorNormalCompletion29=true){var ability=_step29.value;collectionArray.push(ability+'_mod');}}catch(err){_didIteratorError29=true;_iteratorError29=err;}finally {try{if(!_iteratorNormalCompletion29&&_iterator29.return){_iterator29.return();}}finally {if(_didIteratorError29){throw _iteratorError29;}}}getSectionIDs(repeatingItem,function(ids){if(rowId){ids=[];ids.push(rowId);}var _iteratorNormalCompletion30=true;var _didIteratorError30=false;var _iteratorError30=undefined;try{for(var _iterator30=ids[Symbol.iterator](),_step30;!(_iteratorNormalCompletion30=(_step30=_iterator30.next()).done);_iteratorNormalCompletion30=true){var id=_step30.value;var repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+'name');collectionArray.push(repeatingString+'type');collectionArray.push(repeatingString+'uses');collectionArray.push(repeatingString+'uses_max');collectionArray.push(repeatingString+'has_uses');collectionArray.push(repeatingString+'roll_toggle');collectionArray.push(repeatingString+'to_hit');collectionArray.push(repeatingString+'attack_formula');collectionArray.push(repeatingString+'proficiency');collectionArray.push(repeatingString+'attack_ability');collectionArray.push(repeatingString+'attack_bonus');collectionArray.push(repeatingString+'saving_throw_toggle');collectionArray.push(repeatingString+'saving_throw_ability');collectionArray.push(repeatingString+'saving_throw_bonus');collectionArray.push(repeatingString+'saving_throw_dc');collectionArray.push(repeatingString+'damage_toggle');collectionArray.push(repeatingString+'damage_formula');collectionArray.push(repeatingString+'damage');collectionArray.push(repeatingString+'damage_ability');collectionArray.push(repeatingString+'damage_bonus');collectionArray.push(repeatingString+'damage_type');collectionArray.push(repeatingString+'damage_crit');collectionArray.push(repeatingString+'second_damage_toggle');collectionArray.push(repeatingString+'second_damage_formula');collectionArray.push(repeatingString+'second_damage');collectionArray.push(repeatingString+'second_damage_ability');collectionArray.push(repeatingString+'second_damage_bonus');collectionArray.push(repeatingString+'second_damage_type');collectionArray.push(repeatingString+'second_damage_crit');collectionArray.push(repeatingString+'damage_string');collectionArray.push(repeatingString+'heal_toggle');collectionArray.push(repeatingString+'heal');collectionArray.push(repeatingString+'heal_ability');collectionArray.push(repeatingString+'heal_bonus');collectionArray.push(repeatingString+'heal_query_toggle');collectionArray.push(repeatingString+'parsed');collectionArray.push(repeatingString+'recharge');collectionArray.push(repeatingString+'recharge_display');collectionArray.push(repeatingString+'extras_toggle');collectionArray.push(repeatingString+'emote');collectionArray.push(repeatingString+'freetext');collectionArray.push(repeatingString+'freeform');}}catch(err){_didIteratorError30=true;_iteratorError30=err;}finally {try{if(!_iteratorNormalCompletion30&&_iterator30.return){_iterator30.return();}}finally {if(_didIteratorError30){throw _iteratorError30;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion31=true;var _didIteratorError31=false;var _iteratorError31=undefined;try{for(var _iterator31=ids[Symbol.iterator](),_step31;!(_iteratorNormalCompletion31=(_step31=_iterator31.next()).done);_iteratorNormalCompletion31=true){var id=_step31.value;var repeatingString=repeatingItem+'_'+id+'_';var actionName=v[repeatingString+'name'];if(!isUndefined(actionName)){var rechargeResult=rechargeRegex.exec(actionName);if(rechargeResult){finalSetAttrs[repeatingString+'recharge']=rechargeResult[1]||rechargeResult[2];finalSetAttrs[repeatingString+'name']=actionName.replace(rechargeRegex,'');}var rechargeDayResult=rechargeDayRegex.exec(actionName);if(rechargeDayResult){finalSetAttrs[repeatingString+'recharge']=rechargeDayResult[1]||rechargeDayResult[2];finalSetAttrs[repeatingString+'name']=actionName.replace(rechargeDayRegex,'');}}if(v[repeatingString+'uses']||v[repeatingString+'uses_max']){finalSetAttrs[repeatingString+'has_uses']=1;}else if(!isUndefined(v[repeatingString+'has_uses'])){finalSetAttrs[repeatingString+'has_uses']=0;}var recharge=fromVOrFinalSetAttrs(v,finalSetAttrs,repeatingString+'recharge');if(exists(recharge)){if(isNaN(recharge)){finalSetAttrs[repeatingString+'recharge_display']=' ('+recharge+')';}else {finalSetAttrs[repeatingString+'recharge_display']=' (Recharge '+recharge+')';}}else if(exists(v[repeatingString+'recharge_display'])){finalSetAttrs[repeatingString+'recharge_display']='';}var attackOptions={};if(type!=='trait'){attackOptions={defaultAbility:'strength',globalAttackBonus:v.global_attack_bonus,globalAttackBonusLabel:'global attack bonus',globalMeleeAttackBonus:v.global_melee_attack_bonus,globalRangedAttackBonus:v.global_ranged_attack_bonus,type:'attack'};}updateAttackToggle(v,finalSetAttrs,repeatingString,attackOptions);updateSavingThrowToggle(v,finalSetAttrs,repeatingString);var damageOptions={};if(type!=='trait'){damageOptions={defaultDamageAbility:'strength',globalDamageBonus:v.global_damage_bonus,globalMeleeDamageBonus:v.global_melee_damage_bonus,globalRangedDamageBonus:v.global_ranged_damage_bonus,type:'attack'};}updateDamageToggle(v,finalSetAttrs,repeatingString,damageOptions);if(v.damage_type){finalSetAttrs.damage_type=lowercaseDamageTypes(v.damage_type);}if(v.second_damage_type){finalSetAttrs.second_damage_type=lowercaseDamageTypes(v.second_damage_type);}setCritDamage(v,finalSetAttrs,repeatingString);updateHealToggle(v,finalSetAttrs,repeatingString);if(isUndefined(v[repeatingString+'extras_toggle'])&&(v[repeatingString+'emote']||v[repeatingString+'freetext']||v[repeatingString+'freeform'])){finalSetAttrs[repeatingString+'extras_toggle']=toggleVars.extras;}}}catch(err){_didIteratorError31=true;_iteratorError31=err;}finally {try{if(!_iteratorNormalCompletion31&&_iterator31.return){_iterator31.return();}}finally {if(_didIteratorError31){throw _iteratorError31;}}}setFinalAttrs(v,finalSetAttrs);});});};var updateActions=function updateActions(){updateAction('trait');updateAction('action');updateAction('reaction');updateAction('legendaryaction');updateAction('lairaction');updateAction('regionaleffect');};var updateActionIfTriggered=function updateActionIfTriggered(type,eventInfo){var repeatingInfo=getRepeatingInfo('repeating_'+type,eventInfo);if(repeatingInfo&&repeatingInfo.field!=='name'&&repeatingInfo.field!=='freetext'&&repeatingInfo.field!=='to_hit'&&repeatingInfo.field!=='attack_formula'&&repeatingInfo.field!=='damage_formula'&&repeatingInfo.field!=='damage_crit'&&repeatingInfo.field!=='second_damage_formula'&&repeatingInfo.field!=='second_damage_crit'&&repeatingInfo.field!=='damage_string'&&repeatingInfo.field!=='saving_throw_dc'&&repeatingInfo.field!=='parsed'&&repeatingInfo.field!=='recharge_display'){updateAction(type,repeatingInfo.rowId);}};on('change:repeating_trait',function(eventInfo){updateActionIfTriggered('trait',eventInfo);});on('change:repeating_action',function(eventInfo){updateActionIfTriggered('action',eventInfo);});on('change:repeating_reaction',function(eventInfo){updateActionIfTriggered('reaction',eventInfo);});on('change:repeating_legendaryaction',function(eventInfo){updateActionIfTriggered('legendaryaction',eventInfo);});on('change:repeating_lairaction',function(eventInfo){updateActionIfTriggered('lairaction',eventInfo);});on('change:repeating_regionaleffect',function(eventInfo){updateActionIfTriggered('regionaleffect',eventInfo);});var updateAttack=function updateAttack(rowId){var repeatingItem='repeating_attack';var collectionArray=['pb','strength_mod','finesse_mod','global_attack_bonus','global_melee_attack_bonus','global_ranged_attack_bonus','global_damage_bonus','global_melee_damage_bonus','global_ranged_damage_bonus','default_ability','ammo_auto_use'];var finalSetAttrs={};var _iteratorNormalCompletion32=true;var _didIteratorError32=false;var _iteratorError32=undefined;try{for(var _iterator32=ABILITIES[Symbol.iterator](),_step32;!(_iteratorNormalCompletion32=(_step32=_iterator32.next()).done);_iteratorNormalCompletion32=true){var ability=_step32.value;collectionArray.push(ability+'_mod');}}catch(err){_didIteratorError32=true;_iteratorError32=err;}finally {try{if(!_iteratorNormalCompletion32&&_iterator32.return){_iterator32.return();}}finally {if(_didIteratorError32){throw _iteratorError32;}}}getSectionIDs(repeatingItem,function(ids){if(rowId){ids=[];ids.push(rowId);}var _iteratorNormalCompletion33=true;var _didIteratorError33=false;var _iteratorError33=undefined;try{for(var _iterator33=ids[Symbol.iterator](),_step33;!(_iteratorNormalCompletion33=(_step33=_iterator33.next()).done);_iteratorNormalCompletion33=true){var id=_step33.value;var _repeatingString2=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString2+'name');collectionArray.push(_repeatingString2+'type');collectionArray.push(_repeatingString2+'roll_toggle');collectionArray.push(_repeatingString2+'to_hit');collectionArray.push(_repeatingString2+'attack_formula');collectionArray.push(_repeatingString2+'proficiency');collectionArray.push(_repeatingString2+'attack_ability');collectionArray.push(_repeatingString2+'attack_bonus');collectionArray.push(_repeatingString2+'ammo_toggle_var');collectionArray.push(_repeatingString2+'ammo_field_name');collectionArray.push(_repeatingString2+'ammo_used');collectionArray.push(_repeatingString2+'saving_throw_toggle');collectionArray.push(_repeatingString2+'saving_throw_ability');collectionArray.push(_repeatingString2+'saving_throw_bonus');collectionArray.push(_repeatingString2+'saving_throw_dc');collectionArray.push(_repeatingString2+'damage_toggle');collectionArray.push(_repeatingString2+'damage_formula');collectionArray.push(_repeatingString2+'damage');collectionArray.push(_repeatingString2+'damage_ability');collectionArray.push(_repeatingString2+'damage_bonus');collectionArray.push(_repeatingString2+'damage_type');collectionArray.push(_repeatingString2+'damage_crit');collectionArray.push(_repeatingString2+'second_damage_toggle');collectionArray.push(_repeatingString2+'second_damage_formula');collectionArray.push(_repeatingString2+'second_damage');collectionArray.push(_repeatingString2+'second_damage_ability');collectionArray.push(_repeatingString2+'second_damage_bonus');collectionArray.push(_repeatingString2+'second_damage_type');collectionArray.push(_repeatingString2+'second_damage_crit');collectionArray.push(_repeatingString2+'damage_string');collectionArray.push(_repeatingString2+'modifiers');collectionArray.push(_repeatingString2+'properties');collectionArray.push(_repeatingString2+'weight');collectionArray.push(_repeatingString2+'parsed');}}catch(err){_didIteratorError33=true;_iteratorError33=err;}finally {try{if(!_iteratorNormalCompletion33&&_iterator33.return){_iterator33.return();}}finally {if(_didIteratorError33){throw _iteratorError33;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion34=true;var _didIteratorError34=false;var _iteratorError34=undefined;try{var _loop2=function _loop2(){var id=_step34.value;var repeatingString=repeatingItem+'_'+id+'_';var attackName=v[repeatingString+'name'];if(isUndefined(attackName)){return {v:void 0};}if(isUndefined(v[repeatingString+'parsed'])||v[repeatingString+'parsed'].indexOf('modifiers')===-1){var attackModifiers=v[repeatingString+'modifiers'];if(exists(attackModifiers)){var attackBonus=attackModifiers.replace(/.*(?:Melee|Ranged) Attacks \+(\d+).*/gi,'$1');var damageBonus=attackModifiers.replace(/.*(?:Melee|Ranged) Damage \+(\d+).*/gi,'$1');finalSetAttrs[repeatingString+'attack_bonus']=attackBonus;finalSetAttrs[repeatingString+'damage_bonus']=damageBonus;if(!finalSetAttrs[repeatingString+'parsed']){finalSetAttrs[repeatingString+'parsed']='';}finalSetAttrs[repeatingString+'parsed']+=' modifiers';}}if(isUndefined(v[repeatingString+'parsed'])||v[repeatingString+'parsed'].indexOf('attackProperties')===-1){var attackProperties=v[repeatingString+'properties'];if(exists(attackProperties)){if(attackProperties.indexOf('Reach')!==-1){finalSetAttrs[repeatingString+'reach']='10 ft';}else if(v[repeatingString+'type']==='Melee Weapon'){finalSetAttrs[repeatingString+'reach']='5 ft';}if(attackProperties.indexOf('Finesse')!==-1){finalSetAttrs[repeatingString+'attack_ability']='finesse';finalSetAttrs[repeatingString+'damage_ability']='finesse';}if(!finalSetAttrs[repeatingString+'parsed']){finalSetAttrs[repeatingString+'parsed']='';}finalSetAttrs[repeatingString+'parsed']+=' attackProperties';}}var attackOptions={defaultAbility:'strength',globalAttackBonus:v.global_attack_bonus,globalAttackBonusLabel:'global attack bonus',globalMeleeAttackBonus:v.global_melee_attack_bonus,globalRangedAttackBonus:v.global_ranged_attack_bonus,type:'attack'};updateAttackToggle(v,finalSetAttrs,repeatingString,attackOptions);var ammoName=v[repeatingString+'ammo_field_name'];var ammoUsed=getIntValue(v[repeatingString+'ammo_used'],1);if(!isUndefined(ammoName)){(function(){var ammoAutoUse=void 0;if(v.ammo_auto_use==='1'){ammoAutoUse=1;}else {ammoAutoUse=0;}findAmmo(ammoName,function(ammoQtyName){var setAmmo={};setAmmo[repeatingString+'ammo_toggle_var']='{{ammo=[['+ammoQtyName+'-'+ammoAutoUse*ammoUsed+']]}} {{ammo_name='+ammoName+'}}';setFinalAttrs(v,setAmmo);});})();}updateSavingThrowToggle(v,finalSetAttrs,repeatingString);var damageOptions={defaultDamageAbility:'strength',globalDamageBonus:v.global_damage_bonus,globalMeleeDamageBonus:v.global_melee_damage_bonus,globalRangedDamageBonus:v.global_ranged_damage_bonus,type:'attack'};updateDamageToggle(v,finalSetAttrs,repeatingString,damageOptions);if(v.damage_type){finalSetAttrs.damage_type=lowercaseDamageTypes(v.damage_type);}if(v.second_damage_type){finalSetAttrs.second_damage_type=lowercaseDamageTypes(v.second_damage_type);}setCritDamage(v,finalSetAttrs,repeatingString);};for(var _iterator34=ids[Symbol.iterator](),_step34;!(_iteratorNormalCompletion34=(_step34=_iterator34.next()).done);_iteratorNormalCompletion34=true){var _ret2=_loop2();if((typeof _ret2==='undefined'?'undefined':_typeof(_ret2))==="object")return _ret2.v;}}catch(err){_didIteratorError34=true;_iteratorError34=err;}finally {try{if(!_iteratorNormalCompletion34&&_iterator34.return){_iterator34.return();}}finally {if(_didIteratorError34){throw _iteratorError34;}}}setFinalAttrs(v,finalSetAttrs);});});};on('change:repeating_attack',function(eventInfo){var repeatingInfo=getRepeatingInfo('repeating_attack',eventInfo);if(repeatingInfo&&repeatingInfo.field!=='toggle_details'&&repeatingInfo.field!=='to_hit'&&repeatingInfo.field!=='attack_formula'&&repeatingInfo.field!=='damage_formula'&&repeatingInfo.field!=='damage_crit'&&repeatingInfo.field!=='second_damage_formula'&&repeatingInfo.field!=='second_damage_crit'&&repeatingInfo.field!=='damage_string'&&repeatingInfo.field!=='saving_throw_dc'&&repeatingInfo.field!=='qty'&&repeatingInfo.field!=='weight'&&repeatingInfo.field!=='parsed'){updateAttack(repeatingInfo.row);}});var weighAttacks=function weighAttacks(){var options={collection:'attack',toggle:'carried',qty:'qty'};var sumItems=[{fieldToAdd:'weight',itemTotal:'weight_total',totalField:'weight_attacks'}];sumRepeating(options,sumItems);};var updateAttackChatMacro=function updateAttackChatMacro(){var repeatingItem='repeating_attack';var collectionArray=['attacks_macro_var'];var finalSetAttrs={};finalSetAttrs.attacks_macro_var='';getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion35=true;var _didIteratorError35=false;var _iteratorError35=undefined;try{for(var _iterator35=ids[Symbol.iterator](),_step35;!(_iteratorNormalCompletion35=(_step35=_iterator35.next()).done);_iteratorNormalCompletion35=true){var id=_step35.value;var _repeatingString4=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString4+'name');}}catch(err){_didIteratorError35=true;_iteratorError35=err;}finally {try{if(!_iteratorNormalCompletion35&&_iterator35.return){_iterator35.return();}}finally {if(_didIteratorError35){throw _iteratorError35;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion36=true;var _didIteratorError36=false;var _iteratorError36=undefined;try{for(var _iterator36=ids[Symbol.iterator](),_step36;!(_iteratorNormalCompletion36=(_step36=_iterator36.next()).done);_iteratorNormalCompletion36=true){var id=_step36.value;var _repeatingString3=repeatingItem+'_'+id+'_';var actionName=v[_repeatingString3+'name'];if(actionName&&actionName.length>50){actionName=actionName.substring(0,50)+'...';}if(id!==ids[0]){finalSetAttrs.attacks_macro_var+=', ';}finalSetAttrs.attacks_macro_var+='['+actionName+'](~repeating_attack_'+id+'_attack)';}}catch(err){_didIteratorError36=true;_iteratorError36=err;}finally {try{if(!_iteratorNormalCompletion36&&_iterator36.return){_iterator36.return();}}finally {if(_didIteratorError36){throw _iteratorError36;}}}setFinalAttrs(v,finalSetAttrs);});});};on('change:repeating_attack remove:repeating_attack',function(){updateAttackChatMacro();});on('change:repeating_attack:carried change:repeating_attack:qty change:repeating_attack:weight remove:repeating_attack',function(){weighAttacks();});on('change:global_attack_bonus change:global_melee_attack_bonus change:global_ranged_attack_bonus change:global_damage_bonus change:global_melee_damage_bonus change:global_ranged_damage_bonus change:ammo_auto_use',function(){updateAttack();updateAction('action');updateAction('reaction');updateAction('legendaryaction');updateAction('lairaction');});var updateSpell=function updateSpell(rowId){var repeatingItem='repeating_spell';var collectionArray=['is_npc','pb','finesse_mod','global_spell_attack_bonus','global_spell_damage_bonus','global_spell_dc_bonus','global_spell_heal_bonus','default_ability','caster_level'];var finalSetAttrs={};var _iteratorNormalCompletion37=true;var _didIteratorError37=false;var _iteratorError37=undefined;try{for(var _iterator37=ABILITIES[Symbol.iterator](),_step37;!(_iteratorNormalCompletion37=(_step37=_iterator37.next()).done);_iteratorNormalCompletion37=true){var ability=_step37.value;collectionArray.push(ability+'_mod');}}catch(err){_didIteratorError37=true;_iteratorError37=err;}finally {try{if(!_iteratorNormalCompletion37&&_iterator37.return){_iterator37.return();}}finally {if(_didIteratorError37){throw _iteratorError37;}}}getSectionIDs(repeatingItem,function(ids){if(rowId){ids=[];ids.push(rowId);}var _iteratorNormalCompletion38=true;var _didIteratorError38=false;var _iteratorError38=undefined;try{for(var _iterator38=ids[Symbol.iterator](),_step38;!(_iteratorNormalCompletion38=(_step38=_iterator38.next()).done);_iteratorNormalCompletion38=true){var id=_step38.value;var _repeatingString6=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString6+'name');collectionArray.push(_repeatingString6+'type');collectionArray.push(_repeatingString6+'roll_toggle');collectionArray.push(_repeatingString6+'to_hit');collectionArray.push(_repeatingString6+'attack_formula');collectionArray.push(_repeatingString6+'proficiency');collectionArray.push(_repeatingString6+'attack_ability');collectionArray.push(_repeatingString6+'attack_bonus');collectionArray.push(_repeatingString6+'saving_throw_toggle');collectionArray.push(_repeatingString6+'saving_throw_ability');collectionArray.push(_repeatingString6+'saving_throw_vs_ability');collectionArray.push(_repeatingString6+'saving_throw_bonus');collectionArray.push(_repeatingString6+'saving_throw_dc');collectionArray.push(_repeatingString6+'damage_toggle');collectionArray.push(_repeatingString6+'damage_formula');collectionArray.push(_repeatingString6+'damage');collectionArray.push(_repeatingString6+'damage_ability');collectionArray.push(_repeatingString6+'damage_bonus');collectionArray.push(_repeatingString6+'damage_type');collectionArray.push(_repeatingString6+'damage_crit');collectionArray.push(_repeatingString6+'second_damage_toggle');collectionArray.push(_repeatingString6+'second_damage_formula');collectionArray.push(_repeatingString6+'second_damage');collectionArray.push(_repeatingString6+'second_damage_ability');collectionArray.push(_repeatingString6+'second_damage_bonus');collectionArray.push(_repeatingString6+'second_damage_type');collectionArray.push(_repeatingString6+'second_damage_crit');collectionArray.push(_repeatingString6+'damage_string');collectionArray.push(_repeatingString6+'parsed');collectionArray.push(_repeatingString6+'spell_level');collectionArray.push(_repeatingString6+'casting_time');collectionArray.push(_repeatingString6+'components');collectionArray.push(_repeatingString6+'heal_toggle');collectionArray.push(_repeatingString6+'heal');collectionArray.push(_repeatingString6+'heal_ability');collectionArray.push(_repeatingString6+'heal_bonus');collectionArray.push(_repeatingString6+'heal_query_toggle');collectionArray.push(_repeatingString6+'add_casting_modifier');collectionArray.push(_repeatingString6+'higher_level_toggle');collectionArray.push(_repeatingString6+'higher_level_dice');collectionArray.push(_repeatingString6+'higher_level_die');collectionArray.push(_repeatingString6+'second_higher_level_dice');collectionArray.push(_repeatingString6+'second_higher_level_die');collectionArray.push(_repeatingString6+'higher_level_heal');collectionArray.push(_repeatingString6+'components_verbal');collectionArray.push(_repeatingString6+'components_somatic');collectionArray.push(_repeatingString6+'components_material');collectionArray.push(_repeatingString6+'duration');collectionArray.push(_repeatingString6+'concentration');collectionArray.push(_repeatingString6+'concentration_text');collectionArray.push(_repeatingString6+'ritual');collectionArray.push(_repeatingString6+'ritual_output');collectionArray.push(_repeatingString6+'ritual_show');collectionArray.push(_repeatingString6+'materials');collectionArray.push(_repeatingString6+'materials_show');collectionArray.push(_repeatingString6+'extras_toggle');collectionArray.push(_repeatingString6+'emote');collectionArray.push(_repeatingString6+'freetext');collectionArray.push(_repeatingString6+'freeform');}}catch(err){_didIteratorError38=true;_iteratorError38=err;}finally {try{if(!_iteratorNormalCompletion38&&_iterator38.return){_iterator38.return();}}finally {if(_didIteratorError38){throw _iteratorError38;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion39=true;var _didIteratorError39=false;var _iteratorError39=undefined;try{for(var _iterator39=ids[Symbol.iterator](),_step39;!(_iteratorNormalCompletion39=(_step39=_iterator39.next()).done);_iteratorNormalCompletion39=true){var id=_step39.value;var _repeatingString5=repeatingItem+'_'+id+'_';var spellLevel=getIntValue(v[_repeatingString5+'spell_level']);if(spellLevel===0){finalSetAttrs[_repeatingString5+'spell_level']=spellLevel;finalSetAttrs[_repeatingString5+'is_prepared']='on';}finalSetAttrs[_repeatingString5+'friendly_level']=ordinalSpellLevel(spellLevel);var concentration=v[_repeatingString5+'concentration'];if(concentration==='Yes'){finalSetAttrs[_repeatingString5+'concentration_show']=1;finalSetAttrs[_repeatingString5+'concentration_text']='Concentration, ';}else if(!isUndefined(v[_repeatingString5+'concentration_text'])){finalSetAttrs[_repeatingString5+'concentration_text']='';finalSetAttrs[_repeatingString5+'concentration_show']=0;}if(v.duration){finalSetAttrs.duration=v.duration.toLowerCase();}var ritual=v[_repeatingString5+'ritual'];if(ritual==='Yes'){finalSetAttrs[_repeatingString5+'ritual_show']=1;finalSetAttrs[_repeatingString5+'ritual_output']='?{Cast as|Ritual,{{ritual=1&#125;&#125;|Spell,}';}else {if(!isUndefined(v[_repeatingString5+'ritual_show'])){finalSetAttrs[_repeatingString5+'ritual_show']=0;}if(!isUndefined(v[_repeatingString5+'ritual_output'])){finalSetAttrs[_repeatingString5+'ritual_output']='';}}var materials=v[_repeatingString5+'materials'];if(!isUndefined(materials)&&materials!==''){finalSetAttrs[_repeatingString5+'materials_show']=1;}else if(!isUndefined(v[_repeatingString5+'materials_show'])){finalSetAttrs[_repeatingString5+'materials_show']=0;}var spellComponents=v[_repeatingString5+'components'];finalSetAttrs[_repeatingString5+'components_verbal']=0;finalSetAttrs[_repeatingString5+'components_somatic']=0;finalSetAttrs[_repeatingString5+'components_material']=0;if(exists(spellComponents)){if(spellComponents.indexOf('V')!==-1){finalSetAttrs[_repeatingString5+'components_verbal']=1;}if(spellComponents.indexOf('S')!==-1){finalSetAttrs[_repeatingString5+'components_somatic']=1;}if(spellComponents.indexOf('M')!==-1){finalSetAttrs[_repeatingString5+'components_material']=1;}}var attackOptions={attackAbility:true,globalAttackBonus:v.global_spell_attack_bonus,type:'spell'};updateAttackToggle(v,finalSetAttrs,_repeatingString5,attackOptions);var savingThrowOptions={bonusDC:v.global_spell_dc_bonus};updateSavingThrowToggle(v,finalSetAttrs,_repeatingString5,savingThrowOptions);var damageOptions={globalDamageBonus:v.global_spell_damage_bonus,type:'spell'};updateDamageToggle(v,finalSetAttrs,_repeatingString5,damageOptions);if(v.damage_type){finalSetAttrs.damage_type=lowercaseDamageTypes(v.damage_type);}if(v.second_damage_type){finalSetAttrs.second_damage_type=lowercaseDamageTypes(v.second_damage_type);}setCritDamage(v,finalSetAttrs,_repeatingString5);if(getIntValue(v.is_npc)===1&&v.caster_level&&v[_repeatingString5+'damage']&&v[_repeatingString5+'damage'].indexOf('@{level}')!==-1){finalSetAttrs[_repeatingString5+'damage']=v[_repeatingString5+'damage'].replace('@{level}','@{caster_level}');}updateHealToggle(v,finalSetAttrs,_repeatingString5);updateHigherLevelToggle(v,finalSetAttrs,_repeatingString5);if(isUndefined(v[_repeatingString5+'extras_toggle'])&&(v[_repeatingString5+'emote']||v[_repeatingString5+'freetext']||v[_repeatingString5+'freeform'])){finalSetAttrs[_repeatingString5+'extras_toggle']=toggleVars.extras;}}}catch(err){_didIteratorError39=true;_iteratorError39=err;}finally {try{if(!_iteratorNormalCompletion39&&_iterator39.return){_iterator39.return();}}finally {if(_didIteratorError39){throw _iteratorError39;}}}setFinalAttrs(v,finalSetAttrs);});});};on('change:repeating_spell',function(eventInfo){var repeatingInfo=getRepeatingInfo('repeating_spell',eventInfo);if(repeatingInfo&&repeatingInfo.field!=='toggle_details'&&repeatingInfo.field!=='to_hit'&&repeatingInfo.field!=='attack_formula'&&repeatingInfo.field!=='damage_formula'&&repeatingInfo.field!=='damage_crit'&&repeatingInfo.field!=='second_damage_formula'&&repeatingInfo.field!=='second_damage_crit'&&repeatingInfo.field!=='damage_string'&&repeatingInfo.field!=='saving_throw_dc'&&repeatingInfo.field!=='heal_formula'&&repeatingInfo.field!=='higher_level_query'&&repeatingInfo.field!=='parsed'){console.info('spell repeatingInfo.field',repeatingInfo.field);updateSpell(repeatingInfo.rowId);}});on('change:global_spell_attack_bonus change:global_spell_damage_bonus change:global_spell_dc_bonus change:global_spell_heal_bonus',function(){updateSpell();});var updateSpellChatMacro=function updateSpellChatMacro(){var repeatingItem='repeating_spell';var collectionArray=['spells_show_unprepared'];var finalSetAttrs={};var spells={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[]};for(var i=0;i<=9;i++){collectionArray.push('spells_level_'+0+'_macro_var');}getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion40=true;var _didIteratorError40=false;var _iteratorError40=undefined;try{for(var _iterator40=ids[Symbol.iterator](),_step40;!(_iteratorNormalCompletion40=(_step40=_iterator40.next()).done);_iteratorNormalCompletion40=true){var id=_step40.value;var _repeatingString8=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString8+'name');collectionArray.push(_repeatingString8+'spell_level');collectionArray.push(_repeatingString8+'is_prepared');}}catch(err){_didIteratorError40=true;_iteratorError40=err;}finally {try{if(!_iteratorNormalCompletion40&&_iterator40.return){_iterator40.return();}}finally {if(_didIteratorError40){throw _iteratorError40;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion41=true;var _didIteratorError41=false;var _iteratorError41=undefined;try{for(var _iterator41=ids[Symbol.iterator](),_step41;!(_iteratorNormalCompletion41=(_step41=_iterator41.next()).done);_iteratorNormalCompletion41=true){var id=_step41.value;var _repeatingString7=repeatingItem+'_'+id+'_';var showUnprepared=v.spells_show_unprepared==='on'||isUndefined(v.spells_show_unprepared);var spellName=v[_repeatingString7+'name'];var spellLevel=getIntValue(v[_repeatingString7+'spell_level'],0);var spellPrepared=v[_repeatingString7+'is_prepared']==='on';if(spellName&&spellPrepared){spells[spellLevel].push('['+spellName+'](~repeating_spell_'+id+'_spell)');}else if(spellName&&showUnprepared){spells[spellLevel].push('<span class="sheet-unprepared">['+spellName+'](~repeating_spell_'+id+'_spell)</span>');}}}catch(err){_didIteratorError41=true;_iteratorError41=err;}finally {try{if(!_iteratorNormalCompletion41&&_iterator41.return){_iterator41.return();}}finally {if(_didIteratorError41){throw _iteratorError41;}}}for(var _i=0;_i<=9;_i++){if(spells[_i].length>0){finalSetAttrs['spells_level_'+_i+'_macro_var']=spells[_i].join(', ');}else {finalSetAttrs['spells_level_'+_i+'_macro_var']='';}}setFinalAttrs(v,finalSetAttrs);});});};on('change:repeating_spell',function(eventInfo){var repeatingInfo=getRepeatingInfo('repeating_spell',eventInfo);if(repeatingInfo&&(repeatingInfo.field==='name'||repeatingInfo.field==='spell_level'||repeatingInfo.field==='is_prepared')){updateSpellChatMacro();}});on('change:spells_show_unprepared',function(){updateSpellChatMacro();});on('remove:repeating_spell',function(){updateSpellChatMacro();});var updateSpellChatMacroShow=function updateSpellChatMacroShow(){var collectionArray=['spells_show_spell_level_if_all_slots_are_used'];var finalSetAttrs={};for(var i=0;i<=9;i++){collectionArray.push('spell_slots_l'+i);collectionArray.push('spells_level_'+i+'_macro_var');collectionArray.push('spells_level_'+i+'_show');}getAttrs(collectionArray,function(v){var showLevelIfAllSlotsAreUsed=v.spells_show_spell_level_if_all_slots_are_used==='on'||isUndefined(v.spells_show_spell_level_if_all_slots_are_used);for(var _i2=0;_i2<=9;_i2++){if(!showLevelIfAllSlotsAreUsed&&!getIntValue(v['spell_slots_l'+_i2])||!v['spells_level_'+_i2+'_macro_var']){finalSetAttrs['spells_level_'+_i2+'_show']='';}else {finalSetAttrs['spells_level_'+_i2+'_show']=true;}}setFinalAttrs(v,finalSetAttrs);});};var watchForSpellChanges=function watchForSpellChanges(){var spellsWatch=['change:spells_show_spell_level_if_all_slots_are_used'];for(var i=0;i<=9;i++){spellsWatch.push('change:spells_level_'+i+'_macro_var');spellsWatch.push('change:spell_slots_l'+i);}on(spellsWatch.join(' '),function(){updateSpellChatMacroShow();});};watchForSpellChanges();var generateHigherLevelQueries=function generateHigherLevelQueries(){var collectionArray=['warlock_level','number_of_classes'];var finalSetAttrs={};for(var i=1;i<=8;i++){collectionArray.push('higher_level_query_'+i);}for(var _i3=1;_i3<=9;_i3++){collectionArray.push('spell_slots_l'+_i3);}getAttrs(collectionArray,function(v){for(var _i4=1;_i4<=8;_i4++){var levelQuery='';if(_i4<6&&v.number_of_classes===1&&v.warlock_level>0&&Math.ceil(getIntValue(v.warlock_level)/2)>=_i4){var spellLevel=1;if(v.warlock_level>=9){spellLevel=5;}else if(v.warlock_level>=7){spellLevel=4;}else if(v.warlock_level>=5){spellLevel=3;}else if(v.warlock_level>=3){spellLevel=2;}levelQuery+='|'+spellLevel;}else {for(var j=_i4;j<=9;j++){if(getIntValue(v['spell_slots_l'+j])){levelQuery+='|'+j;}}}if(levelQuery!==''){finalSetAttrs['higher_level_query_'+_i4]='?{Spell Level'+levelQuery+'}';}else {finalSetAttrs['higher_level_query_'+_i4]=_i4;}}setFinalAttrs(v,finalSetAttrs);});};on('change:warlock_level change:spell_slots_l1 change:spell_slots_l2 change:spell_slots_l3 change:spell_slots_l4 change:spell_slots_l5 change:spell_slots_l6 change:spell_slots_l7 change:spell_slots_l8 change:spell_slots_l9',function(){generateHigherLevelQueries();});function updateD20Mod(){var collectionArray=['halfling_luck'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(v.halfling_luck==='on'){finalSetAttrs.d20_mod='ro<1';}else {finalSetAttrs.d20_mod='';}setFinalAttrs(v,finalSetAttrs);});}on('change:halfling_luck',function(){updateD20Mod();});var updateAbilityChecksMacro=function updateAbilityChecksMacro(){var repeatingItem='repeating_skill';var collectionArray=['ability_checks_query_var','ability_checks_macro_var','ability_checks_show_totals'];var finalSetAttrs={};finalSetAttrs.ability_checks_query_var='?{Ability Check';finalSetAttrs.ability_checks_macro_var='';finalSetAttrs.skills_macro_var='';var _iteratorNormalCompletion42=true;var _didIteratorError42=false;var _iteratorError42=undefined;try{for(var _iterator42=ABILITIES[Symbol.iterator](),_step42;!(_iteratorNormalCompletion42=(_step42=_iterator42.next()).done);_iteratorNormalCompletion42=true){var ability=_step42.value;collectionArray.push(ability+'_check_mod');collectionArray.push(ability+'_check_mod_with_sign');}}catch(err){_didIteratorError42=true;_iteratorError42=err;}finally {try{if(!_iteratorNormalCompletion42&&_iterator42.return){_iterator42.return();}}finally {if(_didIteratorError42){throw _iteratorError42;}}}getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion43=true;var _didIteratorError43=false;var _iteratorError43=undefined;try{for(var _iterator43=ids[Symbol.iterator](),_step43;!(_iteratorNormalCompletion43=(_step43=_iterator43.next()).done);_iteratorNormalCompletion43=true){var id=_step43.value;var _repeatingString10=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString10+'name');collectionArray.push(_repeatingString10+'ability');collectionArray.push(_repeatingString10+'total_with_sign');}}catch(err){_didIteratorError43=true;_iteratorError43=err;}finally {try{if(!_iteratorNormalCompletion43&&_iterator43.return){_iterator43.return();}}finally {if(_didIteratorError43){throw _iteratorError43;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion44=true;var _didIteratorError44=false;var _iteratorError44=undefined;try{for(var _iterator44=ABILITIES[Symbol.iterator](),_step44;!(_iteratorNormalCompletion44=(_step44=_iterator44.next()).done);_iteratorNormalCompletion44=true){var ability=_step44.value;if(!v[ability+'_check_mod_with_sign']){console.warn('rerun until the fields are set');updateAbilityModifiers();updateAbilityChecksMacro();}finalSetAttrs.ability_checks_query_var+='|'+capitalize(ability)+',{{title='+capitalize(ability)+'&#125;&#125; {{roll1=[[@{shaped_d20} + '+v[ability+'_check_mod']+']]&#125;&#125; @{roll_setting} + '+v[ability+'_check_mod']+']]&#125;&#125;';if(v.ability_checks_show_totals==='on'){finalSetAttrs.ability_checks_macro_var+='['+capitalize(ability)+' '+v[ability+'_check_mod_with_sign']+'](~shaped_'+ability+'_check)';}else {finalSetAttrs.ability_checks_macro_var+='['+capitalize(ability)+'](~shaped_'+ability+'_check)';}finalSetAttrs.ability_checks_macro_var+=', ';}}catch(err){_didIteratorError44=true;_iteratorError44=err;}finally {try{if(!_iteratorNormalCompletion44&&_iterator44.return){_iterator44.return();}}finally {if(_didIteratorError44){throw _iteratorError44;}}}var _iteratorNormalCompletion45=true;var _didIteratorError45=false;var _iteratorError45=undefined;try{for(var _iterator45=ids[Symbol.iterator](),_step45;!(_iteratorNormalCompletion45=(_step45=_iterator45.next()).done);_iteratorNormalCompletion45=true){var id=_step45.value;var _repeatingString9=repeatingItem+'_'+id+'_';finalSetAttrs.ability_checks_query_var+='|'+v[_repeatingString9+'name']+', {{title='+v[_repeatingString9+'name']+' ('+capitalize(getAbilityShortName(v[_repeatingString9+'ability']))+')&#125;&#125; {{roll1=[[@{shaped_d20} + @{'+_repeatingString9+'formula}]]&#125;&#125; @{roll_setting} + @{'+_repeatingString9+'formula}]]&#125;&#125;';if(id!==ids[0]){finalSetAttrs.ability_checks_macro_var+=', ';finalSetAttrs.skills_macro_var+=', ';}var skillButton=void 0;if(v.ability_checks_show_totals==='on'){skillButton='['+v[_repeatingString9+'name']+' '+v[_repeatingString9+'total_with_sign']+'](~repeating_skill_'+id+'_skill)';}else {skillButton='['+v[_repeatingString9+'name']+'](~repeating_skill_'+id+'_skill)';}finalSetAttrs.ability_checks_macro_var+=skillButton;finalSetAttrs.skills_macro_var+=skillButton;}}catch(err){_didIteratorError45=true;_iteratorError45=err;}finally {try{if(!_iteratorNormalCompletion45&&_iterator45.return){_iterator45.return();}}finally {if(_didIteratorError45){throw _iteratorError45;}}}finalSetAttrs.ability_checks_query_var+='}';setFinalAttrs(v,finalSetAttrs);});});};var updateShapedD20=function updateShapedD20(){var collectionArray=['roll_setting','roll_info','shaped_d20'];var finalSetAttrs={};getAttrs(collectionArray,function(v){finalSetAttrs.roll_info='';finalSetAttrs.shaped_d20='d20';if(v.roll_setting==='adv {{ignore=[[0'){finalSetAttrs.roll_info='{{advantage=1}}';finalSetAttrs.shaped_d20='2d20@{d20_mod}kh1';}else if(v.roll_setting==='dis {{ignore=[[0'){finalSetAttrs.roll_info='{{disadvantage=1}}';finalSetAttrs.shaped_d20='2d20@{d20_mod}kl1';}setFinalAttrs(v,finalSetAttrs);});};on('change:roll_setting',function(){updateShapedD20();});var updateSkill=function updateSkill(rowId){var repeatingItem='repeating_skill';var collectionArray=['jack_of_all_trades_toggle','jack_of_all_trades','remarkable_athlete_toggle','remarkable_athlete','pb','exp','global_check_bonus'];var finalSetAttrs={};var _iteratorNormalCompletion46=true;var _didIteratorError46=false;var _iteratorError46=undefined;try{for(var _iterator46=ABILITIES[Symbol.iterator](),_step46;!(_iteratorNormalCompletion46=(_step46=_iterator46.next()).done);_iteratorNormalCompletion46=true){var ability=_step46.value;collectionArray.push(ability+'_mod');collectionArray.push(ability+'_check_bonus');}}catch(err){_didIteratorError46=true;_iteratorError46=err;}finally {try{if(!_iteratorNormalCompletion46&&_iterator46.return){_iterator46.return();}}finally {if(_didIteratorError46){throw _iteratorError46;}}}getSectionIDs(repeatingItem,function(ids){if(rowId){ids=[];ids.push(rowId);}var _iteratorNormalCompletion47=true;var _didIteratorError47=false;var _iteratorError47=undefined;try{for(var _iterator47=ids[Symbol.iterator](),_step47;!(_iteratorNormalCompletion47=(_step47=_iterator47.next()).done);_iteratorNormalCompletion47=true){var id=_step47.value;var _repeatingString12=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString12+'skill_d20');collectionArray.push(_repeatingString12+'skill_info');collectionArray.push(_repeatingString12+'proficiency');collectionArray.push(_repeatingString12+'name');collectionArray.push(_repeatingString12+'storage_name');collectionArray.push(_repeatingString12+'ability');collectionArray.push(_repeatingString12+'bonus');collectionArray.push(_repeatingString12+'ability_key');collectionArray.push(_repeatingString12+'formula');collectionArray.push(_repeatingString12+'total');collectionArray.push(_repeatingString12+'total_with_sign');collectionArray.push(_repeatingString12+'passive_bonus');collectionArray.push(_repeatingString12+'passive_total');}}catch(err){_didIteratorError47=true;_iteratorError47=err;}finally {try{if(!_iteratorNormalCompletion47&&_iterator47.return){_iterator47.return();}}finally {if(_didIteratorError47){throw _iteratorError47;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion48=true;var _didIteratorError48=false;var _iteratorError48=undefined;try{for(var _iterator48=ids[Symbol.iterator](),_step48;!(_iteratorNormalCompletion48=(_step48=_iterator48.next()).done);_iteratorNormalCompletion48=true){var id=_step48.value;var _repeatingString11=repeatingItem+'_'+id+'_';var skillName=v[_repeatingString11+'name'];if(isUndefined(skillName)){return;}var ability=getAbilityModName(v[_repeatingString11+'ability']);var abilityName=getAbilityName(ability);finalSetAttrs[_repeatingString11+'ability_key']=getAbilityShortName(v[_repeatingString11+'ability']).toUpperCase();var total=0;var totalFormula='';var proficiency=v[_repeatingString11+'proficiency'];if(!proficiency||proficiency==='unproficient'){if((abilityName==='strength'||abilityName==='dexterity'||abilityName==='constitution')&&v.remarkable_athlete_toggle==='@{remarkable_athlete}'){var remarkableAthlete=getIntValue(v.remarkable_athlete);total+=remarkableAthlete;totalFormula+=remarkableAthlete+'[remarkable athlete]';}else if(v.jack_of_all_trades_toggle==='@{jack_of_all_trades}'){var jackOfAllTrades=getIntValue(v.jack_of_all_trades);total+=jackOfAllTrades;totalFormula+=jackOfAllTrades+'[jack of all trades]';}}else if(proficiency==='proficient'){var pb=getIntValue(v.pb);total+=pb;totalFormula+=pb+'[proficient]';}else if(proficiency==='expertise'){var exp=getIntValue(v.exp);total+=exp;totalFormula+=exp+'[expertise]';}var abilityValue=getAbilityValue(v,ability,'strength');if(exists(abilityValue)){total+=abilityValue;totalFormula+=addArithmeticOperator(totalFormula,abilityValue)+'['+getAbilityShortName(ability)+']';}var skillBonus=getIntValue(v[_repeatingString11+'bonus']);if(exists(skillBonus)){total+=skillBonus;totalFormula+=addArithmeticOperator(totalFormula,skillBonus)+'[bonus]';}if(exists(abilityName)){var checkBonus=v[abilityName+'_check_bonus'];if(exists(checkBonus)){checkBonus=getIntValue(checkBonus);total+=checkBonus;totalFormula+=addArithmeticOperator(totalFormula,checkBonus)+'['+getAbilityShortName(ability)+' check bonus]';}}var globalCheckBonus=v.global_check_bonus;if(exists(globalCheckBonus)){if(!isNaN(globalCheckBonus)){total+=getIntValue(globalCheckBonus);}if(totalFormula){totalFormula+=' + ';}totalFormula+='(@{global_check_bonus})[global check bonus]';}var passiveBonus=getIntValue(v[_repeatingString11+'passive_bonus']);var advantageOrDisadvantage=0;finalSetAttrs[_repeatingString11+'skill_info']='';if(!isUndefined(v[_repeatingString11+'skill_d20'])){if(v[_repeatingString11+'skill_d20'].indexOf('kh1')!==-1){finalSetAttrs[_repeatingString11+'skill_info']='{{advantage=1}}';advantageOrDisadvantage=5;}else if(v[_repeatingString11+'skill_d20'].indexOf('kl1')!==-1){finalSetAttrs[_repeatingString11+'skill_info']='{{disadvantage=1}}';advantageOrDisadvantage=-5;}}var passiveTotal=10+total+passiveBonus+advantageOrDisadvantage;finalSetAttrs[_repeatingString11+'total']=total;finalSetAttrs[_repeatingString11+'passive']=passiveTotal;finalSetAttrs[_repeatingString11+'total_with_sign']=showSign(total);finalSetAttrs[_repeatingString11+'formula']=totalFormula;}}catch(err){_didIteratorError48=true;_iteratorError48=err;}finally {try{if(!_iteratorNormalCompletion48&&_iterator48.return){_iterator48.return();}}finally {if(_didIteratorError48){throw _iteratorError48;}}}setFinalAttrs(v,finalSetAttrs,function(){updateAbilityChecksMacro();});});});};on('change:repeating_skill',function(eventInfo){var repeatingInfo=getRepeatingInfo('repeating_skill',eventInfo);if(repeatingInfo&&repeatingInfo.field!=='ability_key'&&repeatingInfo.field!=='total'&&repeatingInfo.field!=='total_with_sign'&&repeatingInfo.field!=='passive_total'&&repeatingInfo.field!=='passive_total_with_sign'&&repeatingInfo.field!=='formula'){updateSkill(repeatingInfo.rowId);}});on('remove:repeating_skill change:ability_checks_show_totals',function(){updateAbilityChecksMacro();});on('change:jack_of_all_trades_toggle change:jack_of_all_trades change:remarkable_athlete_toggle change:remarkable_athlete change:global_check_bonus change:strength_check_bonus change:dexterity_check_bonus change:constitution_check_bonus change:intelligence_check_bonus change:wisdom_check_bonus change:charisma_check_bonus',function(){updateSkill();});var updateSkillsFromSRD=function updateSkillsFromSRD(){var repeatingItem='repeating_skill';var collectionArray=['skills_srd','level','challenge','strength_mod','dexterity_mod','constitution_mod','intelligence_mod','wisdom_mod','charisma_mod'];var finalSetAttrs={};getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion49=true;var _didIteratorError49=false;var _iteratorError49=undefined;try{for(var _iterator49=ids[Symbol.iterator](),_step49;!(_iteratorNormalCompletion49=(_step49=_iterator49.next()).done);_iteratorNormalCompletion49=true){var id=_step49.value;var _repeatingString13=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString13+'name');collectionArray.push(_repeatingString13+'ability');}}catch(err){_didIteratorError49=true;_iteratorError49=err;}finally {try{if(!_iteratorNormalCompletion49&&_iterator49.return){_iterator49.return();}}finally {if(_didIteratorError49){throw _iteratorError49;}}}getAttrs(collectionArray,function(v){var skillsFromSRD=v.skills_srd;var skillsObj={};var pb=getPB(v.level,v.challenge);var expertise=pb*2;var skillName=void 0;var repeatingString=void 0;if(!isUndefined(skillsFromSRD)){var _iteratorNormalCompletion50=true;var _didIteratorError50=false;var _iteratorError50=undefined;try{for(var _iterator50=ids[Symbol.iterator](),_step50;!(_iteratorNormalCompletion50=(_step50=_iterator50.next()).done);_iteratorNormalCompletion50=true){var id=_step50.value;repeatingString=repeatingItem+'_'+id+'_';skillName=v[repeatingString+'name'];skillsObj[skillName]=id;}}catch(err){_didIteratorError50=true;_iteratorError50=err;}finally {try{if(!_iteratorNormalCompletion50&&_iterator50.return){_iterator50.return();}}finally {if(_didIteratorError50){throw _iteratorError50;}}}var re=/(\w+)\s?((?:\+|\-)\d+)/gi;var match=void 0;while((match=re.exec(skillsFromSRD))!==null){if(match&&match[1]&&match[2]){skillName=match[1];if(skillsObj[skillName]){var skillId=skillsObj[skillName];repeatingString=repeatingItem+'_'+skillId+'_';var skillAbility=v[repeatingString+'ability'];var abilityValue=getAbilityValue(v,skillAbility);var skillBonus=getIntValue(match[2])-abilityValue;if(skillBonus>=expertise){finalSetAttrs[repeatingString+'proficiency']='expertise';if(skillBonus>expertise){finalSetAttrs[repeatingString+'bonus']=skillBonus-expertise;}}else if(skillBonus>=pb){finalSetAttrs[repeatingString+'proficiency']='proficient';if(skillBonus>pb){finalSetAttrs[repeatingString+'bonus']=skillBonus-pb;}}}else {console.warn(skillName+' does not exist in the list of skills');}}}}setFinalAttrs(v,finalSetAttrs);});});};on('change:skills_srd',function(){updateSkillsFromSRD();});var updateSavingThrow=function updateSavingThrow(ability){var collectionArray=['pb',ability+'_mod',ability+'_save_prof',ability+'_save_bonus','global_saving_throw_bonus','saving_throws_half_proficiency'];var finalSetAttrs={};getAttrs(collectionArray,function(v){var abilityMod=getIntValue(v[ability+'_mod']);var total=abilityMod;var totalFormula=abilityMod+'['+getAbilityShortName(ability)+']';var pb=getIntValue(v.pb);if(v[ability+'_save_prof']==='@{PB}'){total+=pb;totalFormula+=addArithmeticOperator(totalFormula,pb)+'[proficient]';}else if(v.saving_throws_half_proficiency==='on'){var halfPB=Math.floor(pb/2);total+=halfPB;totalFormula+=addArithmeticOperator(totalFormula,halfPB)+'[half proficiency]';}var abilitySavingThrowBonus=getIntValue(v[ability+'_save_bonus']);if(abilitySavingThrowBonus){total+=abilitySavingThrowBonus;totalFormula+=addArithmeticOperator(totalFormula,abilitySavingThrowBonus)+'['+getAbilityShortName(ability)+'saving throw bonus]';}var globalSavingThrowBonus=v.global_saving_throw_bonus;if(!isUndefined(globalSavingThrowBonus)){if(!isNaN(globalSavingThrowBonus)){total+=getIntValue(globalSavingThrowBonus);}totalFormula+=addArithmeticOperator(totalFormula,globalSavingThrowBonus)+'[global saving throw bonus]';}finalSetAttrs[ability+'_saving_throw_mod']=totalFormula;finalSetAttrs[ability+'_saving_throw_mod_with_sign']=showSign(total);setFinalAttrs(v,finalSetAttrs);});};var updateSavingThrows=function updateSavingThrows(){updateSavingThrow('strength');updateSavingThrow('dexterity');updateSavingThrow('constitution');updateSavingThrow('intelligence');updateSavingThrow('wisdom');updateSavingThrow('charisma');};on('change:pb change:global_saving_throw_bonus change:saving_throws_half_proficiency',function(){updateSavingThrows();});on('change:strength_mod change:strength_save_prof change:strength_save_bonus',function(){updateSavingThrow('strength');});on('change:dexterity_mod change:dexterity_save_prof change:dexterity_save_bonus',function(){updateSavingThrow('dexterity');});on('change:constitution_mod change:constitution_save_prof change:constitution_save_bonus',function(){updateSavingThrow('constitution');});on('change:intelligence_mod change:intelligence_save_prof change:intelligence_save_bonus',function(){updateSavingThrow('intelligence');});on('change:wisdom_mod change:wisdom_save_prof change:wisdom_save_bonus',function(){updateSavingThrow('wisdom');});on('change:charisma_mod change:charisma_save_prof change:charisma_save_bonus',function(){updateSavingThrow('charisma');});var updateSavingThrowsFromSRD=function updateSavingThrowsFromSRD(){var collectionArray=['saving_throws_srd'];var finalSetAttrs={};getAttrs(collectionArray,function(v){var savingThrowsFromSRD=v.saving_throws_srd;var pbVar='@{PB}';if(savingThrowsFromSRD.indexOf('Str')!==-1){finalSetAttrs.strength_save_prof=pbVar;}if(savingThrowsFromSRD.indexOf('Dex')!==-1){finalSetAttrs.dexterity_save_prof=pbVar;}if(savingThrowsFromSRD.indexOf('Con')!==-1){finalSetAttrs.constitution_save_prof=pbVar;}if(savingThrowsFromSRD.indexOf('Int')!==-1){finalSetAttrs.intelligence_save_prof=pbVar;}if(savingThrowsFromSRD.indexOf('Wis')!==-1){finalSetAttrs.wisdom_save_prof=pbVar;}if(savingThrowsFromSRD.indexOf('Cha')!==-1){finalSetAttrs.charisma_save_prof=pbVar;}setFinalAttrs(v,finalSetAttrs);});};on('change:saving_throws_srd',function(){updateSavingThrowsFromSRD();});var updateSpellsFromSRD=function updateSpellsFromSRD(){var collectionArray=['spells_srd'];var finalSetAttrs={};getAttrs(collectionArray,function(v){var spells=v.spells_srd.split(', ');var _iteratorNormalCompletion51=true;var _didIteratorError51=false;var _iteratorError51=undefined;try{for(var _iterator51=spells[Symbol.iterator](),_step51;!(_iteratorNormalCompletion51=(_step51=_iterator51.next()).done);_iteratorNormalCompletion51=true){var spell=_step51.value;var _repeatingString14='repeating_spell_'+generateRowID()+'_';finalSetAttrs[_repeatingString14+'name']=spell;}}catch(err){_didIteratorError51=true;_iteratorError51=err;}finally {try{if(!_iteratorNormalCompletion51&&_iterator51.return){_iterator51.return();}}finally {if(_didIteratorError51){throw _iteratorError51;}}}setFinalAttrs(v,finalSetAttrs);});};on('change:spells_srd',function(){updateSpellsFromSRD();});var updateAttachers=function updateAttachers(){var repeatingItem='repeating_attacher';var collectionArray=['attacher_initiative','attacher_death_saving_throw','attacher_hit_dice','attacher_attack','attacher_spell','attacher_skill','attacher_crit'];var finalSetAttrs={};var itemsToPush=['initiative','death_saving_throw','hit_dice','attack','spell','skill'];var _iteratorNormalCompletion52=true;var _didIteratorError52=false;var _iteratorError52=undefined;try{for(var _iterator52=ABILITIES[Symbol.iterator](),_step52;!(_iteratorNormalCompletion52=(_step52=_iterator52.next()).done);_iteratorNormalCompletion52=true){var ability=_step52.value;collectionArray.push('attacher_'+ability+'_check');collectionArray.push('attacher_'+ability+'_saving_throw');itemsToPush.push(ability+'_check');itemsToPush.push(ability+'_saving_throw');}}catch(err){_didIteratorError52=true;_iteratorError52=err;}finally {try{if(!_iteratorNormalCompletion52&&_iterator52.return){_iterator52.return();}}finally {if(_didIteratorError52){throw _iteratorError52;}}}getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion53=true;var _didIteratorError53=false;var _iteratorError53=undefined;try{for(var _iterator53=ids[Symbol.iterator](),_step53;!(_iteratorNormalCompletion53=(_step53=_iterator53.next()).done);_iteratorNormalCompletion53=true){var id=_step53.value;var _repeatingString16=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString16+'name');collectionArray.push(_repeatingString16+'freetext');collectionArray.push(_repeatingString16+'freeform');collectionArray.push(_repeatingString16+'crit_attacher');var _iteratorNormalCompletion56=true;var _didIteratorError56=false;var _iteratorError56=undefined;try{for(var _iterator56=itemsToPush[Symbol.iterator](),_step56;!(_iteratorNormalCompletion56=(_step56=_iterator56.next()).done);_iteratorNormalCompletion56=true){var itemToPush=_step56.value;collectionArray.push(''+_repeatingString16+itemToPush+'_attacher');finalSetAttrs['attacher_'+itemToPush]='';}}catch(err){_didIteratorError56=true;_iteratorError56=err;}finally {try{if(!_iteratorNormalCompletion56&&_iterator56.return){_iterator56.return();}}finally {if(_didIteratorError56){throw _iteratorError56;}}}}}catch(err){_didIteratorError53=true;_iteratorError53=err;}finally {try{if(!_iteratorNormalCompletion53&&_iterator53.return){_iterator53.return();}}finally {if(_didIteratorError53){throw _iteratorError53;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion54=true;var _didIteratorError54=false;var _iteratorError54=undefined;try{for(var _iterator54=ids[Symbol.iterator](),_step54;!(_iteratorNormalCompletion54=(_step54=_iterator54.next()).done);_iteratorNormalCompletion54=true){var id=_step54.value;var _repeatingString15=repeatingItem+'_'+id+'_';var _iteratorNormalCompletion55=true;var _didIteratorError55=false;var _iteratorError55=undefined;try{for(var _iterator55=itemsToPush[Symbol.iterator](),_step55;!(_iteratorNormalCompletion55=(_step55=_iterator55.next()).done);_iteratorNormalCompletion55=true){var itemToPush=_step55.value;var attacher=v[''+_repeatingString15+itemToPush+'_attacher'];if(exists(attacher)&&attacher==='on'){var attacherName=v[_repeatingString15+'name']||'';var freeText=v[_repeatingString15+'freetext'];if(exists(attacherName)&&exists(freeText)){var critAttacher=v[_repeatingString15+'crit_attacher'];if(critAttacher==='on'){finalSetAttrs['attacher_'+itemToPush]+='{{crit_name='+attacherName+'}} ';finalSetAttrs['attacher_'+itemToPush]+='{{crit_text='+freeText+'}} ';}else {finalSetAttrs['attacher_'+itemToPush]+='{{'+attacherName+'='+freeText+'}} ';}}var freeForm=v[_repeatingString15+'freeform'];if(exists(freeForm)){finalSetAttrs['attacher_'+itemToPush]+=freeForm+' ';}}}}catch(err){_didIteratorError55=true;_iteratorError55=err;}finally {try{if(!_iteratorNormalCompletion55&&_iterator55.return){_iterator55.return();}}finally {if(_didIteratorError55){throw _iteratorError55;}}}}}catch(err){_didIteratorError54=true;_iteratorError54=err;}finally {try{if(!_iteratorNormalCompletion54&&_iterator54.return){_iterator54.return();}}finally {if(_didIteratorError54){throw _iteratorError54;}}}setFinalAttrs(v,finalSetAttrs);});});};on('change:repeating_attacher remove:repeating_attacher',function(){updateAttachers();});var updateNPCChallenge=function updateNPCChallenge(){var collectionArray=['challenge','xp'];var finalSetAttrs={};getAttrs(collectionArray,function(v){var challenge=v.challenge;var xpPerChallenge={0:0,'1/8':25,'1/4':50,'1/2':100,1:200,2:450,3:700,4:1100,5:1800,6:2300,7:2900,8:3900,9:5000,10:5900,11:7200,12:8400,13:10000,14:11500,15:13000,16:15000,17:18000,18:20000,19:22000,20:25000,21:33000,22:41000,23:50000,24:62000,25:75000,26:90000,27:105000,28:120000,29:135000,30:155000};finalSetAttrs.xp=xpPerChallenge[challenge];finalSetAttrs.xp_readable=numberWithCommas(finalSetAttrs.xp);finalSetAttrs.level=challenge;if(finalSetAttrs.level<1){finalSetAttrs.level=1;}setFinalAttrs(v,finalSetAttrs);});};on('change:challenge',function(){updateNPCChallenge();});var updateNPCHPFromSRD=function updateNPCHPFromSRD(){var collectionArray=['hp_srd','constitution','constitution_mod','constitution_bonus','global_ability_bonus'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(exists(v.hp_srd)){var match=v.hp_srd.match(/\((\d+)d(\d+)(?:\s?(\+|\-)\s?(\d+))?\)/i);if(!match||!match[1]||!match[2]){console.warn('Character doesn\'t have valid HP/HD format');}else {var hdNum=getIntValue(match[1]);var conMod=getIntValue(v.constitution_mod);if(!conMod){var conScore=getIntValue(v.constitution);var conBonus=getIntValue(v.constitution_bonus);var globalAbilityBonus=getIntValue(v.global_ability_bonus);conMod=getAbilityMod(conScore+conBonus+globalAbilityBonus);}finalSetAttrs.hit_dice=hdNum;finalSetAttrs.hit_die='d'+getIntValue(match[2]);var hpExpectedBonus=hdNum*conMod;var hpBonusSign=match[3];var hpBonus=getIntValue(match[4]);if(hpBonus!==hpExpectedBonus){if(hpBonusSign==='-'){finalSetAttrs.hp_extra=hpBonus+hpExpectedBonus;}else {finalSetAttrs.hp_extra=hpBonus-hpExpectedBonus;}}}}setFinalAttrs(v,finalSetAttrs);});};on('change:hp_srd',function(){updateNPCHPFromSRD();});var updateNPCHP=function updateNPCHP(){var collectionArray=['HP','HP_max','hp_formula','hit_dice','hit_die','hp_extra','constitution_mod'];var finalSetAttrs={};getAttrs(collectionArray,function(v){var hdNum=getIntValue(v.hit_dice);var hdSize=getIntValue(v.hit_die.replace('d',''));var hdAverage=hdSize/2+0.5;var hpFormula=hdNum+'d'+hdSize;var conMod=getIntValue(v.constitution_mod);var totalHP=Math.floor(hdNum*hdAverage);var amount=void 0;if(conMod!==0){var bonusHP=hdNum*conMod;totalHP+=bonusHP;hpFormula+=addArithmeticOperator(hpFormula,bonusHP);}if(exists(v.hp_extra)){var regex=/(?:(\+|\-)\s?)?(\d+)(?:d(\d+))?/gi;var splitFormula=void 0;while((splitFormula=regex.exec(v.hp_extra))!==null){if(!splitFormula||!splitFormula[2]){console.warn('Character doesn\'t have valid hp formula');}else {amount=0;if(!splitFormula[3]){amount=getIntValue(splitFormula[2]);}else {var extraHdNum=getIntValue(splitFormula[2]);var extraHdSize=getIntValue(splitFormula[3]);var extraHdAverage=extraHdSize/2+0.5;amount=Math.floor(extraHdNum*extraHdAverage);}if(!splitFormula[1]||splitFormula[1]==='+'){totalHP+=amount;hpFormula+=''+addArithmeticOperator(hpFormula,amount);}else if(splitFormula[1]==='-'){totalHP-=amount;hpFormula+=''+addArithmeticOperator(hpFormula,amount);}}v.hp_extra.toString().replace(splitFormula[0],'');}}if(totalHP){finalSetAttrs.HP=totalHP;finalSetAttrs.HP_max=totalHP;finalSetAttrs.hp_formula=hpFormula;}setFinalAttrs(v,finalSetAttrs);});};on('change:hit_dice change:hit_die change:hp_extra change:constitution_mod',function(){updateNPCHP();});var updateNPCHD=function updateNPCHD(){var collectionArray=['hit_dice','hit_die'];var finalSetAttrs={};var hd={d20:0,d12:0,d10:0,d8:0,d6:0,d4:0,d2:0,d0:0};for(var key in hd){if(hd.hasOwnProperty(key)){collectionArray.push('hd_'+key+'_max');collectionArray.push('hd_'+key+'_query');collectionArray.push('hd_'+key+'_toggle');}}getAttrs(collectionArray,function(v){var hdNum=getIntValue(v.hit_dice);var hdSize=v.hit_die;if(hdNum&&hdSize){hd[hdSize]=hdNum;updateHD(v,finalSetAttrs,hd);}setFinalAttrs(v,finalSetAttrs);});};on('change:hit_dice change:hit_die',function(){updateNPCHD();});var updateNPCAC=function updateNPCAC(){var collectionArray=['ac_srd','ac','ac_note','dexterity_mod'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(exists(v.ac_srd)){var match=v.ac_srd.match(/(\d+)\s?(.*)/);if(match&&match[1]){finalSetAttrs.AC=match[1];}if(match&&match[2]){finalSetAttrs.ac_note=match[2].replace(/\(|\)/g,'');}}setFinalAttrs(v,finalSetAttrs);});};on('change:ac_srd',function(){updateNPCAC();});var setDefaultAbility=function setDefaultAbility(v,finalSetAttrs){var abilityScores=[getIntValue(v.intelligence),getIntValue(v.wisdom),getIntValue(v.charisma)];var highestAbilityScore=Math.max.apply(Math,abilityScores);var highestAbilityName='intelligence';if(highestAbilityScore===abilityScores[1]){highestAbilityName='wisdom';}else if(highestAbilityScore===abilityScores[2]){highestAbilityName='charisma';}finalSetAttrs.default_ability='@{'+highestAbilityName+'_mod}';};var parseSRDContentSection=function parseSRDContentSection(content,finalSetAttrs,title,name){var re=/@(.*)@:\s([^@]+)/gi;var match=void 0;var section=void 0;if(content.indexOf(title)!==-1){var contentSplit=content.split(title+'\n');section=contentSplit[1];content=contentSplit[0];}if(exists(section)){if(name==='legendaryaction'){var legendaryActionsMatch=section.match(/Can take (\d+) Legendary Actions/i);if(legendaryActionsMatch&&legendaryActionsMatch[1]){finalSetAttrs.legendary_action_amount=legendaryActionsMatch[1];}}while((match=re.exec(section.replace(/\*\*/g,'@')))!==null){if(match&&match[1]&&match[2]){var _repeatingString17='repeating_'+name+'_'+generateRowID()+'_';finalSetAttrs[_repeatingString17+'name']=match[1];var text=match[2].trim();if(name==='trait'){finalSetAttrs[_repeatingString17+'display_text']=text;}finalSetAttrs[_repeatingString17+'freetext']=text;}else {console.warn('Character doesn\'t have a valid '+name+' format');}}}return content;};var updateNPCContent=function updateNPCContent(){var collectionArray=['content_srd'];var finalSetAttrs={};var _iteratorNormalCompletion57=true;var _didIteratorError57=false;var _iteratorError57=undefined;try{for(var _iterator57=ABILITIES[Symbol.iterator](),_step57;!(_iteratorNormalCompletion57=(_step57=_iterator57.next()).done);_iteratorNormalCompletion57=true){var ability=_step57.value;collectionArray.push(ability);}}catch(err){_didIteratorError57=true;_iteratorError57=err;}finally {try{if(!_iteratorNormalCompletion57&&_iterator57.return){_iterator57.return();}}finally {if(_didIteratorError57){throw _iteratorError57;}}}getAttrs(collectionArray,function(v){var content=v.content_srd;var regionalEffects=void 0;var lairActions=void 0;var repeatingString=void 0;setDefaultAbility(v,finalSetAttrs);if(exists(content)){if(content.indexOf('Regional Effects')!==-1){var regionalEffectsSplit=content.split(/Regional Effects\n/);regionalEffects=regionalEffectsSplit[1];content=regionalEffectsSplit[0];}if(exists(regionalEffects)){var regionalEffectsList=regionalEffects.split(/\*\*/);regionalEffectsList.slice(1,-1).forEach(function(regionalEffect){repeatingString='repeating_regionaleffect_'+generateRowID()+'_';finalSetAttrs[repeatingString+'freetext']=regionalEffect.trim();});finalSetAttrs.regional_effects_fade=regionalEffectsList.slice(-1)[0];}if(content.indexOf('Lair Actions')!==-1){var lairActionsSplit=content.split(/Lair Actions\n/);lairActions=lairActionsSplit[1];content=lairActionsSplit[0];}if(exists(lairActions)){lairActions.split(/\*\*/).slice(1).forEach(function(lairAction){repeatingString='repeating_lairaction_'+generateRowID()+'_';finalSetAttrs[repeatingString+'freetext']=lairAction.trim();});}content=parseSRDContentSection(content,finalSetAttrs,'Legendary Actions','legendaryaction');content=parseSRDContentSection(content,finalSetAttrs,'Reactions','reaction');content=parseSRDContentSection(content,finalSetAttrs,'Actions','action');parseSRDContentSection(content,finalSetAttrs,'Traits','trait');}setFinalAttrs(v,finalSetAttrs);});};on('change:content_srd',function(){updateNPCContent();});var displayTextForTraits=function displayTextForTraits(){var repeatingItem='repeating_trait';var collectionArray=[];var finalSetAttrs={};getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion58=true;var _didIteratorError58=false;var _iteratorError58=undefined;try{for(var _iterator58=ids[Symbol.iterator](),_step58;!(_iteratorNormalCompletion58=(_step58=_iterator58.next()).done);_iteratorNormalCompletion58=true){var id=_step58.value;var _repeatingString19=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString19+'display_text');collectionArray.push(_repeatingString19+'freetext');}}catch(err){_didIteratorError58=true;_iteratorError58=err;}finally {try{if(!_iteratorNormalCompletion58&&_iterator58.return){_iterator58.return();}}finally {if(_didIteratorError58){throw _iteratorError58;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion59=true;var _didIteratorError59=false;var _iteratorError59=undefined;try{for(var _iterator59=ids[Symbol.iterator](),_step59;!(_iteratorNormalCompletion59=(_step59=_iterator59.next()).done);_iteratorNormalCompletion59=true){var id=_step59.value;var _repeatingString18=repeatingItem+'_'+id+'_';if(isUndefined(v.display_text)){finalSetAttrs[_repeatingString18+'display_text']=v[_repeatingString18+'freetext'];}}}catch(err){_didIteratorError59=true;_iteratorError59=err;}finally {try{if(!_iteratorNormalCompletion59&&_iterator59.return){_iterator59.return();}}finally {if(_didIteratorError59){throw _iteratorError59;}}}setFinalAttrs(v,finalSetAttrs);});});};var parseDamage=function parseDamage(finalSetAttrs,repeatingString,freetext,regex,name,spellMods,meleeMods,spellAttack,rangedAttack,dexMod){var damageParseRegex=/(\d+d?\d+)(?:\s?(?:\+|\-)\s?(\d+))?/gi;var damage=regex.exec(freetext);var damageBonus=void 0;if(damage){if(damage[1]){damageBonus=damage[1];}if(damage[2]){var damageParsed=damageParseRegex.exec(damage[2]);if(damageParsed){if(damageParsed[1]){finalSetAttrs[repeatingString+name]=damageParsed[1];}if(damageParsed[2]){damageBonus=damageParsed[2];}}}damageBonus=getCorrectAbilityBasedOnBonus(finalSetAttrs,repeatingString,name+'_ability',damageBonus,spellMods,meleeMods,spellAttack,rangedAttack,dexMod);if(damage[3]){finalSetAttrs[''+repeatingString+name+'_type']=damage[3];}if(damageBonus){finalSetAttrs[''+repeatingString+name+'_bonus']=damageBonus;}freetext=freetext.replace(regex,'');finalSetAttrs[''+repeatingString+name+'_toggle']=toggleVars[name];}return freetext;};var parseAction=function parseAction(type,rowId){var repeatingItem='repeating_'+type;var collectionArray=['level','challenge','global_attack_bonus','global_melee_attack_bonus','global_ranged_attack_bonus','global_damage_bonus','global_melee_damage_bonus','global_ranged_damage_bonus','default_ability'];var finalSetAttrs={};var damageSyntax=/(?:(\d+)|.*?\(([\dd\s\+\-]*)\).*?)\s*?/;var damageType=/((?:[a-zA-Z]+|[a-zA-Z]+\s(?:or|and)\s[a-zA-Z]+)(?:\s*?\([a-zA-Z\s]+\))?)\s*?damage\s?(\([a-zA-Z'\s]+\))?/;var altDamageSyntax=/(?:,\s*?or\s*?)/;var plus=/\s*?plus\s*?/;var savingThrowRe=/(?:DC)\s*?(\d+)\s*?([a-zA-Z]*)\s*?(?:saving throw)/;var saveSuccess=/or\s(.*)?\son a successful one./;var damageRegex=new RegExp(damageSyntax.source+damageType.source,'i');var damagePlusRegex=new RegExp(plus.source+damageSyntax.source+damageType.source,'i');var altDamageRegex=new RegExp(altDamageSyntax.source+damageSyntax.source+damageType.source,'i');var savingThrowRegex=new RegExp(savingThrowRe.source,'i');var saveSuccessRegex=new RegExp(saveSuccess.source,'i');var typeRegex=/(melee|ranged|melee or ranged)\s*(spell|weapon)\s*attack/gi;var toHitRegex=/:\s?\+\s?(\d+)\s*(?:to hit)/gi;var reachRegex=/(?:reach)\s?(\d+)\s?(?:ft)/gi;var rangeRegex=/(?:range)\s?(\d+)\/(\d+)\s?(ft)/gi;var spellcastingRegex=/(\d+)\w+\slevel\s\((\d+)\s?slot(?:s)?\)/gi;var spellcastingLevelRegex=/(\d+)(?:st|dn|rd|th)-level spellcaster/i;var spellcastingAbilityRegex=/spellcasting ability is (\w+)/i;var _iteratorNormalCompletion60=true;var _didIteratorError60=false;var _iteratorError60=undefined;try{for(var _iterator60=ABILITIES[Symbol.iterator](),_step60;!(_iteratorNormalCompletion60=(_step60=_iterator60.next()).done);_iteratorNormalCompletion60=true){var ability=_step60.value;collectionArray.push(ability+'_mod');}}catch(err){_didIteratorError60=true;_iteratorError60=err;}finally {try{if(!_iteratorNormalCompletion60&&_iterator60.return){_iterator60.return();}}finally {if(_didIteratorError60){throw _iteratorError60;}}}getSectionIDs(repeatingItem,function(ids){if(rowId){ids=[];ids.push(rowId);}var _iteratorNormalCompletion61=true;var _didIteratorError61=false;var _iteratorError61=undefined;try{for(var _iterator61=ids[Symbol.iterator](),_step61;!(_iteratorNormalCompletion61=(_step61=_iterator61.next()).done);_iteratorNormalCompletion61=true){var id=_step61.value;var _repeatingString21=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString21+'name');collectionArray.push(_repeatingString21+'freetext');}}catch(err){_didIteratorError61=true;_iteratorError61=err;}finally {try{if(!_iteratorNormalCompletion61&&_iterator61.return){_iterator61.return();}}finally {if(_didIteratorError61){throw _iteratorError61;}}}getAttrs(collectionArray,function(v){var pb=getPB(v.level,v.challenge);var strMod=getIntValue(v.strength_mod);var dexMod=getIntValue(v.dexterity_mod);var conMod=getIntValue(v.constitution_mod);var intMod=getIntValue(v.intelligence_mod);var wisMod=getIntValue(v.wisdom_mod);var chaMod=getIntValue(v.charisma_mod);var meleeMods=[strMod,dexMod];var spellMods=[intMod,wisMod,chaMod];var abilityMods=[strMod,dexMod,conMod,intMod,wisMod,chaMod];var _iteratorNormalCompletion62=true;var _didIteratorError62=false;var _iteratorError62=undefined;try{for(var _iterator62=ids[Symbol.iterator](),_step62;!(_iteratorNormalCompletion62=(_step62=_iterator62.next()).done);_iteratorNormalCompletion62=true){var id=_step62.value;var _repeatingString20=repeatingItem+'_'+id+'_';var rangedAttack=false;var spellAttack=false;var name=v[_repeatingString20+'name'];var freetext=v[_repeatingString20+'freetext'];if(name&&name.indexOf('Spellcasting')!==-1){var spellcastingSearch=spellcastingAbilityRegex.exec(freetext);if(spellcastingSearch&&spellcastingSearch[1]){var spellcastingAbility=spellcastingSearch[1].toLowerCase();finalSetAttrs.default_ability='@{'+spellcastingAbility+'_mod}';}var spellcastingLevelSearch=spellcastingLevelRegex.exec(freetext);if(spellcastingLevelSearch&&spellcastingLevelSearch[1]){finalSetAttrs.caster_level=spellcastingLevelSearch[1];}var match=void 0;while((match=spellcastingRegex.exec(freetext))!==null){if(match&&match[1]&&match[2]){finalSetAttrs['spell_slots_l'+match[1]+'_bonus']=match[2];}}}var actionType=typeRegex.exec(freetext);if(actionType){if(actionType[1]){actionType[1]=actionType[1].toLowerCase();if(actionType[1]==='melee'){finalSetAttrs[_repeatingString20+'type']='Melee Weapon';}else if(actionType[1]==='ranged'){finalSetAttrs[_repeatingString20+'type']='Ranged Weapon';rangedAttack=true;}else {finalSetAttrs[_repeatingString20+'type']='Other';}}if(actionType[2]){actionType[2]=actionType[2].toLowerCase();if(actionType[2]==='spell'){spellAttack=true;}}freetext=freetext.replace(typeRegex,'');}var reach=reachRegex.exec(freetext);if(reach&&reach[1]){finalSetAttrs[_repeatingString20+'reach']=reach[1]+'ft.';freetext=freetext.replace(reachRegex,'');}var range=rangeRegex.exec(freetext);if(range&&range[1]&&range[2]){finalSetAttrs[_repeatingString20+'range']=range[1]+'ft.';freetext=freetext.replace(rangeRegex,'');}var toHit=toHitRegex.exec(freetext);if(toHit&&toHit[1]){var hitBonus=toHit[1];hitBonus-=pb;hitBonus=getCorrectAbilityBasedOnBonus(finalSetAttrs,_repeatingString20,'attack_ability',hitBonus,spellMods,meleeMods,spellAttack,rangedAttack,dexMod);if(hitBonus){finalSetAttrs[_repeatingString20+'attack_bonus']=hitBonus;}freetext=freetext.replace(toHitRegex,'');finalSetAttrs[_repeatingString20+'roll_toggle']=toggleVars.roll;}else {finalSetAttrs[_repeatingString20+'roll_toggle']='0';}var savingThrow=savingThrowRegex.exec(freetext);if(savingThrow){if(savingThrow[1]){var savingThrowTotal=savingThrow[1];savingThrowTotal-=8;savingThrowTotal-=pb;savingThrowTotal=getAnyCorrectAbilityBasedOnBonus(finalSetAttrs,_repeatingString20,'saving_throw_ability',savingThrowTotal,abilityMods);if(savingThrowTotal){finalSetAttrs[_repeatingString20+'saving_throw_bonus']=savingThrowTotal;}freetext=freetext.replace(savingThrowRegex,'');finalSetAttrs[_repeatingString20+'saving_throw_toggle']=toggleVars.saving_throw;}if(savingThrow[2]){finalSetAttrs[_repeatingString20+'saving_throw_vs_ability']=savingThrow[2].toUpperCase();}var halfDamage=saveSuccessRegex.exec(freetext);if(halfDamage&&halfDamage[1]){finalSetAttrs[_repeatingString20+'saving_throw_success']=halfDamage[1];freetext=freetext.replace(saveSuccessRegex,'');}}else {finalSetAttrs[_repeatingString20+'saving_throw_toggle']='0';}freetext=parseDamage(finalSetAttrs,_repeatingString20,freetext,damageRegex,'damage',spellMods,meleeMods,spellAttack,rangedAttack,dexMod);freetext=parseDamage(finalSetAttrs,_repeatingString20,freetext,altDamageRegex,'second_damage',spellMods,meleeMods,spellAttack,rangedAttack,dexMod);freetext=parseDamage(finalSetAttrs,_repeatingString20,freetext,damagePlusRegex,'second_damage',spellMods,meleeMods,spellAttack,rangedAttack,dexMod);if(!exists(finalSetAttrs[_repeatingString20+'second_damage'])){freetext=parseDamage(finalSetAttrs,_repeatingString20,freetext,damageRegex,'second_damage',spellMods,meleeMods,spellAttack,rangedAttack,dexMod);}finalSetAttrs[_repeatingString20+'extras_toggle']=toggleVars.extras;}}catch(err){_didIteratorError62=true;_iteratorError62=err;}finally {try{if(!_iteratorNormalCompletion62&&_iterator62.return){_iterator62.return();}}finally {if(_didIteratorError62){throw _iteratorError62;}}}setFinalAttrs(v,finalSetAttrs,function(){updateAction(type,rowId);});});});};on('change:repeating_trait:freetext',function(eventInfo){var repeatingInfo=getRepeatingInfo('repeating_trait',eventInfo);parseAction('trait',repeatingInfo.rowId);});on('change:repeating_action:freetext',function(eventInfo){var repeatingInfo=getRepeatingInfo('repeating_action',eventInfo);parseAction('action',repeatingInfo.rowId);});on('change:repeating_reaction:freetext',function(eventInfo){var repeatingInfo=getRepeatingInfo('repeating_reaction',eventInfo);parseAction('reaction',repeatingInfo.rowId);});on('change:repeating_legendaryaction:freetext',function(eventInfo){var repeatingInfo=getRepeatingInfo('repeating_legendaryaction',eventInfo);parseAction('legendaryaction',repeatingInfo.rowId);});on('change:repeating_lairaction:freetext',function(eventInfo){var repeatingInfo=getRepeatingInfo('repeating_lairaction',eventInfo);parseAction('lairaction',repeatingInfo.rowId);});var countAction=function countAction(type){var repeatingItem='repeating_'+type;var collectionArray=[type+'s_exist'];var finalSetAttrs={};getSectionIDs(repeatingItem,function(ids){getAttrs(collectionArray,function(v){if(ids.length>0){finalSetAttrs[type+'s_exist']=1;}else if(exists(v[type+'s_exist'])){finalSetAttrs[type+'s_exist']=0;}setFinalAttrs(v,finalSetAttrs);});});};on('change:repeating_trait remove:repeating_trait',function(){countAction('trait');updateActionChatMacro('trait');});on('change:repeating_action remove:repeating_action',function(){countAction('action');updateActionChatMacro('action');});on('change:repeating_reaction remove:repeating_reaction',function(){countAction('reaction');updateActionChatMacro('reaction');});on('change:repeating_legendaryaction remove:repeating_legendaryaction',function(){countAction('legendaryaction');updateActionChatMacro('legendaryaction');});on('change:repeating_lairaction remove:repeating_lairaction',function(){countAction('lairaction');updateActionChatMacro('lairaction');});on('change:repeating_regionaleffect remove:repeating_regionaleffect',function(){countAction('regionaleffect');updateActionChatMacro('regionaleffect');});var switchToNPC=function switchToNPC(){var collectionArray=['is_npc','size'];var finalSetAttrs={};getAttrs(collectionArray,function(v){var isNPC=getIntValue(v.is_npc)===1;if(isNPC&&isUndefined(v.size)){finalSetAttrs.size='Large';}if(isNPC){finalSetAttrs.hit_dice_output_option='/w GM';}else {finalSetAttrs.hit_dice_output_option='';}setFinalAttrs(v,finalSetAttrs);});};on('change:is_npc',function(){switchToNPC();});var updateSize=function updateSize(){var collectionArray=['size'];var finalSetAttrs={};getAttrs(collectionArray,function(v){var creatureSize=v.size||'Large';var sizeToHdSize={Tiny:4,Small:6,Medium:8,Large:10,Huge:12,Gargantuan:20};finalSetAttrs.hit_die='d'+sizeToHdSize[creatureSize];setFinalAttrs(v,finalSetAttrs);});};on('change:size',function(){updateSize();});var updateType=function updateType(){var collectionArray=['type'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(v.type){finalSetAttrs.type=v.type.toLowerCase();}setFinalAttrs(v,finalSetAttrs);});};on('change:type',function(){updateType();});var updateAlignment=function updateAlignment(){var collectionArray=['alignment','is_npc'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(v.alignment&&v.is_npc==='1'){finalSetAttrs.alignment=v.alignment.toLowerCase();}setFinalAttrs(v,finalSetAttrs);});};on('change:alignment',function(){updateAlignment();});var updateSenses=function updateSenses(){var collectionArray=['senses'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(v.senses){finalSetAttrs.senses_exist=1;finalSetAttrs.senses=v.senses.toLowerCase();}else {finalSetAttrs.senses_exist=0;}setFinalAttrs(v,finalSetAttrs);});};on('change:senses',function(){updateSenses();});var updateLanguages=function updateLanguages(){var collectionArray=['languages','languages_exist','languages_chat_var'];var finalSetAttrs={};finalSetAttrs.languages_exist=0;finalSetAttrs.languages_chat_var='';getAttrs(collectionArray,function(v){if(v.languages){finalSetAttrs.languages_exist=1;finalSetAttrs.languages_chat_var='{{Languages=@{languages}}}';}setFinalAttrs(v,finalSetAttrs);});};on('change:languages',function(){updateLanguages();});var updateSpeed=function updateSpeed(){var collectionArray=['npc_speed'];var finalSetAttrs={};getAttrs(collectionArray,function(v){finalSetAttrs.npc_speed=v.npc_speed.toLowerCase();var match=finalSetAttrs.npc_speed.match(/^\s*(\d+)\s*ft/);if(match&&match[1]){finalSetAttrs.speed=match[1];}setFinalAttrs(v,finalSetAttrs);});};on('change:npc_speed',function(){updateSpeed();});var updateACNote=function updateACNote(){var collectionArray=['ac_note'];var finalSetAttrs={};getAttrs(collectionArray,function(v){finalSetAttrs.ac_note=v.ac_note.toLowerCase();setFinalAttrs(v,finalSetAttrs);});};on('change:ac_note',function(){updateACNote();});var updateDamageResistancesVar=function updateDamageResistancesVar(){var collectionArray=['damage_resistances_var','damage_vulnerabilities_exist','damage_resistances_exist','damage_immunities_exist','condition_immunities_exist'];var finalSetAttrs={};finalSetAttrs.damage_resistances_var='';getAttrs(collectionArray,function(v){if(v.damage_vulnerabilities_exist){finalSetAttrs.damage_resistances_var+='{{Damage Vulnerabilities=@{damage_vulnerabilities}}}';}if(v.damage_resistances_exist){if(finalSetAttrs.damage_resistances_var!==''){finalSetAttrs.damage_resistances_var+=' ';}finalSetAttrs.damage_resistances_var+='{{Damage Resistances=@{damage_resistances}}}';}if(v.damage_immunities_exist){if(finalSetAttrs.damage_resistances_var!==''){finalSetAttrs.damage_resistances_var+=' ';}finalSetAttrs.damage_resistances_var+='{{Damage Immunities=@{damage_immunities}}}';}if(v.condition_immunities_exist){if(finalSetAttrs.damage_resistances_var!==''){finalSetAttrs.damage_resistances_var+=' ';}finalSetAttrs.damage_resistances_var+='{{Condition Immunities=@{condition_immunities}}}';}setFinalAttrs(v,finalSetAttrs);});};var updateDamageVulnerabilities=function updateDamageVulnerabilities(){var collectionArray=['damage_vulnerabilities'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(v.damage_vulnerabilities){finalSetAttrs.damage_vulnerabilities_exist=1;finalSetAttrs.damage_vulnerabilities=lowercaseDamageTypes(v.damage_vulnerabilities);}else {finalSetAttrs.damage_vulnerabilities_exist=0;}setFinalAttrs(v,finalSetAttrs,function(){updateDamageResistancesVar();});});};on('change:damage_vulnerabilities',function(){updateDamageVulnerabilities();});var updateDamageResistances=function updateDamageResistances(){var collectionArray=['damage_resistances'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(v.damage_resistances){finalSetAttrs.damage_resistances_exist=1;finalSetAttrs.damage_resistances=lowercaseDamageTypes(v.damage_resistances);}else {finalSetAttrs.damage_resistances_exist=0;}setFinalAttrs(v,finalSetAttrs,function(){updateDamageResistancesVar();});});};on('change:damage_resistances',function(){updateDamageResistances();});var updateDamageImmunities=function updateDamageImmunities(){var collectionArray=['damage_immunities'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(v.damage_immunities){finalSetAttrs.damage_immunities_exist=1;finalSetAttrs.damage_immunities=lowercaseDamageTypes(v.damage_immunities);}else {finalSetAttrs.damage_immunities_exist=0;}setFinalAttrs(v,finalSetAttrs,function(){updateDamageResistancesVar();});});};on('change:damage_immunities',function(){updateDamageImmunities();});var updateConditionImmunities=function updateConditionImmunities(){var collectionArray=['condition_immunities'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(v.condition_immunities){finalSetAttrs.condition_immunities_exist=1;finalSetAttrs.condition_immunities=lowercaseDamageTypes(v.condition_immunities);}else {finalSetAttrs.condition_immunities_exist=0;}setFinalAttrs(v,finalSetAttrs,function(){updateDamageResistancesVar();});});};on('change:condition_immunities',function(){updateConditionImmunities();});var resourcesToTraits=function resourcesToTraits(){var repeatingItem='repeating_resource';var newRepeatingItem='repeating_trait';var collectionArray=[];var finalSetAttrs={};var repeatingString=void 0;getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion63=true;var _didIteratorError63=false;var _iteratorError63=undefined;try{for(var _iterator63=ids[Symbol.iterator](),_step63;!(_iteratorNormalCompletion63=(_step63=_iterator63.next()).done);_iteratorNormalCompletion63=true){var id=_step63.value;repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+'name');collectionArray.push(repeatingString+'uses');collectionArray.push(repeatingString+'uses_max');collectionArray.push(repeatingString+'toggle_details');collectionArray.push(repeatingString+'recharge');collectionArray.push(repeatingString+'extras_toggle');collectionArray.push(repeatingString+'freetext');collectionArray.push(repeatingString+'freeform');}}catch(err){_didIteratorError63=true;_iteratorError63=err;}finally {try{if(!_iteratorNormalCompletion63&&_iterator63.return){_iterator63.return();}}finally {if(_didIteratorError63){throw _iteratorError63;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion64=true;var _didIteratorError64=false;var _iteratorError64=undefined;try{for(var _iterator64=ids[Symbol.iterator](),_step64;!(_iteratorNormalCompletion64=(_step64=_iterator64.next()).done);_iteratorNormalCompletion64=true){var id=_step64.value;repeatingString=repeatingItem+'_'+id+'_';var newRepeatingString=newRepeatingItem+'_'+generateRowID()+'_';finalSetAttrs[newRepeatingString+'name']=v[repeatingString+'name'];finalSetAttrs[newRepeatingString+'uses']=v[repeatingString+'uses'];finalSetAttrs[newRepeatingString+'uses_max']=v[repeatingString+'uses_max'];finalSetAttrs[newRepeatingString+'toggle_details']=v[repeatingString+'toggle_details'];finalSetAttrs[newRepeatingString+'recharge']=v[repeatingString+'recharge'];finalSetAttrs[newRepeatingString+'extras_toggle']=v[repeatingString+'extras_toggle'];finalSetAttrs[newRepeatingString+'freetext']=v[repeatingString+'freetext'];finalSetAttrs[newRepeatingString+'freeform']=v[repeatingString+'freeform'];}}catch(err){_didIteratorError64=true;_iteratorError64=err;}finally {try{if(!_iteratorNormalCompletion64&&_iterator64.return){_iterator64.return();}}finally {if(_didIteratorError64){throw _iteratorError64;}}}setFinalAttrs(v,finalSetAttrs);});});};var classFeaturesToTraits=function classFeaturesToTraits(){var repeatingItem='repeating_classfeature';var newRepeatingItem='repeating_trait';var collectionArray=[];var finalSetAttrs={};var repeatingString=void 0;getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion65=true;var _didIteratorError65=false;var _iteratorError65=undefined;try{for(var _iterator65=ids[Symbol.iterator](),_step65;!(_iteratorNormalCompletion65=(_step65=_iterator65.next()).done);_iteratorNormalCompletion65=true){var id=_step65.value;repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+'name');collectionArray.push(repeatingString+'uses');collectionArray.push(repeatingString+'uses_max');collectionArray.push(repeatingString+'recharge');collectionArray.push(repeatingString+'saving_throw_toggle');collectionArray.push(repeatingString+'saving_throw_condition');collectionArray.push(repeatingString+'saving_throw_ability');collectionArray.push(repeatingString+'saving_throw_bonus');collectionArray.push(repeatingString+'saving_throw_vs_ability');collectionArray.push(repeatingString+'saving_throw_failure');collectionArray.push(repeatingString+'saving_throw_success');collectionArray.push(repeatingString+'damage_toggle');collectionArray.push(repeatingString+'damage');collectionArray.push(repeatingString+'damage_ability');collectionArray.push(repeatingString+'damage_bonus');collectionArray.push(repeatingString+'damage_type');collectionArray.push(repeatingString+'second_damage_toggle');collectionArray.push(repeatingString+'second_damage');collectionArray.push(repeatingString+'second_damage_ability');collectionArray.push(repeatingString+'second_damage_bonus');collectionArray.push(repeatingString+'second_damage_type');collectionArray.push(repeatingString+'heal');collectionArray.push(repeatingString+'heal_ability');collectionArray.push(repeatingString+'heal_bonus');collectionArray.push(repeatingString+'heal_query_toggle');collectionArray.push(repeatingString+'extras_toggle');collectionArray.push(repeatingString+'emote');collectionArray.push(repeatingString+'freetext');collectionArray.push(repeatingString+'freeform');}}catch(err){_didIteratorError65=true;_iteratorError65=err;}finally {try{if(!_iteratorNormalCompletion65&&_iterator65.return){_iterator65.return();}}finally {if(_didIteratorError65){throw _iteratorError65;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion66=true;var _didIteratorError66=false;var _iteratorError66=undefined;try{for(var _iterator66=ids[Symbol.iterator](),_step66;!(_iteratorNormalCompletion66=(_step66=_iterator66.next()).done);_iteratorNormalCompletion66=true){var id=_step66.value;repeatingString=repeatingItem+'_'+id+'_';var newRepeatingString=newRepeatingItem+'_'+generateRowID()+'_';finalSetAttrs[newRepeatingString+'name']=v[repeatingString+'name'];finalSetAttrs[newRepeatingString+'uses']=v[repeatingString+'uses'];finalSetAttrs[newRepeatingString+'uses_max']=v[repeatingString+'uses_max'];finalSetAttrs[newRepeatingString+'recharge']=v[repeatingString+'recharge'];finalSetAttrs[newRepeatingString+'saving_throw_toggle']=v[repeatingString+'saving_throw_toggle'];finalSetAttrs[newRepeatingString+'saving_throw_condition']=v[repeatingString+'saving_throw_condition'];finalSetAttrs[newRepeatingString+'saving_throw_ability']=v[repeatingString+'saving_throw_ability'];finalSetAttrs[newRepeatingString+'saving_throw_bonus']=v[repeatingString+'saving_throw_bonus'];finalSetAttrs[newRepeatingString+'saving_throw_vs_ability']=v[repeatingString+'saving_throw_vs_ability'];finalSetAttrs[newRepeatingString+'saving_throw_failure']=v[repeatingString+'saving_throw_failure'];finalSetAttrs[newRepeatingString+'saving_throw_success']=v[repeatingString+'saving_throw_success'];finalSetAttrs[newRepeatingString+'damage_toggle']=v[repeatingString+'damage_toggle'];finalSetAttrs[newRepeatingString+'damage']=v[repeatingString+'damage'];finalSetAttrs[newRepeatingString+'damage_ability']=v[repeatingString+'damage_ability'];finalSetAttrs[newRepeatingString+'damage_bonus']=v[repeatingString+'damage_bonus'];finalSetAttrs[newRepeatingString+'damage_type']=v[repeatingString+'damage_type'];finalSetAttrs[newRepeatingString+'second_damage_toggle']=v[repeatingString+'second_damage_toggle'];finalSetAttrs[newRepeatingString+'second_damage']=v[repeatingString+'second_damage'];finalSetAttrs[newRepeatingString+'second_damage_ability']=v[repeatingString+'second_damage_ability'];finalSetAttrs[newRepeatingString+'second_damage_bonus']=v[repeatingString+'second_damage_bonus'];finalSetAttrs[newRepeatingString+'second_damage_type']=v[repeatingString+'second_damage_type'];finalSetAttrs[newRepeatingString+'heal']=v[repeatingString+'heal'];finalSetAttrs[newRepeatingString+'heal_ability']=v[repeatingString+'heal_ability'];finalSetAttrs[newRepeatingString+'heal_bonus']=v[repeatingString+'heal_bonus'];finalSetAttrs[newRepeatingString+'heal_query_toggle']=v[repeatingString+'heal_query_toggle'];finalSetAttrs[newRepeatingString+'extras_toggle']=v[repeatingString+'extras_toggle'];finalSetAttrs[newRepeatingString+'emote']=v[repeatingString+'emote'];finalSetAttrs[newRepeatingString+'freetext']=v[repeatingString+'freetext'];finalSetAttrs[newRepeatingString+'display_text']=v[repeatingString+'freetext'];finalSetAttrs[newRepeatingString+'freeform']=v[repeatingString+'freeform'];}}catch(err){_didIteratorError66=true;_iteratorError66=err;}finally {try{if(!_iteratorNormalCompletion66&&_iterator66.return){_iterator66.return();}}finally {if(_didIteratorError66){throw _iteratorError66;}}}setFinalAttrs(v,finalSetAttrs);});});};var getSkillIdByStorageName=function getSkillIdByStorageName(v,repeatingItem,ids,prop){var _iteratorNormalCompletion67=true;var _didIteratorError67=false;var _iteratorError67=undefined;try{for(var _iterator67=ids[Symbol.iterator](),_step67;!(_iteratorNormalCompletion67=(_step67=_iterator67.next()).done);_iteratorNormalCompletion67=true){var id=_step67.value;var _repeatingString22=repeatingItem+'_'+id+'_';if(v[_repeatingString22+'storage_name']===prop||v[_repeatingString22+'storage_name']===camelize(prop)){return id;}}}catch(err){_didIteratorError67=true;_iteratorError67=err;}finally {try{if(!_iteratorNormalCompletion67&&_iterator67.return){_iterator67.return();}}finally {if(_didIteratorError67){throw _iteratorError67;}}}};var setAdvantageOnStealth=function setAdvantageOnStealth(mode){var repeatingItem='repeating_skill';var collectionArray=[];var finalSetAttrs={};var repeatingString=void 0;getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion68=true;var _didIteratorError68=false;var _iteratorError68=undefined;try{for(var _iterator68=ids[Symbol.iterator](),_step68;!(_iteratorNormalCompletion68=(_step68=_iterator68.next()).done);_iteratorNormalCompletion68=true){var id=_step68.value;repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+'storage_name');collectionArray.push(repeatingString+'skill_d20');}}catch(err){_didIteratorError68=true;_iteratorError68=err;}finally {try{if(!_iteratorNormalCompletion68&&_iterator68.return){_iterator68.return();}}finally {if(_didIteratorError68){throw _iteratorError68;}}}getAttrs(collectionArray,function(v){for(var prop in SKILLS){if(SKILLS.hasOwnProperty(prop)){var skillId=getSkillIdByStorageName(v,repeatingItem,ids,prop);repeatingString=repeatingItem+'_'+skillId+'_';if(v[repeatingString+'storage_name']==='STEALTH'){if(mode==='dis'){finalSetAttrs[repeatingString+'skill_d20']='2d20@{d20_mod}kl1';}else if(mode==='normal'){finalSetAttrs[repeatingString+'skill_d20']='@{shaped_d20}';}}}}setFinalAttrs(v,finalSetAttrs);});});};var generateSkills=function generateSkills(){var repeatingItem='repeating_skill';var collectionArray=[];var finalSetAttrs={};var repeatingString=void 0;getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion69=true;var _didIteratorError69=false;var _iteratorError69=undefined;try{for(var _iterator69=ids[Symbol.iterator](),_step69;!(_iteratorNormalCompletion69=(_step69=_iterator69.next()).done);_iteratorNormalCompletion69=true){var id=_step69.value;repeatingString=repeatingItem+'_'+id+'_';collectionArray.push(repeatingString+'storage_name');collectionArray.push(repeatingString+'name');collectionArray.push(repeatingString+'ability');}}catch(err){_didIteratorError69=true;_iteratorError69=err;}finally {try{if(!_iteratorNormalCompletion69&&_iterator69.return){_iterator69.return();}}finally {if(_didIteratorError69){throw _iteratorError69;}}}getAttrs(collectionArray,function(v){for(var prop in SKILLS){if(SKILLS.hasOwnProperty(prop)){var skillId=getSkillIdByStorageName(v,repeatingItem,ids,prop);if(!skillId){skillId=generateRowID();}repeatingString=repeatingItem+'_'+skillId+'_';finalSetAttrs[repeatingString+'storage_name']=prop;finalSetAttrs[repeatingString+'name']=getTranslationByKey(prop);finalSetAttrs[repeatingString+'ability']=SKILLS[prop];updateSkill(skillId);}}setFinalAttrs(v,finalSetAttrs);});});};on('change:generate_skills',function(){generateSkills();});on('change:pb',function(){updateSkill();updateAttack();updateSpell();updateJackOfAllTrades();updateRemarkableAthlete();updateActions();});on('change:strength_mod change:dexterity_mod change:constitution_mod change:intelligence_mod change:wisdom_mod change:charisma_mod',function(){updateSkill();updateAttack();updateSpell();updateActions();});var extasToExtrasFix=function extasToExtrasFix(repeatingItem){var collectionArray=[];var finalSetAttrs={};getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion70=true;var _didIteratorError70=false;var _iteratorError70=undefined;try{for(var _iterator70=ids[Symbol.iterator](),_step70;!(_iteratorNormalCompletion70=(_step70=_iterator70.next()).done);_iteratorNormalCompletion70=true){var id=_step70.value;var _repeatingString24=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString24+'extas_toggle');}}catch(err){_didIteratorError70=true;_iteratorError70=err;}finally {try{if(!_iteratorNormalCompletion70&&_iterator70.return){_iterator70.return();}}finally {if(_didIteratorError70){throw _iteratorError70;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion71=true;var _didIteratorError71=false;var _iteratorError71=undefined;try{for(var _iterator71=ids[Symbol.iterator](),_step71;!(_iteratorNormalCompletion71=(_step71=_iterator71.next()).done);_iteratorNormalCompletion71=true){var id=_step71.value;var _repeatingString23=repeatingItem+'_'+id+'_';if(!isUndefined(v[_repeatingString23+'extas_toggle'])){finalSetAttrs[_repeatingString23+'extras_toggle']=v[_repeatingString23+'extas_toggle'];}}}catch(err){_didIteratorError71=true;_iteratorError71=err;}finally {try{if(!_iteratorNormalCompletion71&&_iterator71.return){_iterator71.return();}}finally {if(_didIteratorError71){throw _iteratorError71;}}}setFinalAttrs(v,finalSetAttrs);});});};var armorPlusDexRemoval=function armorPlusDexRemoval(){var repeatingItem='repeating_armor';var collectionArray=[];var finalSetAttrs={};getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion72=true;var _didIteratorError72=false;var _iteratorError72=undefined;try{for(var _iterator72=ids[Symbol.iterator](),_step72;!(_iteratorNormalCompletion72=(_step72=_iterator72.next()).done);_iteratorNormalCompletion72=true){var id=_step72.value;var _repeatingString26=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString26+'type');}}catch(err){_didIteratorError72=true;_iteratorError72=err;}finally {try{if(!_iteratorNormalCompletion72&&_iterator72.return){_iterator72.return();}}finally {if(_didIteratorError72){throw _iteratorError72;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion73=true;var _didIteratorError73=false;var _iteratorError73=undefined;try{for(var _iterator73=ids[Symbol.iterator](),_step73;!(_iteratorNormalCompletion73=(_step73=_iterator73.next()).done);_iteratorNormalCompletion73=true){var id=_step73.value;var _repeatingString25=repeatingItem+'_'+id+'_';var armorType=v[_repeatingString25+'type'];if(armorType==='Armor + Dex'){finalSetAttrs[_repeatingString25+'type']='Light Armor';}}}catch(err){_didIteratorError73=true;_iteratorError73=err;}finally {try{if(!_iteratorNormalCompletion73&&_iterator73.return){_iterator73.return();}}finally {if(_didIteratorError73){throw _iteratorError73;}}}setFinalAttrs(v,finalSetAttrs);});});};var fixRollTwo=function fixRollTwo(){var collectionArray=['roll_setting'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(v.roll_setting==='@{attr_roll_2}'){finalSetAttrs.roll_setting='{{roll2=[[d20@{d20_mod}';}setFinalAttrs(v,finalSetAttrs);});};var atSyntaxToAbilityName=function atSyntaxToAbilityName(v,finalSetAttrs,repeatingString,field){if(v[''+repeatingString+field]){finalSetAttrs[''+repeatingString+field]=getAbilityName(v[''+repeatingString+field]);}};var updateActionComponents=function updateActionComponents(){var repeatingItems=['repeating_attack','repeating_spell','repeating_trait','repeating_action','repeating_reaction','repeating_legendaryaction','repeating_lairaction','repeating_regionaleffect'];var collectionArray=[];var finalSetAttrs={};var _iteratorNormalCompletion74=true;var _didIteratorError74=false;var _iteratorError74=undefined;try{var _loop3=function _loop3(){var repeatingItem=_step74.value;getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion75=true;var _didIteratorError75=false;var _iteratorError75=undefined;try{for(var _iterator75=ids[Symbol.iterator](),_step75;!(_iteratorNormalCompletion75=(_step75=_iterator75.next()).done);_iteratorNormalCompletion75=true){var id=_step75.value;var _repeatingString28=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString28+'attack_ability');collectionArray.push(_repeatingString28+'damage_ability');collectionArray.push(_repeatingString28+'second_damage_ability');collectionArray.push(_repeatingString28+'heal_ability');collectionArray.push(_repeatingString28+'saving_throw_ability');collectionArray.push(_repeatingString28+'saving_throw_vs_ability');}}catch(err){_didIteratorError75=true;_iteratorError75=err;}finally {try{if(!_iteratorNormalCompletion75&&_iterator75.return){_iterator75.return();}}finally {if(_didIteratorError75){throw _iteratorError75;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion76=true;var _didIteratorError76=false;var _iteratorError76=undefined;try{for(var _iterator76=ids[Symbol.iterator](),_step76;!(_iteratorNormalCompletion76=(_step76=_iterator76.next()).done);_iteratorNormalCompletion76=true){var id=_step76.value;var _repeatingString27=repeatingItem+'_'+id+'_';atSyntaxToAbilityName(v,finalSetAttrs,_repeatingString27,'attack_ability');atSyntaxToAbilityName(v,finalSetAttrs,_repeatingString27,'damage_ability');atSyntaxToAbilityName(v,finalSetAttrs,_repeatingString27,'second_damage_ability');atSyntaxToAbilityName(v,finalSetAttrs,_repeatingString27,'heal_ability');atSyntaxToAbilityName(v,finalSetAttrs,_repeatingString27,'saving_throw_ability');if(v[_repeatingString27+'saving_throw_vs_ability']){finalSetAttrs[_repeatingString27+'saving_throw_vs_ability']=v[_repeatingString27+'saving_throw_vs_ability'].toUpperCase();}}}catch(err){_didIteratorError76=true;_iteratorError76=err;}finally {try{if(!_iteratorNormalCompletion76&&_iterator76.return){_iterator76.return();}}finally {if(_didIteratorError76){throw _iteratorError76;}}}setFinalAttrs(v,finalSetAttrs);});});};for(var _iterator74=repeatingItems[Symbol.iterator](),_step74;!(_iteratorNormalCompletion74=(_step74=_iterator74.next()).done);_iteratorNormalCompletion74=true){_loop3();}}catch(err){_didIteratorError74=true;_iteratorError74=err;}finally {try{if(!_iteratorNormalCompletion74&&_iterator74.return){_iterator74.return();}}finally {if(_didIteratorError74){throw _iteratorError74;}}}};var changeOldToggleToNew=function changeOldToggleToNew(v,finalSetAttrs,field,oldValue,newValue){if(v[field]==='@{'+oldValue+'}'){finalSetAttrs[field]=newValue;}};var removeToggleVar=function removeToggleVar(){var collectionArray=['careful_spell_toggle','distant_spell_toggle','empowered_spell_toggle','extended_spell_toggle','heightened_spell_toggle','quickened_spell_toggle','subtle_spell_toggle','twinned_spell_toggle','initiative_tie_breaker','ammo_auto_use','hide_attack','hide_damage','hide_saving_throw_dc','hide_spell_content','hide_action_freetext','hide_saving_throw_failure','hide_saving_throw_success','hide_recharge','initiative_output_option','output_option','death_save_output_option','hit_dice_output_option','roll_setting','show_character_name','attacks_vs_target_ac','attacks_vs_target_name','initiative_roll','initiative_to_tracker'];var finalSetAttrs={};getAttrs(collectionArray,function(v){changeOldToggleToNew(v,finalSetAttrs,'careful_spell_toggle','careful_spell_toggle_var','1');changeOldToggleToNew(v,finalSetAttrs,'distant_spell_toggle','distant_spell_toggle_var','1');changeOldToggleToNew(v,finalSetAttrs,'empowered_spell_toggle','empowered_spell_toggle_var','1');changeOldToggleToNew(v,finalSetAttrs,'extended_spell_toggle','extended_spell_toggle_var','1');changeOldToggleToNew(v,finalSetAttrs,'heightened_spell_toggle','heightened_spell_toggle_var','1');changeOldToggleToNew(v,finalSetAttrs,'quickened_spell_toggle','quickened_spell_toggle_var','1');changeOldToggleToNew(v,finalSetAttrs,'subtle_spell_toggle','subtle_spell_toggle_var','1');changeOldToggleToNew(v,finalSetAttrs,'twinned_spell_toggle','twinned_spell_toggle_var','1');changeOldToggleToNew(v,finalSetAttrs,'initiative_tie_breaker','initiative_tie_breaker_var','[[@{initiative} / 100]][tie breaker]');changeOldToggleToNew(v,finalSetAttrs,'ammo_auto_use','ammo_auto_use_var','1');changeOldToggleToNew(v,finalSetAttrs,'hide_attack','hide_attack_var','{{hide_attack=1}}');changeOldToggleToNew(v,finalSetAttrs,'hide_damage','hide_damage_var','{{hide_damage=1}}');changeOldToggleToNew(v,finalSetAttrs,'hide_saving_throw_dc','hide_saving_throw_dc_var','{{hide_saving_throw_dc=1}}');changeOldToggleToNew(v,finalSetAttrs,'hide_spell_content','hide_spell_content_var','{{hide_spell_content=1}}');changeOldToggleToNew(v,finalSetAttrs,'hide_action_freetext','hide_action_freetext_var','{{hide_freetext=1}}');changeOldToggleToNew(v,finalSetAttrs,'hide_saving_throw_failure','hide_saving_throw_failure_var','{{hide_saving_throw_failure=1}}');changeOldToggleToNew(v,finalSetAttrs,'hide_saving_throw_success','hide_saving_throw_success_var','{{hide_saving_throw_success=1}}');changeOldToggleToNew(v,finalSetAttrs,'hide_recharge','hide_recharge_var','{{hide_recharge=1}}');changeOldToggleToNew(v,finalSetAttrs,'initiative_output_option','output_to_all','');changeOldToggleToNew(v,finalSetAttrs,'initiative_output_option','output_to_gm','/w GM');changeOldToggleToNew(v,finalSetAttrs,'output_option','output_to_all','');changeOldToggleToNew(v,finalSetAttrs,'output_option','output_to_gm','/w GM');changeOldToggleToNew(v,finalSetAttrs,'death_save_output_option','output_to_all','');changeOldToggleToNew(v,finalSetAttrs,'death_save_output_option','output_to_gm','/w GM');changeOldToggleToNew(v,finalSetAttrs,'hit_dice_output_option','output_to_all','');changeOldToggleToNew(v,finalSetAttrs,'hit_dice_output_option','output_to_gm','/w GM');changeOldToggleToNew(v,finalSetAttrs,'roll_setting','roll_advantage','adv {{ignore=[[0');changeOldToggleToNew(v,finalSetAttrs,'roll_setting','roll_disadvantage','dis {{ignore=[[0');changeOldToggleToNew(v,finalSetAttrs,'roll_setting','roll_1','{{ignore=[[0');changeOldToggleToNew(v,finalSetAttrs,'roll_setting','roll_2','{{roll2=[[d20@{d20_mod}');changeOldToggleToNew(v,finalSetAttrs,'show_character_name','show_character_name_no','');changeOldToggleToNew(v,finalSetAttrs,'show_character_name','show_character_name_yes','{{show_character_name=1}}');changeOldToggleToNew(v,finalSetAttrs,'attacks_vs_target_ac','attacks_vs_target_ac_no','');changeOldToggleToNew(v,finalSetAttrs,'attacks_vs_target_ac','attacks_vs_target_ac_yes','[[@{target|AC}]]');changeOldToggleToNew(v,finalSetAttrs,'attacks_vs_target_name','attacks_vs_target_name_no','');changeOldToggleToNew(v,finalSetAttrs,'attacks_vs_target_name','attacks_vs_target_name_yes','@{target|token_name}');changeOldToggleToNew(v,finalSetAttrs,'initiative_roll','normal_initiative','@{shaped_d20}');changeOldToggleToNew(v,finalSetAttrs,'initiative_roll','advantage_on_initiative','2d20@{d20_mod}kh1');changeOldToggleToNew(v,finalSetAttrs,'initiative_roll','disadvantage_on_initiative','2d20@{d20_mod}kl1');changeOldToggleToNew(v,finalSetAttrs,'initiative_to_tracker','initiative_to_tracker_yes','@{selected|initiative_formula} &{tracker}');changeOldToggleToNew(v,finalSetAttrs,'initiative_to_tracker','initiative_to_tracker_no','@{initiative_formula}');setFinalAttrs(v,finalSetAttrs);});};var changeOldRepeatingToggleToNew=function changeOldRepeatingToggleToNew(v,finalSetAttrs,repeatingString,field,oldValue,newValue){if(v[''+repeatingString+field]==='@{'+oldValue+'}'){finalSetAttrs[''+repeatingString+field]=newValue;}};var updateActionComponentsToRemoveExtraFields=function updateActionComponentsToRemoveExtraFields(){var repeatingItems=['repeating_attack','repeating_spell','repeating_trait','repeating_action','repeating_reaction','repeating_legendaryaction','repeating_lairaction','repeating_regionaleffect'];var collectionArray=[];var finalSetAttrs={};var _iteratorNormalCompletion77=true;var _didIteratorError77=false;var _iteratorError77=undefined;try{var _loop4=function _loop4(){var repeatingItem=_step77.value;getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion78=true;var _didIteratorError78=false;var _iteratorError78=undefined;try{for(var _iterator78=ids[Symbol.iterator](),_step78;!(_iteratorNormalCompletion78=(_step78=_iterator78.next()).done);_iteratorNormalCompletion78=true){var id=_step78.value;var _repeatingString30=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString30+'roll_toggle');collectionArray.push(_repeatingString30+'content_toggle');collectionArray.push(_repeatingString30+'saving_throw_toggle');collectionArray.push(_repeatingString30+'damage_toggle');collectionArray.push(_repeatingString30+'second_damage_toggle');collectionArray.push(_repeatingString30+'extras_toggle');collectionArray.push(_repeatingString30+'heal_toggle');collectionArray.push(_repeatingString30+'heal_query_toggle');collectionArray.push(_repeatingString30+'higher_level_toggle');collectionArray.push(_repeatingString30+'special_effects_toggle');}}catch(err){_didIteratorError78=true;_iteratorError78=err;}finally {try{if(!_iteratorNormalCompletion78&&_iterator78.return){_iterator78.return();}}finally {if(_didIteratorError78){throw _iteratorError78;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion79=true;var _didIteratorError79=false;var _iteratorError79=undefined;try{for(var _iterator79=ids[Symbol.iterator](),_step79;!(_iteratorNormalCompletion79=(_step79=_iterator79.next()).done);_iteratorNormalCompletion79=true){var id=_step79.value;var _repeatingString29=repeatingItem+'_'+id+'_';changeOldRepeatingToggleToNew(v,finalSetAttrs,_repeatingString29,'roll_toggle','roll_toggle_var','{{vs_ac=1}} @{roll_info} {{roll1=[[@{shaped_d20}cs>@{crit_range} + @{attack_formula}]]}} @{roll_setting}cs>@{crit_range} + @{attack_formula}]]}} {{targetAC=@{attacks_vs_target_ac}}} {{targetName=@{attacks_vs_target_name}}}');changeOldRepeatingToggleToNew(v,finalSetAttrs,_repeatingString29,'content_toggle','content_toggle_var','{{content=@{content}}}');changeOldRepeatingToggleToNew(v,finalSetAttrs,_repeatingString29,'saving_throw_toggle','saving_throw_toggle_var','{{saving_throw_condition=@{saving_throw_condition}}} {{saving_throw_dc=@{saving_throw_dc}}} {{saving_throw_vs_ability=@{saving_throw_vs_ability}}} {{saving_throw_failure=@{saving_throw_failure}}} {{saving_throw_success=@{saving_throw_success}}} {{targetName=@{attacks_vs_target_name}}}');changeOldRepeatingToggleToNew(v,finalSetAttrs,_repeatingString29,'damage_toggle','damage_toggle_var','{{damage=[[@{damage_formula}]]}} {{damage_type=@{damage_type}}} {{crit_damage=[[0d0 + @{damage_crit}[crit damage] @{damage_crit_formula}]]}}');changeOldRepeatingToggleToNew(v,finalSetAttrs,_repeatingString29,'second_damage_toggle','second_damage_toggle_var','{{second_damage=[[@{second_damage_formula}]]}} {{second_damage_type=@{second_damage_type}}} {{second_crit_damage=[[0d0 + @{second_damage_crit}[crit damage] @{second_damage_crit_formula}]]}}');changeOldRepeatingToggleToNew(v,finalSetAttrs,_repeatingString29,'extras_toggle','extras_var','{{emote=@{emote}}} {{freetext=@{freetext}}} @{freeform}');changeOldRepeatingToggleToNew(v,finalSetAttrs,_repeatingString29,'heal_toggle','heal_toggle_var','{{heal=[[@{heal_formula}]]}}');changeOldRepeatingToggleToNew(v,finalSetAttrs,_repeatingString29,'heal_query_toggle','heal_query','?{Heal Bonus Amount|}');changeOldRepeatingToggleToNew(v,finalSetAttrs,_repeatingString29,'higher_level_toggle','higher_level_toggle_var','{{cast_as_level=@{higher_level_query}}}');changeOldRepeatingToggleToNew(v,finalSetAttrs,_repeatingString29,'special_effects_toggle','special_effects_var','{{fx=@{type}-@{color} @{points_of_origin}}}');}}catch(err){_didIteratorError79=true;_iteratorError79=err;}finally {try{if(!_iteratorNormalCompletion79&&_iterator79.return){_iterator79.return();}}finally {if(_didIteratorError79){throw _iteratorError79;}}}setFinalAttrs(v,finalSetAttrs);});});};for(var _iterator77=repeatingItems[Symbol.iterator](),_step77;!(_iteratorNormalCompletion77=(_step77=_iterator77.next()).done);_iteratorNormalCompletion77=true){_loop4();}}catch(err){_didIteratorError77=true;_iteratorError77=err;}finally {try{if(!_iteratorNormalCompletion77&&_iterator77.return){_iterator77.return();}}finally {if(_didIteratorError77){throw _iteratorError77;}}}};var updateSkillAbility=function updateSkillAbility(){var repeatingItems=['repeating_skill'];var collectionArray=[];var finalSetAttrs={};var _iteratorNormalCompletion80=true;var _didIteratorError80=false;var _iteratorError80=undefined;try{var _loop5=function _loop5(){var repeatingItem=_step80.value;getSectionIDs(repeatingItem,function(ids){var _iteratorNormalCompletion81=true;var _didIteratorError81=false;var _iteratorError81=undefined;try{for(var _iterator81=ids[Symbol.iterator](),_step81;!(_iteratorNormalCompletion81=(_step81=_iterator81.next()).done);_iteratorNormalCompletion81=true){var id=_step81.value;var _repeatingString32=repeatingItem+'_'+id+'_';collectionArray.push(_repeatingString32+'ability');}}catch(err){_didIteratorError81=true;_iteratorError81=err;}finally {try{if(!_iteratorNormalCompletion81&&_iterator81.return){_iterator81.return();}}finally {if(_didIteratorError81){throw _iteratorError81;}}}getAttrs(collectionArray,function(v){var _iteratorNormalCompletion82=true;var _didIteratorError82=false;var _iteratorError82=undefined;try{for(var _iterator82=ids[Symbol.iterator](),_step82;!(_iteratorNormalCompletion82=(_step82=_iterator82.next()).done);_iteratorNormalCompletion82=true){var id=_step82.value;var _repeatingString31=repeatingItem+'_'+id+'_';atSyntaxToAbilityName(v,finalSetAttrs,_repeatingString31,'ability');}}catch(err){_didIteratorError82=true;_iteratorError82=err;}finally {try{if(!_iteratorNormalCompletion82&&_iterator82.return){_iterator82.return();}}finally {if(_didIteratorError82){throw _iteratorError82;}}}setFinalAttrs(v,finalSetAttrs);});});};for(var _iterator80=repeatingItems[Symbol.iterator](),_step80;!(_iteratorNormalCompletion80=(_step80=_iterator80.next()).done);_iteratorNormalCompletion80=true){_loop5();}}catch(err){_didIteratorError80=true;_iteratorError80=err;}finally {try{if(!_iteratorNormalCompletion80&&_iterator80.return){_iterator80.return();}}finally {if(_didIteratorError80){throw _iteratorError80;}}}};var updateArmorAbility=function updateArmorAbility(){var collectionArray=['ac_unarmored_ability'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(!isUndefined(v.ac_unarmored_ability)){finalSetAttrs.ac_unarmored_ability=getAbilityName(v.ac_unarmored_ability);}setFinalAttrs(v,finalSetAttrs);});};var updateDefaultAbility=function updateDefaultAbility(){var collectionArray=['default_ability'];var finalSetAttrs={};getAttrs(collectionArray,function(v){if(!isUndefined(v.default_ability)){finalSetAttrs.default_ability=getAbilityName(v.default_ability);}setFinalAttrs(v,finalSetAttrs);});};var checkVersionFormat=function checkVersionFormat(version,finalSetAttrs){var versionRegex=/\d+\.\d+\.\d+/gi;var versionIsProperFormat=versionRegex.exec(version);if(version&&!versionIsProperFormat){finalSetAttrs.version=version=currentVersion;}return version;};var sheetOpened=function sheetOpened(){var collectionArray=['version','strength','dexterity','constitution','intelligence','wisdom','charisma','import_data','roll_setting'];var finalSetAttrs={};getAttrs(collectionArray,function(v){var version=checkVersionFormat(v.version,finalSetAttrs);if(!version){if(!v.import_data){finalSetAttrs.edit_mode='on';}if(isUndefined(v.roll_setting)){finalSetAttrs.roll_setting='{{ignore=[[0';}var setAbilities={};if(isUndefined(v.strength)){setAbilities.strength=10;}if(isUndefined(v.dexterity)){setAbilities.dexterity=10;}if(isUndefined(v.constitution)){setAbilities.constitution=10;}if(isUndefined(v.intelligence)){setAbilities.intelligence=10;}if(isUndefined(v.wisdom)){setAbilities.wisdom=10;}if(isUndefined(v.charisma)){setAbilities.charisma=10;}setFinalAttrs(v,setAbilities,function(){updatePb();generateSkills();updateSavingThrows();updateLevels();updateAbilityChecksMacro();updateInitiative();updateArmor();updateSpellChatMacroShow();});}else {if(versionCompare(version,'2.1.0')<0){updateNPCChallenge();updateDamageVulnerabilities();updateDamageResistances();updateDamageImmunities();updateConditionImmunities();updateLanguages();updateSenses();}if(versionCompare(version,'2.1.3')<0){updateType();updateAlignment();}if(versionCompare(version,'2.1.5')<0){updateNPCAC();}if(versionCompare(version,'2.1.10')<0){updateSavingThrows();}if(versionCompare(version,'2.1.13')<0){weighEquipment();}if(versionCompare(version,'2.1.15')<0){displayTextForTraits();}if(versionCompare(version,'2.2.1')<0){updateAbilityModifiers();}if(versionCompare(version,'2.2.2')<0){resourcesToTraits();}if(versionCompare(version,'2.2.4')<0){updateInitiative();}if(versionCompare(version,'2.2.5')<0){weighAmmo();}if(versionCompare(version,'2.2.6')<0){updateLevels();extasToExtrasFix('repeating_attack');extasToExtrasFix('repeating_action');extasToExtrasFix('repeating_spell');}if(versionCompare(version,'2.3.3')<0){updateAttachers();}if(versionCompare(version,'2.4.2')<0){updateAbilityModifiers();updateActionChatMacro('trait');updateActionChatMacro('action');updateActionChatMacro('reaction');updateActionChatMacro('legendaryaction');}if(versionCompare(version,'2.4.3')<0){setClassFeatures();}if(versionCompare(version,'2.4.7')<0){classFeaturesToTraits();updateAction('trait');}if(versionCompare(version,'2.4.8')<0){fixRollTwo();}if(versionCompare(version,'2.4.12')<0){armorPlusDexRemoval();updateArmor();}if(versionCompare(version,'2.6.3')<0){updateSpell();}if(versionCompare(version,'3.1.0')<0){updateAttackChatMacro();}if(versionCompare(version,'3.1.1')<0){updateActionChatMacro('lairaction');updateActionChatMacro('regionaleffect');updateAbilityChecksMacro();}if(versionCompare(version,'3.2.1')<0){updateCritDamage();}if(versionCompare(version,'3.2.3')<0){updateDamageResistancesVar();}if(versionCompare(version,'3.5.0')<0){generateHigherLevelQueries();updateSpellChatMacro();}if(versionCompare(version,'3.5.1')<0){updateSpellSlots();}if(versionCompare(version,'3.6.1')<0){updateNPCHD();switchToNPC();}if(versionCompare(version,'4.0.3')<0){updateSpellChatMacroShow();}if(versionCompare(version,'4.1.4')<0){updateDefaultAbility();updateArmorAbility();updateActionComponents();updateSkillAbility();}if(versionCompare(version,'4.1.5')<0){updateSkill();}if(versionCompare(version,'4.2.0')<0){updateD20Mod();updateShapedD20();}if(versionCompare(version,'4.2.1')<0){updateActionComponentsToRemoveExtraFields();updateAbilityChecksMacro();removeToggleVar();}if(versionCompare(version,'4.2.2')<0){updateActions();}if(versionCompare(version,'4.2.3')<0){updateArmor();}if(versionCompare(version,'4.2.4')<0){updateAttack();}}if(isUndefined(version)||!version||version!==currentVersion){finalSetAttrs.version=currentVersion;}setFinalAttrs(v,finalSetAttrs);});};on('sheet:opened',function(){sheetOpened();});var importData=function importData(){getAttrs(['import_data','version'],function(v){if(v.import_data){(function(){var finalSetAttrs={};var importObject=JSON.parse(v.import_data);if(importObject.npc){if(!v.version){sheetOpened();}for(var prop in importObject.npc){if(importObject.npc.hasOwnProperty(prop)){finalSetAttrs[prop]=importObject.npc[prop];}}}if(importObject.spells){importObject.spells.forEach(function(spell){var repeatingString='repeating_spell_'+generateRowID()+'_';for(var _prop2 in spell){if(spell.hasOwnProperty(_prop2)){finalSetAttrs[''+repeatingString+_prop2]=spell[_prop2];}}});}finalSetAttrs.import_data='';finalSetAttrs.import_data_present='off';setFinalAttrs(v,finalSetAttrs);})();}});};var deleteImportData=function deleteImportData(){getAttrs(['import_data','version'],function(v){var importObject=JSON.parse(v.import_data);if(importObject.npc&&!v.version){sheetOpened();}setFinalAttrs({},{import_data:'',import_data_present:'off'});});};on('change:accept_import',importData);on('change:reject_import',deleteImportData);</script>
<rolltemplate class="sheet-rolltemplate-5e-shaped">
  <div class="rt-card">
    <div class="sheet-tooltip-position-wrapper">
      {{#advantage}}
        <div class="sheet-tooltip">
          <div class="tooltip-toggle-text advantage-circle advantage"></div>
          <div class="sheet-tooltip-content-left sheet-tooltip-small sheet-small-label">
            <span><span data-i18n="ADVANTAGE">Advantage</span></span>
          </div>
        </div>
      {{/advantage}}
      {{#disadvantage}}
        <div class="sheet-tooltip">
          <div class="tooltip-toggle-text advantage-circle disadvantage"></div>
          <div class="sheet-tooltip-content-left sheet-tooltip-small sheet-small-label">
            <span><span data-i18n="DISADVANTAGE">Disadvantage</span></span>
          </div>
        </div>
      {{/disadvantage}}
    </div>
    <div class="rt-title-wrap">
      <span class="rt-title {{#action}} action{{/action}}{{#spell}} spell{{/spell}}{{#ability}} ability{{/ability}}{{#saving_throw}} saving-throw{{/saving_throw}}{{#death_saving_throw}} death-saving-throw{{/death_saving_throw}}">
        {{title}}
      </span>
    </div>
    <div class="rt-subheader">
      {{#spell}}
        <div class="italic">
          {{friendly_level}}{{#cast_as_level}} (<span class="lowercase" data-i18n="AS">as</span> {{cast_as_level}}){{/cast_as_level}}{{#school}} {{school}}{{/school}}{{#ritual}}
          (<span class="lowercase" data-i18n="RITUAL">ritual</span>){{/ritual}}
        </div>
      {{/spell}}
      {{#show_character_name}}
        <div class="rt-character-name">{{character_name}}</div>
      {{/show_character_name}}
      {{#subheader}}
        <div>{{subheader}}</div>
      {{/subheader}}
    </div>

    {{#emote}}
      <p class="rt-emote">{{character_name}} {{emote}}</p>
    {{/emote}}
    <div class="rt-content">
      {{#uses}}
        <div class="no-border">
          <div class="bold"><span data-i18n="USES">Uses</span>:</span> {{uses}} / {{uses_max}}</div>
        </div>
      {{/uses}}
      {{#casting_time}}
        <div class="no-border">
          <span class="bold"><span data-i18n="CASTING_TIME">Casting Time</span>:</span> <span>{{casting_time}}</span>
        </div>
      {{/casting_time}}
      {{#range}}
        <div class="no-border">
          <span class="bold"><span data-i18n="RANGE">Range</span>:</span> <span>{{range}}</span> <span></span> <span>{{#ammo}}{{ammo}}{{#ammo_name}}{{ammo_name}}{{/ammo_name}}{{^ammo_name}}<span class="lowercase" data-i18n="AMMO">ammo</span>{{/ammo_name}}{{/ammo}}</span>
        </div>
      {{/range}}
      {{#reach}}
        <div class="no-border">
          <span class="bold"><span data-i18n="REACH">Reach</span>:</span> <span>{{reach}}</span>
        </div>
      {{/reach}}
      {{#components}}
        <div class="no-border">
          <span class="bold"><span data-i18n="COMPONENTS">Components</span>:</span>
          {{components}}
          {{#materials}}({{materials}}){{/materials}}
        </div>
      {{/components}}
      {{#duration}}
        <div class="no-border">
          <span class="bold"><span data-i18n="DURATION">Duration</span>:</span>
          <span>{{concentration}}</span>
          <span>{{duration}}</span>
        </div>
      {{/duration}}
      {{#target}}
        <div class="no-border">
          <span class="bold"><span data-i18n="TARGET">Target</span>:</span> <span>{{target}}</span>
        </div>
      {{/target}}
      {{#content}}
        <div class="mar-t-md{{#hide_spell_content}} gm-info-block{{/hide_spell_content}}">{{content}}</div>
      {{/content}}
      {{#text_top}}
        <div class="output-small">{{text_top}}</div>
      {{/text_top}}
      {{#roll1}}
        <div>
          <div class="shaped-row{{^roll2}} center{{/roll2}}{{#hide_attack}} gm-info-flex{{/hide_attack}}">
            <div class="outer-padding output{{#roll2}} col-50 right{{/roll2}}">{{roll1}}</div>
            {{#roll2}}
              <div class="col-50 outer-padding output border-left">{{roll2}}</div>
            {{/roll2}}
          </div>
          {{#vs_ac}}
            <div class="output-small-label center ">
              <span data-i18n="VS">vs</span>
              {{#targetName}}
                <span>{{targetName}}</span>
              {{/targetName}}
              <span data-i18n="AC">AC</span>
              {{#targetAC}}
                <span>{{targetAC}}</span>
              {{/targetAC}}
            </div>
          {{/vs_ac}}
        </div>
      {{/roll1}}
      {{#saving_throw_dc}}
        <div class="center">
          {{#saving_throw_condition}}
            <div class="output-small-label">{{saving_throw_condition}}</div>
          {{/saving_throw_condition}}
          {{#saving_throw_dc}}
            {{#targetName}}
              <div class="col-100 output-small-label">
                <span data-i18n="VS">vs</span>
                <span>{{targetName}}</span>
              </div>
            {{/targetName}}
            <div>
              <span class="output-small">
                <span class="{{#hide_saving_throw_dc}}gm-info-inline-block{{/hide_saving_throw_dc}}"><span data-i18n="DC">DC</span> {{saving_throw_dc}}</span>
                <span>[<span data-i18n="{{saving_throw_vs_ability}}">{{saving_throw_vs_ability}}</span>](~target|shaped_{{saving_throw_vs_ability}}_saving_throw)</span>
              </span>
            </div>
            <div class="col-100 output-small-label">
              <span data-i18n="SAVING_THROW">Saving throw</span>
              <span>{{targetName}}</span>
            </div>
          {{/saving_throw_dc}}
          {{#saving_throw_failure}}
            <div class="{{#hide_saving_throw_failure}}gm-info-block{{/hide_saving_throw_failure}}">
              <span class="bold italic"><span data-i18n="SAVE_FAILURE">Save Failure</span>.</span>
              {{saving_throw_failure}}
            </div>
          {{/saving_throw_failure}}
          {{#saving_throw_success}}
            <div class="{{#hide_saving_throw_success}}gm-info-block{{/hide_saving_throw_success}}">
              <span class="bold italic"><span data-i18n="SAVE_SUCCESS">Save Success</span>.</span>
              {{saving_throw_success}}
            </div>
          {{/saving_throw_success}}
        </div>
      {{/saving_throw_dc}}
      {{#damage}}
        <div class="shaped-row zebra vert-center{{^second_damage}} center{{/second_damage}}{{#hide_damage}} gm-info-flex{{/hide_damage}}">
          <div class="{{#second_damage}}col-45 right{{/second_damage}}">
            <div class="inline-block">
              <div class="output center">
                <span>{{damage}}</span>
                {{#rollWasCrit() roll1}}
                  <span>+ {{crit_damage}}</span>
                {{/rollWasCrit() roll1}}
                {{#^rollWasCrit() roll1}}
                  {{#rollWasCrit() roll2}}
                    <span>+ {{crit_damage}}</span>
                  {{/rollWasCrit() roll2}}
                {{/^rollWasCrit() roll1}}
              </div>
              <div class="output-small-label center">
                {{damage_type}}
                {{^damage_type}}
                  <span class="lowercase" data-i18n="DAMAGE">damage</span>
                {{/damage_type}}
              </div>
            </div>
          </div>
      {{/damage}}
      {{#second_damage}}
        {{#damage}}
          <div class="col-10 center">
            <div class="output">+</div>
            <div class="height-one-em"></div>
          </div>
        {{/damage}}
        {{^damage}}
          <div class="shaped-row zebra vert-center">
        {{/damage}}
          <div class="col-45">
            <div class="inline-block">
              <div class="output center">
                <span>{{second_damage}}</span>
                {{#rollWasCrit() roll1}}
                  <span>+ {{second_crit_damage}}</span>
                {{/rollWasCrit() roll1}}
                {{#^rollWasCrit() roll1}}
                  {{#rollWasCrit() roll2}}
                    <span>+ {{second_crit_damage}}</span>
                  {{/rollWasCrit() roll2}}
                {{/^rollWasCrit() roll1}}
              </div>
              <div class="output-small-label center">
                {{second_damage_type}}
                {{^second_damage_type}}
                  <span class="lowercase" data-i18n="DAMAGE">damage</span>
                {{/second_damage_type}}
              </div>
            </div>
          </div>
        {{^damage}}
          </div>
        {{/damage}}
      {{/second_damage}}
      {{#damage}}
        </div>
      {{/damage}}
      {{#heal}}
        <div class="vert-center output-small"><span data-i18n="HEAL_FOR">Heal for</span> {{heal}} <span class="lowercase" data-i18n="HIT_POINTS">hit points</span></div>
      {{/heal}}
      {{#death_saving_throw_successes}}
        <div class="shaped-row vert-center">
          <div>
            <span data-i18n="SUCCESSES">Successes</span> {{death_saving_throw_successes}} / 3
          </div>
          {{#death_saving_throw_failures}}
            <div>
              <span data-i18n="FAILURES">Failures</span> {{death_saving_throw_failures}} / 3
            </div>
          {{/death_saving_throw_failures}}
        </div>
      {{/death_saving_throw_successes}}
      {{#spell_list}}
        <div class="{{#spells_text_size}}output-small{{/spells_text_size}}">
          {{#cantrips}}
            <div>
              <span class="bold italic"><span data-i18n="CANTRIPS">Cantrips</span>.</span>
              {{cantrips}}
            </div>
          {{/cantrips}}
          {{#spells_level_1_show}}
            <div>
              <span class="bold italic"><span data-i18n="1st">1st</span>-<span data-i18n="level">level</span> {{#spells_level_1_uses}}({{spells_level_1_uses}}){{/spells_level_1_uses}}.</span>
              {{spells_level_1}}
            </div>
          {{/spells_level_1_show}}
          {{#spells_level_2_show}}
            <div>
              <span class="bold italic"><span data-i18n="2nd">2nd</span>-<span data-i18n="level">level</span> {{#spells_level_2_uses}}({{spells_level_2_uses}}){{/spells_level_2_uses}}.</span>
              {{spells_level_2}}
            </div>
          {{/spells_level_2_show}}
          {{#spells_level_3_show}}
            <div>
              <span class="bold italic"><span data-i18n="3rd">3rd</span>-<span data-i18n="level">level</span> {{#spells_level_3_uses}}({{spells_level_3_uses}}){{/spells_level_3_uses}}.</span>
              {{spells_level_3}}
            </div>
          {{/spells_level_3_show}}
          {{#spells_level_4_show}}
            <div>
              <span class="bold italic"><span data-i18n="4th">4th</span>-<span data-i18n="level">level</span> {{#spells_level_4_uses}}({{spells_level_4_uses}}){{/spells_level_4_uses}}.</span>
              {{spells_level_4}}
            </div>
          {{/spells_level_4_show}}
          {{#spells_level_5_show}}
            <div>
              <span class="bold italic"><span data-i18n="5th">5th</span>-<span data-i18n="level">level</span> {{#spells_level_5_uses}}({{spells_level_5_uses}}){{/spells_level_5_uses}}.</span>
              {{spells_level_5}}
            </div>
          {{/spells_level_5_show}}
          {{#spells_level_6_show}}
            <div>
              <span class="bold italic"><span data-i18n="6th">6th</span>-<span data-i18n="level">level</span> {{#spells_level_6_uses}}({{spells_level_6_uses}}){{/spells_level_6_uses}}.</span>
              {{spells_level_6}}
            </div>
          {{/spells_level_6_show}}
          {{#spells_level_7_show}}
            <div>
              <span class="bold italic"><span data-i18n="7th">7th</span>-<span data-i18n="level">level</span> {{#spells_level_7_uses}}({{spells_level_7_uses}}){{/spells_level_7_uses}}.</span>
              {{spells_level_7}}
            </div>
          {{/spells_level_7_show}}
          {{#spells_level_8_show}}
            <div>
              <span class="bold italic"><span data-i18n="8th">8th</span>-<span data-i18n="level">level</span> {{#spells_level_8_uses}}({{spells_level_8_uses}}){{/spells_level_8_uses}}.</span>
              {{spells_level_8}}
            </div>
          {{/spells_level_8_show}}
          {{#spells_level_9_show}}
            <div>
              <span class="bold italic"><span data-i18n="9th">9th</span>-<span data-i18n="level">level</span> {{#spells_level_9_uses}}({{spells_level_9_uses}}){{/spells_level_9_uses}}.</span>
              {{spells_level_9}}
            </div>
          {{/spells_level_9_show}}
        </div>
      {{/spell_list}}

      {{#text_center}}
        <div class="center">{{text_center}}</div>
      {{/text_center}}
      {{#text}}
        <div>{{text}}</div>
      {{/text}}
      {{#text_big}}
        <div class="output-small">{{text_big}}</div>
      {{/text_big}}
      {{#allprops() freetext text text_center text_big text_top character_name saving_throw title ignore show_character_name subheader uses uses_max roll1 roll2 advantage disadvantage vs_ac ability emote death_saving_throw death_saving_throw_successes death_saving_throw_failures targetAC targetName action type crit_name crit_text damage damage_type crit_damage second_damage second_damage_type second_crit_damage ranged damage target reach range ammo ammo_name spell spell_list saving_throw_condition saving_throw_dc saving_throw_vs_ability saving_throw_success saving_throw_failure friendly_level school ritual content cast_as_level heal casting_time concentration duration components materials hide_saving_throw_dc hide_spell_content hide_freetext hide_attack hide_damage hide_saving_throw_failure hide_saving_throw_success recharge hide_recharge fx trait armor equipment cantrips spells_level_1 spells_level_1_uses spells_level_1_show spells_level_2 spells_level_2_uses spells_level_2_show spells_level_3 spells_level_3_uses spells_level_3_show spells_level_4 spells_level_4_uses spells_level_4_show spells_level_5 spells_level_5_uses spells_level_5_show spells_level_6 spells_level_6_uses spells_level_6_show spells_level_7 spells_level_7_uses spells_level_7_show spells_level_8 spells_level_8_uses spells_level_8_show spells_level_9 spells_level_9_uses spells_level_9_show spells_text_size}}
        <div>
          <span class="bold italic">{{key}}.</span>
          {{value}}
        </div>
      {{/allprops() freetext text text_center text_big text_top character_name saving_throw title ignore show_character_name subheader uses uses_max roll1 roll2 advantage disadvantage vs_ac ability emote death_saving_throw death_saving_throw_successes death_saving_throw_failures targetAC targetName action type crit_name crit_text damage damage_type crit_damage second_damage second_damage_type second_crit_damage ranged damage target reach range ammo ammo_name spell spell_list saving_throw_condition saving_throw_dc saving_throw_vs_ability saving_throw_success saving_throw_failure friendly_level school ritual content cast_as_level heal casting_time concentration duration components materials hide_saving_throw_dc hide_spell_content hide_freetext hide_attack hide_damage hide_saving_throw_failure hide_saving_throw_success recharge hide_recharge fx trait armor equipment cantrips spells_level_1 spells_level_1_uses spells_level_1_show spells_level_2 spells_level_2_uses spells_level_2_show spells_level_3 spells_level_3_uses spells_level_3_show spells_level_4 spells_level_4_uses spells_level_4_show spells_level_5 spells_level_5_uses spells_level_5_show spells_level_6 spells_level_6_uses spells_level_6_show spells_level_7 spells_level_7_uses spells_level_7_show spells_level_8 spells_level_8_uses spells_level_8_show spells_level_9 spells_level_9_uses spells_level_9_show spells_text_size}}

      {{#freetext}}
        <div class="{{#hide_freetext}} gm-info-block{{/hide_freetext}}">{{freetext}}</div>
      {{/freetext}}
      {{#crit_name}}
        {{#rollWasCrit() roll1}}
          <div>
            <span class="bold italic">{{crit_name}}.</span>
            {{crit_text}}
          </div>
        {{/rollWasCrit() roll1}}
        {{#^rollWasCrit() roll1}}
          {{#rollWasCrit() roll2}}
            <div>
              <span class="bold italic">{{crit_name}}.</span>
              {{crit_text}}
            </div>
          {{/rollWasCrit() roll2}}
        {{/^rollWasCrit() roll1}}
      {{/crit_name}}
      {{#recharge}}
        <div class="{{#hide_recharge}}gm-info-block{{/hide_recharge}}">
          <span class="bold italic"><span data-i18n="RECHARGE">Recharge</span>.</span>
          {{recharge}}
        </div>
      {{/recharge}}
    </div>
  </div>
</rolltemplate>